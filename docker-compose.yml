version: "3.8"

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: kleinanzeigen-backend
    environment:
      NODE_ENV: development
      PORT: 5000
      # Local dev convenience: disable token checks by default.
      # To require tokens (like production), remove this and set KL_ACCESS_TOKENS.
      KL_REQUIRE_TOKEN: "0"
      KL_ALLOW_ALL_ORIGINS: "1"
      KL_DEBUG_MESSAGES: "1"
      KL_MESSAGE_ACTION_ARTIFACTS: "1"
      KL_TELEGRAM_BOT_TOKEN: "${KL_TELEGRAM_BOT_TOKEN:-}"
      KL_TELEGRAM_CHAT_ID: "${KL_TELEGRAM_CHAT_ID:-}"
    ports:
      - "5000:5000"
    volumes:
      - ./backend/data:/app/data
      - ./backend/uploads:/app/uploads

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: kleinanzeigen-frontend
    depends_on:
      - backend
    ports:
      - "3000:80"
