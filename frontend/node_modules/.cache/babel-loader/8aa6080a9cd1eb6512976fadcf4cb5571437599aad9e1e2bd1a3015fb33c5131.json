{"ast":null,"code":"import _objectSpread from\"/Users/eurocare/Downloads/barvihaluxury-main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const API_BASE=process.env.REACT_APP_API_BASE||\"\";export const getAccessToken=()=>localStorage.getItem(\"accessToken\")||\"\";export const setAccessToken=token=>{const value=String(token||\"\").trim();if(value){localStorage.setItem(\"accessToken\",value);}else{localStorage.removeItem(\"accessToken\");}};export const apiFetch=async function(path){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const headers=new Headers(options.headers||{});const token=getAccessToken();if(token&&!headers.has(\"Authorization\")){headers.set(\"Authorization\",\"Bearer \".concat(token));}const buildApiUrl=rawPath=>{if(rawPath.startsWith(\"http\"))return rawPath;const normalizedBase=String(API_BASE||\"\").trim().replace(/\\/+$/,\"\");let normalizedPath=rawPath.startsWith(\"/\")?rawPath:\"/\".concat(rawPath);// Prevent \"/api/api/...\" when both base and path already include \"/api\".\nconst baseEndsWithApi=normalizedBase.endsWith(\"/api\");if(baseEndsWithApi&&normalizedPath.startsWith(\"/api/\")){normalizedPath=normalizedPath.slice(4);}return\"\".concat(normalizedBase).concat(normalizedPath);};const url=buildApiUrl(path);return fetch(url,_objectSpread(_objectSpread({},options),{},{headers}));};export const apiFetchJson=async function(path){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const response=await apiFetch(path,options);const contentType=response.headers.get(\"content-type\")||\"\";let data={};let text=\"\";if(contentType.includes(\"application/json\")){data=await response.json().catch(()=>({}));}else{text=await response.text().catch(()=>\"\");}if(!response.ok){var _data,_data2;const textMessage=text?text.replace(/<[^>]*>/g,\" \").replace(/\\s+/g,\" \").trim().slice(0,240):\"\";const error=new Error(((_data=data)===null||_data===void 0?void 0:_data.error)||((_data2=data)===null||_data2===void 0?void 0:_data2.message)||textMessage||\"HTTP \".concat(response.status));error.status=response.status;error.data=data;if(text){error.raw=text;}throw error;}return contentType.includes(\"application/json\")?data:{};};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","getAccessToken","localStorage","getItem","setAccessToken","token","value","String","trim","setItem","removeItem","apiFetch","path","options","arguments","length","undefined","headers","Headers","has","set","concat","buildApiUrl","rawPath","startsWith","normalizedBase","replace","normalizedPath","baseEndsWithApi","endsWith","slice","url","fetch","_objectSpread","apiFetchJson","response","contentType","get","data","text","includes","json","catch","ok","_data","_data2","textMessage","error","Error","message","status","raw"],"sources":["/Users/eurocare/Downloads/barvihaluxury-main/frontend/src/api.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_BASE || \"\";\n\nexport const getAccessToken = () => localStorage.getItem(\"accessToken\") || \"\";\n\nexport const setAccessToken = (token) => {\n  const value = String(token || \"\").trim();\n  if (value) {\n    localStorage.setItem(\"accessToken\", value);\n  } else {\n    localStorage.removeItem(\"accessToken\");\n  }\n};\n\nexport const apiFetch = async (path, options = {}) => {\n  const headers = new Headers(options.headers || {});\n  const token = getAccessToken();\n  if (token && !headers.has(\"Authorization\")) {\n    headers.set(\"Authorization\", `Bearer ${token}`);\n  }\n\n  const buildApiUrl = (rawPath) => {\n    if (rawPath.startsWith(\"http\")) return rawPath;\n\n    const normalizedBase = String(API_BASE || \"\").trim().replace(/\\/+$/, \"\");\n    let normalizedPath = rawPath.startsWith(\"/\") ? rawPath : `/${rawPath}`;\n\n    // Prevent \"/api/api/...\" when both base and path already include \"/api\".\n    const baseEndsWithApi = normalizedBase.endsWith(\"/api\");\n    if (baseEndsWithApi && normalizedPath.startsWith(\"/api/\")) {\n      normalizedPath = normalizedPath.slice(4);\n    }\n\n    return `${normalizedBase}${normalizedPath}`;\n  };\n\n  const url = buildApiUrl(path);\n  return fetch(url, { ...options, headers });\n};\n\nexport const apiFetchJson = async (path, options = {}) => {\n  const response = await apiFetch(path, options);\n  const contentType = response.headers.get(\"content-type\") || \"\";\n  let data = {};\n  let text = \"\";\n\n  if (contentType.includes(\"application/json\")) {\n    data = await response.json().catch(() => ({}));\n  } else {\n    text = await response.text().catch(() => \"\");\n  }\n\n  if (!response.ok) {\n    const textMessage = text\n      ? text.replace(/<[^>]*>/g, \" \").replace(/\\s+/g, \" \").trim().slice(0, 240)\n      : \"\";\n    const error = new Error(data?.error || data?.message || textMessage || `HTTP ${response.status}`);\n    error.status = response.status;\n    error.data = data;\n    if (text) {\n      error.raw = text;\n    }\n    throw error;\n  }\n  return contentType.includes(\"application/json\") ? data : {};\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}