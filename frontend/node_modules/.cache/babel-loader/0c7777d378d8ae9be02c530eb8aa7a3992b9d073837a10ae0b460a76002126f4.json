{"ast":null,"code":"import _objectSpread from\"/Users/eurocare/Downloads/barvihaluxury-main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useRef,useState}from\"react\";import{apiFetchJson}from\"../api\";import{XIcon,ChevronRightIcon,RefreshIcon,LoadingIcon}from\"./Icons\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdModal=_ref=>{let{isOpen,onClose,onSubmit,publishing,accounts,categories,onRefreshCategories,loadingCategories,extraFields,extraFieldValues,setExtraFieldValues,loadingExtraFields,extraFieldsError,newAd,setNewAd,adImages,setAdImages,categoriesUpdatedAt}=_ref;if(!isOpen)return null;const[categoryPath,setCategoryPath]=useState([]);const[localCategories,setLocalCategories]=useState([]);const[didRestorePath,setDidRestorePath]=useState(false);const[imagePreviews,setImagePreviews]=useState([]);const[rightDragActive,setRightDragActive]=useState(false);const[rightDragIndex,setRightDragIndex]=useState(null);const[loadingPlz,setLoadingPlz]=useState(false);const[categoryChildrenError,setCategoryChildrenError]=useState(\"\");const categoryListRef=useRef(null);const imageInputRef=useRef(null);const pendingChildrenRef=useRef(new Map());const prefetchRootRef=useRef(\"\");const prefetchInFlightRef=useRef(false);const prefetchedTargetsRef=useRef(new Set());const prefetchTokenRef=useRef(0);const rightDragRef=useRef({active:false,index:-1});const inputStyle={width:\"100%\",padding:\"12px 16px\",border:\"1px solid rgba(148,163,184,0.2)\",borderRadius:\"14px\",background:\"rgba(15,23,42,0.8)\",fontSize:\"14px\",color:\"#e2e8f0\",transition:\"all 0.2s ease\",outline:\"none\"};const labelStyle={display:\"block\",marginBottom:\"10px\",fontWeight:\"600\",color:\"#e2e8f0\",fontSize:\"14px\"};const selectedUnderlineStyle={borderBottom:\"1px solid rgba(125, 211, 252, 0.95)\",paddingBottom:\"1px\"};const formatAccountLabel=account=>{const name=account.profileName||account.username||\"ÐÐºÐºÐ°ÑƒÐ½Ñ‚\";const email=account.profileEmail||\"\";return email?\"\".concat(name,\" (\").concat(email,\")\"):name;};const getCategoryLabel=category=>{if(!category)return\"\";const raw=category.name||category.label||category.title||category.categoryName||category.displayName;const text=String(raw||\"\").trim();if(text)return text;const fallback=category.id||category.url||\"\";return String(fallback);};const isNumericCategoryId=value=>/^\\d+$/.test(String(value||\"\"));const looksLikeCategoryUrl=value=>/\\/c\\d+(?:\\/|$)/i.test(String(value||\"\"));const isAttributeOptionNode=(node,parent)=>{if(!node||!parent)return false;const parentId=parent.id!==undefined&&parent.id!==null?String(parent.id):\"\";if(!isNumericCategoryId(parentId))return false;const idValue=node.id!==undefined&&node.id!==null?String(node.id):\"\";const urlValue=node.url?String(node.url):\"\";const nameValue=String(node.name||node.label||\"\").trim().toLowerCase();const normalizedId=idValue.trim().toLowerCase();if(isNumericCategoryId(normalizedId))return false;if(looksLikeCategoryUrl(urlValue))return false;if(Array.isArray(node.children)&&node.children.length>0)return false;if(!normalizedId||!nameValue)return false;// Keep real subcategories with slug-like ids (e.g. \"drucker_scanner\").\n// Filter only very small option-like values that are likely field options.\nconst optionLikeValues=new Set([\"ja\",\"nein\",\"yes\",\"no\",\"new\",\"used\",\"other\"]);return optionLikeValues.has(normalizedId)||optionLikeValues.has(nameValue);};const filterCategoryChildren=(nodes,parent)=>(Array.isArray(nodes)?nodes:[]).filter(node=>!isAttributeOptionNode(node,parent));const getCategoryValue=category=>{if(!category)return\"\";const id=category.id!==undefined&&category.id!==null?String(category.id):\"\";const url=category.url?String(category.url):\"\";if(id&&isNumericCategoryId(id))return id;if(url)return url;return id;};const getNodeKey=node=>{if(!node)return\"\";const value=getCategoryValue(node);if(value)return\"value:\".concat(value);if(node.name)return\"name:\".concat(String(node.name));return\"\";};const mergeCategoryTrees=(prevNodes,nextNodes)=>{if(!Array.isArray(nextNodes)||!nextNodes.length){return Array.isArray(prevNodes)?prevNodes:[];}const prev=Array.isArray(prevNodes)?prevNodes:[];const prevMap=new Map();for(const node of prev){const key=getNodeKey(node);if(key)prevMap.set(key,node);}const used=new Set();const merged=nextNodes.map(node=>{const key=getNodeKey(node);if(key)used.add(key);const prevNode=key?prevMap.get(key):null;const nextChildren=Array.isArray(node.children)?node.children:[];const prevChildren=(prevNode===null||prevNode===void 0?void 0:prevNode.children)||[];const mergedChildren=nextChildren.length?mergeCategoryTrees(prevChildren,nextChildren):prevChildren;return _objectSpread(_objectSpread(_objectSpread({},prevNode||{}),node),{},{children:mergedChildren});});for(const[key,node]of prevMap.entries()){if(!used.has(key))merged.push(node);}return merged;};const buildPathToNode=function(nodes,targetValue){let path=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];if(!targetValue||!Array.isArray(nodes))return[];const target=String(targetValue);for(const node of nodes){var _node$children;const matches=node.id!==undefined&&node.id!==null&&String(node.id)===target||node.url&&String(node.url)===target;const nextValue=getCategoryValue(node);const nextPath=nextValue?[...path,nextValue]:path;if(matches)return nextPath;if((_node$children=node.children)!==null&&_node$children!==void 0&&_node$children.length){const childPath=buildPathToNode(node.children,targetValue,nextPath);if(childPath.length)return childPath;}}return[];};const findNode=(nodes,value)=>{if(!value)return null;for(const node of nodes){var _node$children2;if(String(node.id)===String(value)||String(node.url)===String(value))return node;if((_node$children2=node.children)!==null&&_node$children2!==void 0&&_node$children2.length){const found=findNode(node.children,value);if(found)return found;}}return null;};const getBreadcrumbForPath=path=>{const breadcrumb=[];let current=localCategories;for(const pathItem of path){const found=current.find(cat=>cat.id&&String(cat.id)===String(pathItem)||cat.url&&String(cat.url)===String(pathItem));if(!found)break;breadcrumb.push(found);current=filterCategoryChildren(found.children||[],found);}return breadcrumb;};const resolveCategorySelection=path=>{const breadcrumb=getBreadcrumbForPath(path);const selectedNode=breadcrumb.length?breadcrumb[breadcrumb.length-1]:null;const numericNode=[...breadcrumb].reverse().find(node=>/^\\d+$/.test(String((node===null||node===void 0?void 0:node.id)||\"\")));return{selectedNode,numericNode:numericNode||selectedNode};};useEffect(()=>{setLocalCategories(prev=>mergeCategoryTrees(prev,categories||[]));},[categories]);useEffect(()=>{if(isOpen){setCategoryPath([]);setDidRestorePath(false);setCategoryChildrenError(\"\");setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{categoryId:\"\",categoryUrl:\"\",categoryPath:[]}));}},[isOpen,setNewAd]);useEffect(()=>{if(!adImages||adImages.length===0){setImagePreviews([]);return undefined;}const previews=adImages.map(file=>({file,url:URL.createObjectURL(file)}));setImagePreviews(previews);return()=>{previews.forEach(preview=>URL.revokeObjectURL(preview.url));};},[adImages]);const stopRightDrag=()=>{if(!rightDragRef.current.active)return;rightDragRef.current={active:false,index:-1};setRightDragActive(false);setRightDragIndex(null);};useEffect(()=>{const handleMouseUp=()=>stopRightDrag();const handleWindowBlur=()=>stopRightDrag();window.addEventListener(\"mouseup\",handleMouseUp);window.addEventListener(\"blur\",handleWindowBlur);return()=>{window.removeEventListener(\"mouseup\",handleMouseUp);window.removeEventListener(\"blur\",handleWindowBlur);};},[]);const handleImageInputChange=event=>{var _event$target;const selected=Array.from((event===null||event===void 0?void 0:(_event$target=event.target)===null||_event$target===void 0?void 0:_event$target.files)||[]).filter(file=>String((file===null||file===void 0?void 0:file.type)||\"\").toLowerCase().startsWith(\"image/\"));if(event!==null&&event!==void 0&&event.target)event.target.value=\"\";if(!selected.length)return;setAdImages(selected);};const removeAdImage=indexToRemove=>{stopRightDrag();setAdImages(prev=>{const list=Array.isArray(prev)?prev:[];return list.filter((_,idx)=>idx!==indexToRemove);});if(imageInputRef.current){imageInputRef.current.value=\"\";}};const startRightDrag=(event,index)=>{if(event.button!==2)return;event.preventDefault();rightDragRef.current={active:true,index};setRightDragActive(true);setRightDragIndex(index);};const moveRightDragTo=targetIndex=>{const current=rightDragRef.current;if(!current.active)return;if(!Number.isInteger(targetIndex))return;if(current.index===targetIndex)return;setAdImages(prev=>{const list=Array.isArray(prev)?[...prev]:[];if(current.index<0||current.index>=list.length||targetIndex<0||targetIndex>=list.length){return prev;}const[moved]=list.splice(current.index,1);list.splice(targetIndex,0,moved);return list;});rightDragRef.current={active:true,index:targetIndex};setRightDragIndex(targetIndex);};useEffect(()=>{if(!isOpen)return;setNewAd(prev=>{const currentPath=Array.isArray(prev.categoryPath)?prev.categoryPath:[];const nextPath=categoryPath;if(currentPath.length===nextPath.length&&currentPath.every((item,idx)=>String(item)===String(nextPath[idx]))){return prev;}return _objectSpread(_objectSpread({},prev),{},{categoryPath:[...nextPath]});});},[isOpen,categoryPath,setNewAd]);useEffect(()=>{if(!isOpen)return;if(categoryPath.length)return;if(didRestorePath)return;const target=(newAd===null||newAd===void 0?void 0:newAd.categoryId)||(newAd===null||newAd===void 0?void 0:newAd.categoryUrl);if(!target)return;const restoredPath=buildPathToNode(localCategories,target);if(restoredPath.length){setCategoryPath(restoredPath);setDidRestorePath(true);}},[isOpen,categoryPath.length,didRestorePath,newAd===null||newAd===void 0?void 0:newAd.categoryId,newAd===null||newAd===void 0?void 0:newAd.categoryUrl,localCategories]);useEffect(()=>{if(!isOpen)return;if(!newAd.accountId)return;if(!categoryPath.length)return;const lastId=categoryPath[categoryPath.length-1];const node=findNode(localCategories,lastId);if(node&&(!node.children||node.children.length===0)){requestChildren(node);}},[isOpen,newAd.accountId,categoryPath,localCategories]);useEffect(()=>{if(!isOpen)return;if(!categoryPath.length){console.log(\"[AdModal] category path empty\");return;}const current=getCurrentCategories();console.log(\"[AdModal] category path\",categoryPath.join(\" > \"),\"current count\",current.length);},[isOpen,categoryPath,localCategories]);useEffect(()=>{if(!isOpen)return;if(!categoryListRef.current)return;categoryListRef.current.scrollTop=0;},[isOpen,categoryPath]);const getCurrentCategories=()=>{if(categoryPath.length===0)return localCategories;let current=localCategories;let parent=null;for(const pathItem of categoryPath){const found=current.find(cat=>cat.id&&String(cat.id)===String(pathItem)||cat.url&&String(cat.url)===String(pathItem));if(!found){const fallback=findNode(localCategories,pathItem);return filterCategoryChildren((fallback===null||fallback===void 0?void 0:fallback.children)||[],fallback);}parent=found;current=filterCategoryChildren(found.children||[],found);}return current;};const getSelectedCategory=()=>{if(categoryPath.length===0)return null;const lastId=categoryPath[categoryPath.length-1];return findNode(localCategories,lastId);};const updateCategorySelection=async category=>{if(!newAd.accountId){alert(\"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\");return;}setDidRestorePath(true);const parentNode=getSelectedCategory();if(isAttributeOptionNode(category,parentNode)){console.warn(\"[AdModal] ignoring attribute option node\",(category===null||category===void 0?void 0:category.name)||(category===null||category===void 0?void 0:category.id));return;}const value=getCategoryValue(category);if(!value)return;const normalizedValue=String(value);// Ð•ÑÐ»Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑƒÐ¶Ðµ Ð² Ð¿ÑƒÑ‚Ð¸, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ðº Ð½ÐµÐ¹\nconst indexInPath=categoryPath.findIndex(id=>String(id)===normalizedValue);if(indexInPath!==-1){const nextPath=categoryPath.slice(0,indexInPath+1);setCategoryPath(nextPath);// ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ\nconst{selectedNode,numericNode}=resolveCategorySelection(nextPath);setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{categoryId:numericNode!==null&&numericNode!==void 0&&numericNode.id?String(numericNode.id):\"\",categoryUrl:(selectedNode===null||selectedNode===void 0?void 0:selectedNode.url)||(numericNode===null||numericNode===void 0?void 0:numericNode.url)||\"\",categoryKey:nextPath.join(\">\"),categoryPath:[...nextPath]}));return;}// Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ Ð² Ð¿ÑƒÑ‚ÑŒ\nconst newPath=[...categoryPath,normalizedValue];setCategoryPath(newPath);setCategoryChildrenError(\"\");// Ð’Ð¡Ð•Ð“Ð”Ð Ð¿Ñ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð´ÐµÑ‚ÐµÐ¹, Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ ÐµÑÑ‚ÑŒ\n// (ÑÑ‚Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ñ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ 3+ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹)\nconst childrenResult=await requestChildren(category);// ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ Ð² Ñ„Ð¾Ñ€Ð¼Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¾Ð½Ð° ÐºÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ\nconst{selectedNode,numericNode}=resolveCategorySelection(newPath);const knownChildren=Array.isArray(category===null||category===void 0?void 0:category.children)?category.children:[];const selectedChildren=Array.isArray(selectedNode===null||selectedNode===void 0?void 0:selectedNode.children)?selectedNode.children:[];const fetchedChildren=Array.isArray(childrenResult)?childrenResult:null;const hasFetchedChildren=fetchedChildren?filterCategoryChildren(fetchedChildren,category).length>0:null;const hasKnownChildren=filterCategoryChildren(knownChildren,category).length>0||filterCategoryChildren(selectedChildren,selectedNode).length>0;const childrenLoadFailed=childrenResult===null&&!hasKnownChildren;const isLeaf=childrenLoadFailed?false:hasFetchedChildren!==null?!hasFetchedChildren:!hasKnownChildren;setNewAd(prev=>{const next=_objectSpread({},prev);if(isLeaf){next.categoryId=numericNode!==null&&numericNode!==void 0&&numericNode.id?String(numericNode.id):\"\";next.categoryUrl=(selectedNode===null||selectedNode===void 0?void 0:selectedNode.url)||(numericNode===null||numericNode===void 0?void 0:numericNode.url)||\"\";}else{next.categoryId=\"\";next.categoryUrl=\"\";}next.categoryKey=newPath.join(\">\");next.categoryPath=[...newPath];if(!next.categoryId||next.categoryId!==prev.categoryId){if(setExtraFieldValues){setExtraFieldValues({});}}return next;});};const updateNodeChildren=(nodes,targetValue,children)=>nodes.map(node=>{var _node$children3;const matches=String(node.id)===String(targetValue)||String(node.url)===String(targetValue);if(matches){return _objectSpread(_objectSpread({},node),{},{children});}if((_node$children3=node.children)!==null&&_node$children3!==void 0&&_node$children3.length){return _objectSpread(_objectSpread({},node),{},{children:updateNodeChildren(node.children,targetValue,children)});}return node;});const requestChildren=async node=>{const rawId=(node===null||node===void 0?void 0:node.id)!==undefined&&(node===null||node===void 0?void 0:node.id)!==null?String(node.id):\"\";const rawUrl=node!==null&&node!==void 0&&node.url?String(node.url):\"\";const idValue=rawId&&isNumericCategoryId(rawId)?rawId:\"\";const urlValue=idValue?\"\":rawUrl||\"\";if(!idValue&&!urlValue)return;const targetValue=getCategoryValue(node)||idValue||urlValue;if(!targetValue)return;const pending=pendingChildrenRef.current.get(targetValue);if(pending)return pending;const task=(async()=>{const params=new URLSearchParams();if(idValue)params.set(\"id\",idValue);else params.set(\"url\",urlValue);if(newAd!==null&&newAd!==void 0&&newAd.accountId)params.set(\"accountId\",newAd.accountId);try{var _data;let data=await apiFetchJson(\"/api/categories/children?\".concat(params.toString()));let rawChildren=Array.isArray((_data=data)===null||_data===void 0?void 0:_data.children)?data.children:null;if(Array.isArray(rawChildren)&&rawChildren.length===0){var _data2;const refreshParams=new URLSearchParams(params.toString());refreshParams.set(\"refresh\",\"true\");data=await apiFetchJson(\"/api/categories/children?\".concat(refreshParams.toString()));rawChildren=Array.isArray((_data2=data)===null||_data2===void 0?void 0:_data2.children)?data.children:rawChildren;}if(!Array.isArray(rawChildren))return null;const filteredChildren=filterCategoryChildren(rawChildren,node);const count=Array.isArray(filteredChildren)?filteredChildren.length:0;const sample=Array.isArray(filteredChildren)?filteredChildren.slice(0,5).map(item=>(item===null||item===void 0?void 0:item.name)||(item===null||item===void 0?void 0:item.id)||(item===null||item===void 0?void 0:item.url)):[];console.log(\"[AdModal] children response count\",count,\"target\",targetValue,\"sample\",sample);setLocalCategories(prev=>{var _updated$children;const next=updateNodeChildren(prev,targetValue,filteredChildren);const updated=findNode(next,targetValue);console.log(\"[AdModal] children applied count\",(updated===null||updated===void 0?void 0:(_updated$children=updated.children)===null||_updated$children===void 0?void 0:_updated$children.length)||0,\"target\",targetValue);return next;});setCategoryChildrenError(\"\");return filteredChildren;}catch(error){const message=(error===null||error===void 0?void 0:error.message)||\"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ‚Ð¸\";console.error(\"[AdModal] children request failed\",{target:targetValue,accountId:(newAd===null||newAd===void 0?void 0:newAd.accountId)||\"\",message});setCategoryChildrenError(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u043F\\u043E\\u0434\\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438: \".concat(message));return null;}})();pendingChildrenRef.current.set(targetValue,task);try{return await task;}finally{pendingChildrenRef.current.delete(targetValue);}};const fetchAccountPostalCode=async()=>{if(!(newAd!==null&&newAd!==void 0&&newAd.accountId)){alert(\"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\");return;}setLoadingPlz(true);try{const data=await apiFetchJson(\"/api/accounts/\".concat(newAd.accountId,\"/plz\"));if(data!==null&&data!==void 0&&data.success&&data!==null&&data!==void 0&&data.postalCode){setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{postalCode:data.postalCode}));}else{alert((data===null||data===void 0?void 0:data.error)||\"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\");}}catch(error){alert((error===null||error===void 0?void 0:error.message)||\"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\");}finally{setLoadingPlz(false);}};useEffect(()=>{if(!isOpen)return;if(!newAd.accountId)return;if(categoryPath.length!==1)return;const rootValue=String(categoryPath[0]||\"\");if(!rootValue)return;if(prefetchRootRef.current!==rootValue){prefetchRootRef.current=rootValue;prefetchedTargetsRef.current=new Set();prefetchInFlightRef.current=false;}if(prefetchInFlightRef.current)return;const current=getCurrentCategories();if(!current.length)return;const token=++prefetchTokenRef.current;prefetchInFlightRef.current=true;(async()=>{for(const node of current){var _node$children4;if(prefetchTokenRef.current!==token)return;const key=getCategoryValue(node);if(!key)continue;if(prefetchedTargetsRef.current.has(key))continue;prefetchedTargetsRef.current.add(key);if((_node$children4=node.children)!==null&&_node$children4!==void 0&&_node$children4.length)continue;await requestChildren(node);await new Promise(resolve=>setTimeout(resolve,120));}})().finally(()=>{if(prefetchTokenRef.current===token){prefetchInFlightRef.current=false;}});},[isOpen,newAd.accountId,categoryPath,localCategories]);const getCategoryBreadcrumb=()=>{const breadcrumb=[];let current=localCategories;for(const pathItem of categoryPath){const found=current.find(cat=>cat.id&&String(cat.id)===String(pathItem)||cat.url&&String(cat.url)===String(pathItem));if(found){breadcrumb.push(found);current=filterCategoryChildren(found.children||[],found);}}return breadcrumb;};const goBackInCategories=index=>{setDidRestorePath(true);if(index<0){setCategoryPath([]);}else{setCategoryPath(categoryPath.slice(0,index+1));}};const currentCategories=getCurrentCategories();const breadcrumb=getCategoryBreadcrumb();return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",style:{position:\"fixed\",top:0,left:0,right:0,bottom:0,backgroundColor:\"rgba(2, 6, 23, 0.85)\",backdropFilter:\"blur(8px)\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",zIndex:5000,padding:\"20px\",animation:\"fadeIn 0.2s ease-out\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card modal-card-wide modal-card-tall\",style:{background:\"linear-gradient(145deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.98) 100%)\",borderRadius:\"24px\",padding:\"32px\",width:\"760px\",maxWidth:\"100%\",maxHeight:\"92vh\",overflow:\"auto\",border:\"1px solid rgba(148,163,184,0.15)\",boxShadow:\"0 30px 60px rgba(0,0,0,0.5), 0 0 60px rgba(0,0,0,0.3)\",color:\"#e2e8f0\",animation:\"scaleIn 0.3s ease-out\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"flex-start\",marginBottom:\"28px\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:\"14px\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"48px\",height:\"48px\",borderRadius:\"14px\",background:\"linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(245, 158, 11, 0.1))\",border:\"1px solid rgba(245, 158, 11, 0.3)\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",boxShadow:\"0 4px 15px rgba(245, 158, 11, 0.2)\",fontSize:\"22px\"},children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,fontSize:\"22px\",fontWeight:\"700\"},children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043E\\u0431\\u044A\\u044F\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:\"4px 0 0\",color:\"#94a3b8\",fontSize:\"13px\"},children:\"\\u0417\\u0430\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043B\\u044F \\u0438 \\u043E\\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u0443\\u0439\\u0442\\u0435 \\u0432 Kleinanzeigen\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{width:\"40px\",height:\"40px\",borderRadius:\"12px\",background:\"rgba(148,163,184,0.1)\",border:\"1px solid rgba(148,163,184,0.2)\",cursor:\"pointer\",color:\"#94a3b8\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",transition:\"all 0.2s ease\"},onMouseEnter:e=>{e.currentTarget.style.background=\"rgba(239, 68, 68, 0.15)\";e.currentTarget.style.borderColor=\"rgba(239, 68, 68, 0.3)\";e.currentTarget.style.color=\"#f87171\";},onMouseLeave:e=>{e.currentTarget.style.background=\"rgba(148,163,184,0.1)\";e.currentTarget.style.borderColor=\"rgba(148,163,184,0.2)\";e.currentTarget.style.color=\"#94a3b8\";},children:/*#__PURE__*/_jsx(XIcon,{size:18})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:\"18px\"},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u0410\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442:\"}),/*#__PURE__*/_jsxs(\"select\",{value:newAd.accountId,onChange:e=>setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{accountId:e.target.value})),style:inputStyle,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"}),accounts.map(account=>/*#__PURE__*/_jsxs(\"option\",{value:account.id,children:[formatAccountLabel(account),\" (\",account.proxy||\"Ð‘ÐµÐ· Ð¿Ñ€Ð¾ÐºÑÐ¸\",\")\"]},account.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u043E\\u0431\\u044A\\u044F\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newAd.title,onChange:e=>setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{title:e.target.value})),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 (10-65 \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432)\",style:inputStyle,onFocus:e=>e.currentTarget.style.borderColor=\"rgba(59,130,246,0.5)\",onBlur:e=>e.currentTarget.style.borderColor=\"rgba(148,163,184,0.3)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:newAd.description,onChange:e=>setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{description:e.target.value})),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 (10-4000 \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432)\",rows:\"5\",style:_objectSpread(_objectSpread({},inputStyle),{},{minHeight:\"140px\",resize:\"vertical\",fontFamily:\"inherit\"}),onFocus:e=>e.currentTarget.style.borderColor=\"rgba(59,130,246,0.5)\",onBlur:e=>e.currentTarget.style.borderColor=\"rgba(148,163,184,0.3)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u0426\\u0435\\u043D\\u0430 (EUR):\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"8px\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:newAd.price,onChange:e=>setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{price:e.target.value})),placeholder:\"0.00\",style:inputStyle,onFocus:e=>e.currentTarget.style.borderColor=\"rgba(59,130,246,0.5)\",onBlur:e=>e.currentTarget.style.borderColor=\"rgba(148,163,184,0.3)\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:\"#94a3b8\",fontWeight:\"600\"},children:\"\\u20AC\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F:\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"10px\",alignItems:\"center\"},children:[categoriesUpdatedAt&&/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:\"12px\",color:\"#94a3b8\"},children:[\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u043E: \",new Date(categoriesUpdatedAt).toLocaleDateString()]}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>onRefreshCategories(true),disabled:loadingCategories,className:\"secondary-button\",style:{padding:\"6px 12px\",border:\"1px solid rgba(148,163,184,0.3)\",cursor:loadingCategories?\"not-allowed\":\"pointer\",fontSize:\"12px\",display:\"flex\",alignItems:\"center\",gap:\"6px\"},children:[loadingCategories?/*#__PURE__*/_jsx(LoadingIcon,{size:14}):/*#__PURE__*/_jsx(RefreshIcon,{size:14}),loadingCategories?\"ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ...\":\"ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{border:\"1px solid rgba(148,163,184,0.3)\",borderRadius:\"12px\",background:\"rgba(15,23,42,0.7)\",marginTop:\"10px\",overflow:\"hidden\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"12px 16px\",borderBottom:\"1px solid rgba(148,163,184,0.2)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:\"600\",color:\"#e2e8f0\"},children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044E\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"12px\",color:\"#94a3b8\"},children:\"\\u041D\\u0430\\u0432\\u0438\\u0433\\u0430\\u0446\\u0438\\u044F \\u043F\\u043E \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u044F\\u043C\"})]}),breadcrumb.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"10px 16px\",borderBottom:\"1px solid rgba(148,163,184,0.2)\",display:\"flex\",gap:\"8px\",alignItems:\"center\",flexWrap:\"wrap\",fontSize:\"12px\",color:\"#94a3b8\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>goBackInCategories(-1),style:{background:\"rgba(59,130,246,0.1)\",border:\"1px solid rgba(59,130,246,0.3)\",borderRadius:\"6px\",padding:\"4px 8px\",cursor:\"pointer\",color:\"#7dd3fc\",fontSize:\"12px\",transition:\"all 0.2s ease\"},onMouseEnter:e=>e.currentTarget.style.background=\"rgba(59,130,246,0.2)\",onMouseLeave:e=>e.currentTarget.style.background=\"rgba(59,130,246,0.1)\",children:\"\\u0412\\u0441\\u0435 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438\"}),breadcrumb.map((cat,index)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(ChevronRightIcon,{size:12}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>goBackInCategories(index),style:{background:index===breadcrumb.length-1?\"rgba(59,130,246,0.2)\":\"rgba(148,163,184,0.1)\",border:\"1px solid \"+(index===breadcrumb.length-1?\"rgba(59,130,246,0.3)\":\"rgba(148,163,184,0.2)\"),borderRadius:\"6px\",padding:\"4px 8px\",cursor:index===breadcrumb.length-1?\"default\":\"pointer\",color:index===breadcrumb.length-1?\"#7dd3fc\":\"#e2e8f0\",fontSize:\"12px\",transition:\"all 0.2s ease\"},children:getCategoryLabel(cat)})]},cat.id||cat.url))]}),/*#__PURE__*/_jsx(\"div\",{ref:categoryListRef,style:{padding:\"12px\",minHeight:\"220px\",maxHeight:\"300px\",overflowY:\"auto\"},children:currentCategories.length?currentCategories.map(category=>{return/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>updateCategorySelection(category),disabled:!newAd.accountId,style:{width:\"100%\",textAlign:\"left\",padding:\"10px 12px\",marginBottom:\"6px\",borderRadius:\"10px\",border:\"1px solid transparent\",background:\"rgba(148,163,184,0.05)\",color:\"#e2e8f0\",cursor:newAd.accountId?\"pointer\":\"not-allowed\",transition:\"all 0.2s ease\"},onMouseEnter:e=>{e.currentTarget.style.background=\"rgba(59,130,246,0.1)\";e.currentTarget.style.borderColor=\"rgba(59,130,246,0.3)\";},onMouseLeave:e=>{e.currentTarget.style.background=\"rgba(148,163,184,0.05)\";e.currentTarget.style.borderColor=\"transparent\";},children:/*#__PURE__*/_jsxs(\"span\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"span\",{children:getCategoryLabel(category)}),/*#__PURE__*/_jsx(ChevronRightIcon,{size:16,color:\"#94a3b8\"})]})},category.id||category.url||getCategoryLabel(category));}):/*#__PURE__*/_jsx(\"div\",{style:{color:\"#94a3b8\",padding:\"12px\",textAlign:\"center\"},children:!newAd.accountId?\"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\":categoryChildrenError?\"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Â«ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒÂ».\":categoryPath.length>0?\"ÐÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ - ÑÑ‚Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ\":\"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹\"})}),categoryChildrenError&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#f87171\",fontSize:\"12px\",padding:\"0 16px 10px\"},children:categoryChildrenError}),/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:\"1px solid rgba(148,163,184,0.2)\",padding:\"10px 16px\",color:\"#94a3b8\",fontSize:\"12px\",display:\"flex\",gap:\"8px\",flexWrap:\"wrap\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{background:\"rgba(59,130,246,0.2)\",padding:\"4px 8px\",borderRadius:\"999px\",color:\"#e2e8f0\",fontSize:\"11px\",fontWeight:\"600\"},children:\"\\u0412\\u044B\\u0431\\u0440\\u0430\\u043D\\u043E\"}),breadcrumb.length>0?breadcrumb.map((cat,index)=>/*#__PURE__*/_jsxs(React.Fragment,{children:[index>0&&/*#__PURE__*/_jsx(ChevronRightIcon,{size:12}),/*#__PURE__*/_jsx(\"span\",{style:index===breadcrumb.length-1?selectedUnderlineStyle:undefined,children:getCategoryLabel(cat)})]},cat.id||cat.url)):/*#__PURE__*/_jsx(\"span\",{children:\"\\u2014\"})]})]})]}),loadingExtraFields&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"#94a3b8\",fontSize:\"12px\",display:\"flex\",alignItems:\"center\",gap:\"8px\"},children:[/*#__PURE__*/_jsx(LoadingIcon,{size:14}),\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u043E\\u0432 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438...\"]}),!loadingExtraFields&&extraFieldsError&&/*#__PURE__*/_jsxs(\"div\",{style:{color:\"#f87171\",fontSize:\"12px\"},children:[\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u044B \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438: \",extraFieldsError]}),!loadingExtraFields&&!extraFieldsError&&(newAd.categoryId||newAd.categoryUrl)&&(!extraFields||extraFields.length===0)&&/*#__PURE__*/_jsx(\"div\",{style:{color:\"#94a3b8\",fontSize:\"12px\"},children:\"\\u0414\\u043B\\u044F \\u0432\\u044B\\u0431\\u0440\\u0430\\u043D\\u043D\\u043E\\u0439 \\u043A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0438\\u0438 \\u043D\\u0435\\u0442 \\u0434\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u044B\\u0445 \\u043F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u043E\\u0432.\"}),!loadingExtraFields&&(extraFields===null||extraFields===void 0?void 0:extraFields.length)>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"6px\"},children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u0414\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u044B\\u0435 \\u043F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u044B:\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"grid\",gap:\"12px\"},children:extraFields.map(field=>{var _field$options;const key=field.name||field.label;const value=key?(extraFieldValues===null||extraFieldValues===void 0?void 0:extraFieldValues[key])||\"\":\"\";return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",gap:\"6px\"},children:[/*#__PURE__*/_jsxs(\"span\",{style:{fontSize:\"12px\",color:\"#94a3b8\"},children:[field.label,field.required?\" *\":\"\"]}),/*#__PURE__*/_jsxs(\"select\",{value:value,onChange:e=>{const nextValue=e.target.value;setExtraFieldValues(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:nextValue}));},style:inputStyle,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435\"}),(_field$options=field.options)===null||_field$options===void 0?void 0:_field$options.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value||option.label))]})]},field.name||field.label);})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",justifyContent:\"space-between\",gap:\"12px\"},children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"PLZ (\\u0438\\u043D\\u0434\\u0435\\u043A\\u0441):\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:fetchAccountPostalCode,disabled:loadingPlz,style:{padding:\"6px 12px\",borderRadius:\"999px\",border:\"1px solid rgba(59,130,246,0.35)\",background:\"rgba(59,130,246,0.1)\",color:\"#60a5fa\",fontSize:\"12px\",fontWeight:\"600\",cursor:loadingPlz?\"not-allowed\":\"pointer\",whiteSpace:\"nowrap\"},children:loadingPlz?\"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...\":\"PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newAd.postalCode,onChange:e=>setNewAd(prev=>_objectSpread(_objectSpread({},prev),{},{postalCode:e.target.value})),placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u043E\\u0447\\u0442\\u043E\\u0432\\u044B\\u0439 \\u0438\\u043D\\u0434\\u0435\\u043A\\u0441\",style:inputStyle,onFocus:e=>e.currentTarget.style.borderColor=\"rgba(59,130,246,0.5)\",onBlur:e=>e.currentTarget.style.borderColor=\"rgba(148,163,184,0.3)\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{style:labelStyle,children:\"\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{ref:imageInputRef,type:\"file\",accept:\"image/*\",multiple:true,onChange:handleImageInputChange,style:{width:\"100%\",padding:\"12px\",border:\"1px dashed rgba(148,163,184,0.4)\",borderRadius:\"12px\",background:\"rgba(15,23,42,0.7)\",color:\"#e2e8f0\",cursor:\"pointer\",transition:\"all 0.3s ease\"}}),adImages.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"8px\",fontSize:\"12px\",color:\"#94a3b8\"},children:[\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D\\u043E \\u0444\\u0430\\u0439\\u043B\\u043E\\u0432: \",adImages.length,\". \\u041F\\u0440\\u0430\\u0432\\u043E\\u0439 \\u043A\\u043D\\u043E\\u043F\\u043A\\u043E\\u0439 \\u043C\\u044B\\u0448\\u0438 \\u0437\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \\u0438 \\u043F\\u0435\\u0440\\u0435\\u0442\\u0430\\u0449\\u0438\\u0442\\u0435 \\u0434\\u043B\\u044F \\u0441\\u043C\\u0435\\u043D\\u044B \\u043F\\u043E\\u0440\\u044F\\u0434\\u043A\\u0430.\"]}),imagePreviews.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:\"12px\",display:\"grid\",gridTemplateColumns:\"repeat(auto-fill, minmax(96px, 1fr))\",gap:\"10px\"},children:imagePreviews.map((preview,index)=>/*#__PURE__*/_jsxs(\"div\",{onContextMenu:event=>event.preventDefault(),onMouseDown:event=>startRightDrag(event,index),onMouseEnter:()=>moveRightDragTo(index),onMouseUp:()=>stopRightDrag(),style:{position:\"relative\",borderRadius:\"10px\",overflow:\"hidden\",background:\"#0b1220\",border:rightDragIndex===index?\"1px solid rgba(34,197,94,0.75)\":\"1px solid rgba(148,163,184,0.2)\",aspectRatio:\"1 / 1\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",boxShadow:rightDragIndex===index?\"0 0 0 2px rgba(34,197,94,0.25)\":\"none\",cursor:rightDragActive?\"grabbing\":\"default\",userSelect:\"none\"},children:[/*#__PURE__*/_jsx(\"img\",{src:preview.url,alt:\"preview-\".concat(index+1),draggable:false,style:{width:\"100%\",height:\"100%\",objectFit:\"cover\",pointerEvents:\"none\"}}),/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",left:\"6px\",bottom:\"6px\",minWidth:\"22px\",height:\"22px\",padding:\"0 6px\",borderRadius:\"999px\",display:\"inline-flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"11px\",fontWeight:700,color:\"#e2e8f0\",background:\"rgba(2,6,23,0.7)\",border:\"1px solid rgba(148,163,184,0.25)\"},children:index+1}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:event=>{event.preventDefault();event.stopPropagation();removeAdImage(index);},style:{position:\"absolute\",top:\"6px\",right:\"6px\",width:\"24px\",height:\"24px\",borderRadius:\"999px\",border:\"1px solid rgba(239,68,68,0.4)\",background:\"rgba(127,29,29,0.85)\",color:\"#fecaca\",fontSize:\"14px\",lineHeight:1,cursor:\"pointer\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0444\\u043E\\u0442\\u043E\",children:\"\\xD7\"})]},preview.url))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:\"28px\",display:\"flex\",gap:\"12px\",justifyContent:\"flex-end\"},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onClose,className:\"secondary-button\",style:{padding:\"12px 24px\",border:\"none\",cursor:\"pointer\",borderRadius:\"14px\",fontSize:\"14px\",fontWeight:\"600\"},children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onSubmit,className:\"primary-button\",disabled:publishing,style:{padding:\"12px 28px\",color:\"white\",border:\"none\",cursor:publishing?\"not-allowed\":\"pointer\",opacity:publishing?0.7:1,borderRadius:\"14px\",fontSize:\"14px\",fontWeight:\"600\",display:\"flex\",alignItems:\"center\",gap:\"8px\"},children:publishing?\"ÐŸÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ...\":\"ðŸ“¤ Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ðµ\"})]})]})]})});};export default AdModal;","map":{"version":3,"names":["React","useEffect","useRef","useState","apiFetchJson","XIcon","ChevronRightIcon","RefreshIcon","LoadingIcon","jsx","_jsx","jsxs","_jsxs","AdModal","_ref","isOpen","onClose","onSubmit","publishing","accounts","categories","onRefreshCategories","loadingCategories","extraFields","extraFieldValues","setExtraFieldValues","loadingExtraFields","extraFieldsError","newAd","setNewAd","adImages","setAdImages","categoriesUpdatedAt","categoryPath","setCategoryPath","localCategories","setLocalCategories","didRestorePath","setDidRestorePath","imagePreviews","setImagePreviews","rightDragActive","setRightDragActive","rightDragIndex","setRightDragIndex","loadingPlz","setLoadingPlz","categoryChildrenError","setCategoryChildrenError","categoryListRef","imageInputRef","pendingChildrenRef","Map","prefetchRootRef","prefetchInFlightRef","prefetchedTargetsRef","Set","prefetchTokenRef","rightDragRef","active","index","inputStyle","width","padding","border","borderRadius","background","fontSize","color","transition","outline","labelStyle","display","marginBottom","fontWeight","selectedUnderlineStyle","borderBottom","paddingBottom","formatAccountLabel","account","name","profileName","username","email","profileEmail","concat","getCategoryLabel","category","raw","label","title","categoryName","displayName","text","String","trim","fallback","id","url","isNumericCategoryId","value","test","looksLikeCategoryUrl","isAttributeOptionNode","node","parent","parentId","undefined","idValue","urlValue","nameValue","toLowerCase","normalizedId","Array","isArray","children","length","optionLikeValues","has","filterCategoryChildren","nodes","filter","getCategoryValue","getNodeKey","mergeCategoryTrees","prevNodes","nextNodes","prev","prevMap","key","set","used","merged","map","add","prevNode","get","nextChildren","prevChildren","mergedChildren","_objectSpread","entries","push","buildPathToNode","targetValue","path","arguments","target","_node$children","matches","nextValue","nextPath","childPath","findNode","_node$children2","found","getBreadcrumbForPath","breadcrumb","current","pathItem","find","cat","resolveCategorySelection","selectedNode","numericNode","reverse","categoryId","categoryUrl","previews","file","URL","createObjectURL","forEach","preview","revokeObjectURL","stopRightDrag","handleMouseUp","handleWindowBlur","window","addEventListener","removeEventListener","handleImageInputChange","event","_event$target","selected","from","files","type","startsWith","removeAdImage","indexToRemove","list","_","idx","startRightDrag","button","preventDefault","moveRightDragTo","targetIndex","Number","isInteger","moved","splice","currentPath","every","item","restoredPath","accountId","lastId","requestChildren","console","log","getCurrentCategories","join","scrollTop","getSelectedCategory","updateCategorySelection","alert","parentNode","warn","normalizedValue","indexInPath","findIndex","slice","categoryKey","newPath","childrenResult","knownChildren","selectedChildren","fetchedChildren","hasFetchedChildren","hasKnownChildren","childrenLoadFailed","isLeaf","next","updateNodeChildren","_node$children3","rawId","rawUrl","pending","task","params","URLSearchParams","_data","data","toString","rawChildren","_data2","refreshParams","filteredChildren","count","sample","_updated$children","updated","error","message","delete","fetchAccountPostalCode","success","postalCode","rootValue","token","_node$children4","Promise","resolve","setTimeout","finally","getCategoryBreadcrumb","goBackInCategories","currentCategories","className","style","position","top","left","right","bottom","backgroundColor","backdropFilter","alignItems","justifyContent","zIndex","animation","maxWidth","maxHeight","overflow","boxShadow","gap","height","margin","onClick","cursor","onMouseEnter","e","currentTarget","borderColor","onMouseLeave","size","flexDirection","onChange","proxy","placeholder","onFocus","onBlur","description","rows","minHeight","resize","fontFamily","price","Date","toLocaleDateString","disabled","marginTop","flexWrap","Fragment","ref","overflowY","textAlign","borderTop","field","_field$options","required","options","option","whiteSpace","accept","multiple","gridTemplateColumns","onContextMenu","onMouseDown","onMouseUp","aspectRatio","userSelect","src","alt","draggable","objectFit","pointerEvents","minWidth","stopPropagation","lineHeight","opacity"],"sources":["/Users/eurocare/Downloads/barvihaluxury-main/frontend/src/components/AdModal.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { apiFetchJson } from \"../api\";\nimport { XIcon, ChevronRightIcon, RefreshIcon, LoadingIcon } from \"./Icons\";\n\nconst AdModal = ({\n  isOpen,\n  onClose,\n  onSubmit,\n  publishing,\n  accounts,\n  categories,\n  onRefreshCategories,\n  loadingCategories,\n  extraFields,\n  extraFieldValues,\n  setExtraFieldValues,\n  loadingExtraFields,\n  extraFieldsError,\n  newAd,\n  setNewAd,\n  adImages,\n  setAdImages,\n  categoriesUpdatedAt\n}) => {\n  if (!isOpen) return null;\n\n  const [categoryPath, setCategoryPath] = useState([]);\n  const [localCategories, setLocalCategories] = useState([]);\n  const [didRestorePath, setDidRestorePath] = useState(false);\n  const [imagePreviews, setImagePreviews] = useState([]);\n  const [rightDragActive, setRightDragActive] = useState(false);\n  const [rightDragIndex, setRightDragIndex] = useState(null);\n  const [loadingPlz, setLoadingPlz] = useState(false);\n  const [categoryChildrenError, setCategoryChildrenError] = useState(\"\");\n  const categoryListRef = useRef(null);\n  const imageInputRef = useRef(null);\n  const pendingChildrenRef = useRef(new Map());\n  const prefetchRootRef = useRef(\"\");\n  const prefetchInFlightRef = useRef(false);\n  const prefetchedTargetsRef = useRef(new Set());\n  const prefetchTokenRef = useRef(0);\n  const rightDragRef = useRef({ active: false, index: -1 });\n\n  const inputStyle = {\n    width: \"100%\",\n    padding: \"12px 16px\",\n    border: \"1px solid rgba(148,163,184,0.2)\",\n    borderRadius: \"14px\",\n    background: \"rgba(15,23,42,0.8)\",\n    fontSize: \"14px\",\n    color: \"#e2e8f0\",\n    transition: \"all 0.2s ease\",\n    outline: \"none\"\n  };\n\n  const labelStyle = {\n    display: \"block\",\n    marginBottom: \"10px\",\n    fontWeight: \"600\",\n    color: \"#e2e8f0\",\n    fontSize: \"14px\"\n  };\n  const selectedUnderlineStyle = {\n    borderBottom: \"1px solid rgba(125, 211, 252, 0.95)\",\n    paddingBottom: \"1px\"\n  };\n\n  const formatAccountLabel = (account) => {\n    const name = account.profileName || account.username || \"ÐÐºÐºÐ°ÑƒÐ½Ñ‚\";\n    const email = account.profileEmail || \"\";\n    return email ? `${name} (${email})` : name;\n  };\n\n  const getCategoryLabel = (category) => {\n    if (!category) return \"\";\n    const raw =\n      category.name ||\n      category.label ||\n      category.title ||\n      category.categoryName ||\n      category.displayName;\n    const text = String(raw || \"\").trim();\n    if (text) return text;\n    const fallback = category.id || category.url || \"\";\n    return String(fallback);\n  };\n\n  const isNumericCategoryId = (value) => /^\\d+$/.test(String(value || \"\"));\n\n  const looksLikeCategoryUrl = (value) => /\\/c\\d+(?:\\/|$)/i.test(String(value || \"\"));\n\n  const isAttributeOptionNode = (node, parent) => {\n    if (!node || !parent) return false;\n    const parentId = parent.id !== undefined && parent.id !== null ? String(parent.id) : \"\";\n    if (!isNumericCategoryId(parentId)) return false;\n    const idValue = node.id !== undefined && node.id !== null ? String(node.id) : \"\";\n    const urlValue = node.url ? String(node.url) : \"\";\n    const nameValue = String(node.name || node.label || \"\").trim().toLowerCase();\n    const normalizedId = idValue.trim().toLowerCase();\n    if (isNumericCategoryId(normalizedId)) return false;\n    if (looksLikeCategoryUrl(urlValue)) return false;\n    if (Array.isArray(node.children) && node.children.length > 0) return false;\n    if (!normalizedId || !nameValue) return false;\n    // Keep real subcategories with slug-like ids (e.g. \"drucker_scanner\").\n    // Filter only very small option-like values that are likely field options.\n    const optionLikeValues = new Set([\"ja\", \"nein\", \"yes\", \"no\", \"new\", \"used\", \"other\"]);\n    return optionLikeValues.has(normalizedId) || optionLikeValues.has(nameValue);\n  };\n\n  const filterCategoryChildren = (nodes, parent) =>\n    (Array.isArray(nodes) ? nodes : []).filter((node) => !isAttributeOptionNode(node, parent));\n\n  const getCategoryValue = (category) => {\n    if (!category) return \"\";\n    const id = category.id !== undefined && category.id !== null ? String(category.id) : \"\";\n    const url = category.url ? String(category.url) : \"\";\n    if (id && isNumericCategoryId(id)) return id;\n    if (url) return url;\n    return id;\n  };\n\n  const getNodeKey = (node) => {\n    if (!node) return \"\";\n    const value = getCategoryValue(node);\n    if (value) return `value:${value}`;\n    if (node.name) return `name:${String(node.name)}`;\n    return \"\";\n  };\n\n  const mergeCategoryTrees = (prevNodes, nextNodes) => {\n    if (!Array.isArray(nextNodes) || !nextNodes.length) {\n      return Array.isArray(prevNodes) ? prevNodes : [];\n    }\n    const prev = Array.isArray(prevNodes) ? prevNodes : [];\n    const prevMap = new Map();\n    for (const node of prev) {\n      const key = getNodeKey(node);\n      if (key) prevMap.set(key, node);\n    }\n    const used = new Set();\n    const merged = nextNodes.map((node) => {\n      const key = getNodeKey(node);\n      if (key) used.add(key);\n      const prevNode = key ? prevMap.get(key) : null;\n      const nextChildren = Array.isArray(node.children) ? node.children : [];\n      const prevChildren = prevNode?.children || [];\n      const mergedChildren = nextChildren.length\n        ? mergeCategoryTrees(prevChildren, nextChildren)\n        : prevChildren;\n      return {\n        ...(prevNode || {}),\n        ...node,\n        children: mergedChildren\n      };\n    });\n    for (const [key, node] of prevMap.entries()) {\n      if (!used.has(key)) merged.push(node);\n    }\n    return merged;\n  };\n\n  const buildPathToNode = (nodes, targetValue, path = []) => {\n    if (!targetValue || !Array.isArray(nodes)) return [];\n    const target = String(targetValue);\n    for (const node of nodes) {\n      const matches =\n        (node.id !== undefined && node.id !== null && String(node.id) === target) ||\n        (node.url && String(node.url) === target);\n      const nextValue = getCategoryValue(node);\n      const nextPath = nextValue ? [...path, nextValue] : path;\n      if (matches) return nextPath;\n      if (node.children?.length) {\n        const childPath = buildPathToNode(node.children, targetValue, nextPath);\n        if (childPath.length) return childPath;\n      }\n    }\n    return [];\n  };\n\n  const findNode = (nodes, value) => {\n    if (!value) return null;\n    for (const node of nodes) {\n      if (String(node.id) === String(value) || String(node.url) === String(value)) return node;\n      if (node.children?.length) {\n        const found = findNode(node.children, value);\n        if (found) return found;\n      }\n    }\n    return null;\n  };\n\n  const getBreadcrumbForPath = (path) => {\n    const breadcrumb = [];\n    let current = localCategories;\n    for (const pathItem of path) {\n      const found = current.find((cat) =>\n        (cat.id && String(cat.id) === String(pathItem)) ||\n        (cat.url && String(cat.url) === String(pathItem))\n      );\n      if (!found) break;\n      breadcrumb.push(found);\n      current = filterCategoryChildren(found.children || [], found);\n    }\n    return breadcrumb;\n  };\n\n  const resolveCategorySelection = (path) => {\n    const breadcrumb = getBreadcrumbForPath(path);\n    const selectedNode = breadcrumb.length ? breadcrumb[breadcrumb.length - 1] : null;\n    const numericNode = [...breadcrumb].reverse().find((node) => /^\\d+$/.test(String(node?.id || \"\")));\n    return {\n      selectedNode,\n      numericNode: numericNode || selectedNode\n    };\n  };\n\n  useEffect(() => {\n    setLocalCategories((prev) => mergeCategoryTrees(prev, categories || []));\n  }, [categories]);\n\n  useEffect(() => {\n    if (isOpen) {\n      setCategoryPath([]);\n      setDidRestorePath(false);\n      setCategoryChildrenError(\"\");\n      setNewAd((prev) => ({\n        ...prev,\n        categoryId: \"\",\n        categoryUrl: \"\",\n        categoryPath: []\n      }));\n    }\n  }, [isOpen, setNewAd]);\n\n  useEffect(() => {\n    if (!adImages || adImages.length === 0) {\n      setImagePreviews([]);\n      return undefined;\n    }\n\n    const previews = adImages.map((file) => ({\n      file,\n      url: URL.createObjectURL(file)\n    }));\n    setImagePreviews(previews);\n\n    return () => {\n      previews.forEach((preview) => URL.revokeObjectURL(preview.url));\n    };\n  }, [adImages]);\n\n  const stopRightDrag = () => {\n    if (!rightDragRef.current.active) return;\n    rightDragRef.current = { active: false, index: -1 };\n    setRightDragActive(false);\n    setRightDragIndex(null);\n  };\n\n  useEffect(() => {\n    const handleMouseUp = () => stopRightDrag();\n    const handleWindowBlur = () => stopRightDrag();\n    window.addEventListener(\"mouseup\", handleMouseUp);\n    window.addEventListener(\"blur\", handleWindowBlur);\n    return () => {\n      window.removeEventListener(\"mouseup\", handleMouseUp);\n      window.removeEventListener(\"blur\", handleWindowBlur);\n    };\n  }, []);\n\n  const handleImageInputChange = (event) => {\n    const selected = Array.from(event?.target?.files || []).filter((file) =>\n      String(file?.type || \"\").toLowerCase().startsWith(\"image/\")\n    );\n    if (event?.target) event.target.value = \"\";\n    if (!selected.length) return;\n    setAdImages(selected);\n  };\n\n  const removeAdImage = (indexToRemove) => {\n    stopRightDrag();\n    setAdImages((prev) => {\n      const list = Array.isArray(prev) ? prev : [];\n      return list.filter((_, idx) => idx !== indexToRemove);\n    });\n    if (imageInputRef.current) {\n      imageInputRef.current.value = \"\";\n    }\n  };\n\n  const startRightDrag = (event, index) => {\n    if (event.button !== 2) return;\n    event.preventDefault();\n    rightDragRef.current = { active: true, index };\n    setRightDragActive(true);\n    setRightDragIndex(index);\n  };\n\n  const moveRightDragTo = (targetIndex) => {\n    const current = rightDragRef.current;\n    if (!current.active) return;\n    if (!Number.isInteger(targetIndex)) return;\n    if (current.index === targetIndex) return;\n\n    setAdImages((prev) => {\n      const list = Array.isArray(prev) ? [...prev] : [];\n      if (\n        current.index < 0 ||\n        current.index >= list.length ||\n        targetIndex < 0 ||\n        targetIndex >= list.length\n      ) {\n        return prev;\n      }\n      const [moved] = list.splice(current.index, 1);\n      list.splice(targetIndex, 0, moved);\n      return list;\n    });\n\n    rightDragRef.current = { active: true, index: targetIndex };\n    setRightDragIndex(targetIndex);\n  };\n\n  useEffect(() => {\n    if (!isOpen) return;\n    setNewAd((prev) => {\n      const currentPath = Array.isArray(prev.categoryPath) ? prev.categoryPath : [];\n      const nextPath = categoryPath;\n      if (currentPath.length === nextPath.length && currentPath.every((item, idx) => String(item) === String(nextPath[idx]))) {\n        return prev;\n      }\n      return { ...prev, categoryPath: [...nextPath] };\n    });\n  }, [isOpen, categoryPath, setNewAd]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    if (categoryPath.length) return;\n    if (didRestorePath) return;\n    const target = newAd?.categoryId || newAd?.categoryUrl;\n    if (!target) return;\n    const restoredPath = buildPathToNode(localCategories, target);\n    if (restoredPath.length) {\n      setCategoryPath(restoredPath);\n      setDidRestorePath(true);\n    }\n  }, [isOpen, categoryPath.length, didRestorePath, newAd?.categoryId, newAd?.categoryUrl, localCategories]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    if (!newAd.accountId) return;\n    if (!categoryPath.length) return;\n    const lastId = categoryPath[categoryPath.length - 1];\n    const node = findNode(localCategories, lastId);\n    if (node && (!node.children || node.children.length === 0)) {\n      requestChildren(node);\n    }\n  }, [isOpen, newAd.accountId, categoryPath, localCategories]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    if (!categoryPath.length) {\n      console.log(\"[AdModal] category path empty\");\n      return;\n    }\n    const current = getCurrentCategories();\n    console.log(\"[AdModal] category path\", categoryPath.join(\" > \"), \"current count\", current.length);\n  }, [isOpen, categoryPath, localCategories]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    if (!categoryListRef.current) return;\n    categoryListRef.current.scrollTop = 0;\n  }, [isOpen, categoryPath]);\n\n  const getCurrentCategories = () => {\n    if (categoryPath.length === 0) return localCategories;\n\n    let current = localCategories;\n    let parent = null;\n    for (const pathItem of categoryPath) {\n      const found = current.find((cat) =>\n        (cat.id && String(cat.id) === String(pathItem)) ||\n        (cat.url && String(cat.url) === String(pathItem))\n      );\n      if (!found) {\n        const fallback = findNode(localCategories, pathItem);\n        return filterCategoryChildren(fallback?.children || [], fallback);\n      }\n      parent = found;\n      current = filterCategoryChildren(found.children || [], found);\n    }\n    return current;\n  };\n\n  const getSelectedCategory = () => {\n    if (categoryPath.length === 0) return null;\n    const lastId = categoryPath[categoryPath.length - 1];\n    return findNode(localCategories, lastId);\n  };\n\n  const updateCategorySelection = async (category) => {\n    if (!newAd.accountId) {\n      alert(\"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\");\n      return;\n    }\n    setDidRestorePath(true);\n    const parentNode = getSelectedCategory();\n    if (isAttributeOptionNode(category, parentNode)) {\n      console.warn(\"[AdModal] ignoring attribute option node\", category?.name || category?.id);\n      return;\n    }\n    const value = getCategoryValue(category);\n    if (!value) return;\n    const normalizedValue = String(value);\n\n    // Ð•ÑÐ»Ð¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ ÑƒÐ¶Ðµ Ð² Ð¿ÑƒÑ‚Ð¸, Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ðº Ð½ÐµÐ¹\n    const indexInPath = categoryPath.findIndex((id) => String(id) === normalizedValue);\n    if (indexInPath !== -1) {\n      const nextPath = categoryPath.slice(0, indexInPath + 1);\n      setCategoryPath(nextPath);\n\n      // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ\n      const { selectedNode, numericNode } = resolveCategorySelection(nextPath);\n      setNewAd((prev) => ({\n        ...prev,\n        categoryId: numericNode?.id ? String(numericNode.id) : \"\",\n        categoryUrl: selectedNode?.url || numericNode?.url || \"\",\n        categoryKey: nextPath.join(\">\"),\n        categoryPath: [...nextPath]\n      }));\n      return;\n    }\n\n    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ Ð² Ð¿ÑƒÑ‚ÑŒ\n    const newPath = [...categoryPath, normalizedValue];\n    setCategoryPath(newPath);\n    setCategoryChildrenError(\"\");\n\n    // Ð’Ð¡Ð•Ð“Ð”Ð Ð¿Ñ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð´ÐµÑ‚ÐµÐ¹, Ð´Ð°Ð¶Ðµ ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ ÐµÑÑ‚ÑŒ\n    // (ÑÑ‚Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ñ‚ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ 3+ ÑƒÑ€Ð¾Ð²Ð½ÐµÐ¹)\n    const childrenResult = await requestChildren(category);\n\n    // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ Ð² Ñ„Ð¾Ñ€Ð¼Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¾Ð½Ð° ÐºÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ\n    const { selectedNode, numericNode } = resolveCategorySelection(newPath);\n    const knownChildren = Array.isArray(category?.children) ? category.children : [];\n    const selectedChildren = Array.isArray(selectedNode?.children) ? selectedNode.children : [];\n    const fetchedChildren = Array.isArray(childrenResult) ? childrenResult : null;\n    const hasFetchedChildren = fetchedChildren\n      ? filterCategoryChildren(fetchedChildren, category).length > 0\n      : null;\n    const hasKnownChildren =\n      filterCategoryChildren(knownChildren, category).length > 0 ||\n      filterCategoryChildren(selectedChildren, selectedNode).length > 0;\n    const childrenLoadFailed = childrenResult === null && !hasKnownChildren;\n    const isLeaf = childrenLoadFailed\n      ? false\n      : (hasFetchedChildren !== null ? !hasFetchedChildren : !hasKnownChildren);\n\n    setNewAd((prev) => {\n      const next = { ...prev };\n      if (isLeaf) {\n        next.categoryId = numericNode?.id ? String(numericNode.id) : \"\";\n        next.categoryUrl = selectedNode?.url || numericNode?.url || \"\";\n      } else {\n        next.categoryId = \"\";\n        next.categoryUrl = \"\";\n      }\n      next.categoryKey = newPath.join(\">\");\n      next.categoryPath = [...newPath];\n\n      if (!next.categoryId || next.categoryId !== prev.categoryId) {\n        if (setExtraFieldValues) {\n          setExtraFieldValues({});\n        }\n      }\n      return next;\n    });\n  };\n\n  const updateNodeChildren = (nodes, targetValue, children) =>\n    nodes.map((node) => {\n      const matches = String(node.id) === String(targetValue) || String(node.url) === String(targetValue);\n      if (matches) {\n        return { ...node, children };\n      }\n      if (node.children?.length) {\n        return { ...node, children: updateNodeChildren(node.children, targetValue, children) };\n      }\n      return node;\n    });\n\n  const requestChildren = async (node) => {\n    const rawId = node?.id !== undefined && node?.id !== null ? String(node.id) : \"\";\n    const rawUrl = node?.url ? String(node.url) : \"\";\n    const idValue = rawId && isNumericCategoryId(rawId) ? rawId : \"\";\n    const urlValue = idValue ? \"\" : (rawUrl || \"\");\n    if (!idValue && !urlValue) return;\n    const targetValue = getCategoryValue(node) || idValue || urlValue;\n    if (!targetValue) return;\n\n    const pending = pendingChildrenRef.current.get(targetValue);\n    if (pending) return pending;\n\n    const task = (async () => {\n      const params = new URLSearchParams();\n      if (idValue) params.set(\"id\", idValue);\n      else params.set(\"url\", urlValue);\n      if (newAd?.accountId) params.set(\"accountId\", newAd.accountId);\n      try {\n        let data = await apiFetchJson(`/api/categories/children?${params.toString()}`);\n        let rawChildren = Array.isArray(data?.children) ? data.children : null;\n        if (Array.isArray(rawChildren) && rawChildren.length === 0) {\n          const refreshParams = new URLSearchParams(params.toString());\n          refreshParams.set(\"refresh\", \"true\");\n          data = await apiFetchJson(`/api/categories/children?${refreshParams.toString()}`);\n          rawChildren = Array.isArray(data?.children) ? data.children : rawChildren;\n        }\n        if (!Array.isArray(rawChildren)) return null;\n        const filteredChildren = filterCategoryChildren(rawChildren, node);\n        const count = Array.isArray(filteredChildren) ? filteredChildren.length : 0;\n        const sample = Array.isArray(filteredChildren)\n          ? filteredChildren.slice(0, 5).map((item) => item?.name || item?.id || item?.url)\n          : [];\n        console.log(\"[AdModal] children response count\", count, \"target\", targetValue, \"sample\", sample);\n        setLocalCategories((prev) => {\n          const next = updateNodeChildren(prev, targetValue, filteredChildren);\n          const updated = findNode(next, targetValue);\n          console.log(\"[AdModal] children applied count\", updated?.children?.length || 0, \"target\", targetValue);\n          return next;\n        });\n        setCategoryChildrenError(\"\");\n        return filteredChildren;\n      } catch (error) {\n        const message = error?.message || \"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐµÑ‚Ð¸\";\n        console.error(\"[AdModal] children request failed\", {\n          target: targetValue,\n          accountId: newAd?.accountId || \"\",\n          message\n        });\n        setCategoryChildrenError(`ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸: ${message}`);\n        return null;\n      }\n    })();\n\n    pendingChildrenRef.current.set(targetValue, task);\n    try {\n      return await task;\n    } finally {\n      pendingChildrenRef.current.delete(targetValue);\n    }\n  };\n\n  const fetchAccountPostalCode = async () => {\n    if (!newAd?.accountId) {\n      alert(\"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\");\n      return;\n    }\n    setLoadingPlz(true);\n    try {\n      const data = await apiFetchJson(`/api/accounts/${newAd.accountId}/plz`);\n      if (data?.success && data?.postalCode) {\n        setNewAd((prev) => ({ ...prev, postalCode: data.postalCode }));\n      } else {\n        alert(data?.error || \"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\");\n      }\n    } catch (error) {\n      alert(error?.message || \"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\");\n    } finally {\n      setLoadingPlz(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!isOpen) return;\n    if (!newAd.accountId) return;\n    if (categoryPath.length !== 1) return;\n    const rootValue = String(categoryPath[0] || \"\");\n    if (!rootValue) return;\n\n    if (prefetchRootRef.current !== rootValue) {\n      prefetchRootRef.current = rootValue;\n      prefetchedTargetsRef.current = new Set();\n      prefetchInFlightRef.current = false;\n    }\n\n    if (prefetchInFlightRef.current) return;\n    const current = getCurrentCategories();\n    if (!current.length) return;\n\n    const token = ++prefetchTokenRef.current;\n    prefetchInFlightRef.current = true;\n\n    (async () => {\n      for (const node of current) {\n        if (prefetchTokenRef.current !== token) return;\n        const key = getCategoryValue(node);\n        if (!key) continue;\n        if (prefetchedTargetsRef.current.has(key)) continue;\n        prefetchedTargetsRef.current.add(key);\n        if (node.children?.length) continue;\n        await requestChildren(node);\n        await new Promise((resolve) => setTimeout(resolve, 120));\n      }\n    })().finally(() => {\n      if (prefetchTokenRef.current === token) {\n        prefetchInFlightRef.current = false;\n      }\n    });\n  }, [isOpen, newAd.accountId, categoryPath, localCategories]);\n\n  const getCategoryBreadcrumb = () => {\n    const breadcrumb = [];\n    let current = localCategories;\n\n    for (const pathItem of categoryPath) {\n      const found = current.find((cat) =>\n        (cat.id && String(cat.id) === String(pathItem)) ||\n        (cat.url && String(cat.url) === String(pathItem))\n      );\n      if (found) {\n        breadcrumb.push(found);\n        current = filterCategoryChildren(found.children || [], found);\n      }\n    }\n\n    return breadcrumb;\n  };\n\n  const goBackInCategories = (index) => {\n    setDidRestorePath(true);\n    if (index < 0) {\n      setCategoryPath([]);\n    } else {\n      setCategoryPath(categoryPath.slice(0, index + 1));\n    }\n  };\n\n  const currentCategories = getCurrentCategories();\n  const breadcrumb = getCategoryBreadcrumb();\n\n  return (\n    <div className=\"modal-overlay\" style={{\n      position: \"fixed\",\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: \"rgba(2, 6, 23, 0.85)\",\n      backdropFilter: \"blur(8px)\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      zIndex: 5000,\n      padding: \"20px\",\n      animation: \"fadeIn 0.2s ease-out\"\n    }}>\n      <div className=\"modal-card modal-card-wide modal-card-tall\" style={{\n        background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.98) 100%)\",\n        borderRadius: \"24px\",\n        padding: \"32px\",\n        width: \"760px\",\n        maxWidth: \"100%\",\n        maxHeight: \"92vh\",\n        overflow: \"auto\",\n        border: \"1px solid rgba(148,163,184,0.15)\",\n        boxShadow: \"0 30px 60px rgba(0,0,0,0.5), 0 0 60px rgba(0,0,0,0.3)\",\n        color: \"#e2e8f0\",\n        animation: \"scaleIn 0.3s ease-out\"\n      }}>\n        <div style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"flex-start\",\n          marginBottom: \"28px\"\n        }}>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: \"14px\" }}>\n            <div style={{\n              width: \"48px\",\n              height: \"48px\",\n              borderRadius: \"14px\",\n              background: \"linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(245, 158, 11, 0.1))\",\n              border: \"1px solid rgba(245, 158, 11, 0.3)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              boxShadow: \"0 4px 15px rgba(245, 158, 11, 0.2)\",\n              fontSize: \"22px\"\n            }}>\n              ðŸ“¦\n            </div>\n            <div>\n              <h2 style={{ margin: 0, fontSize: \"22px\", fontWeight: \"700\" }}>Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ðµ</h2>\n              <p style={{ margin: \"4px 0 0\", color: \"#94a3b8\", fontSize: \"13px\" }}>\n                Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»Ñ Ð¸ Ð¾Ð¿ÑƒÐ±Ð»Ð¸ÐºÑƒÐ¹Ñ‚Ðµ Ð² Kleinanzeigen\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            style={{\n              width: \"40px\",\n              height: \"40px\",\n              borderRadius: \"12px\",\n              background: \"rgba(148,163,184,0.1)\",\n              border: \"1px solid rgba(148,163,184,0.2)\",\n              cursor: \"pointer\",\n              color: \"#94a3b8\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              transition: \"all 0.2s ease\"\n            }}\n            onMouseEnter={(e) => {\n              e.currentTarget.style.background = \"rgba(239, 68, 68, 0.15)\";\n              e.currentTarget.style.borderColor = \"rgba(239, 68, 68, 0.3)\";\n              e.currentTarget.style.color = \"#f87171\";\n            }}\n            onMouseLeave={(e) => {\n              e.currentTarget.style.background = \"rgba(148,163,184,0.1)\";\n              e.currentTarget.style.borderColor = \"rgba(148,163,184,0.2)\";\n              e.currentTarget.style.color = \"#94a3b8\";\n            }}\n          >\n            <XIcon size={18} />\n          </button>\n        </div>\n\n        <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"18px\" }}>\n          <div>\n            <label style={labelStyle}>ÐÐºÐºÐ°ÑƒÐ½Ñ‚:</label>\n            <select\n              value={newAd.accountId}\n              onChange={(e) => setNewAd((prev) => ({ ...prev, accountId: e.target.value }))}\n              style={inputStyle}\n            >\n              <option value=\"\">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚</option>\n              {accounts.map((account) => (\n                <option key={account.id} value={account.id}>\n                  {formatAccountLabel(account)} ({account.proxy || \"Ð‘ÐµÐ· Ð¿Ñ€Ð¾ÐºÑÐ¸\"})\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label style={labelStyle}>ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ:</label>\n            <input\n              type=\"text\"\n              value={newAd.title}\n              onChange={(e) => setNewAd((prev) => ({ ...prev, title: e.target.value }))}\n              placeholder=\"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (10-65 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)\"\n              style={inputStyle}\n              onFocus={(e) => e.currentTarget.style.borderColor = \"rgba(59,130,246,0.5)\"}\n              onBlur={(e) => e.currentTarget.style.borderColor = \"rgba(148,163,184,0.3)\"}\n            />\n          </div>\n\n          <div>\n            <label style={labelStyle}>ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ:</label>\n            <textarea\n              value={newAd.description}\n              onChange={(e) => setNewAd((prev) => ({ ...prev, description: e.target.value }))}\n              placeholder=\"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ (10-4000 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)\"\n              rows=\"5\"\n              style={{\n                ...inputStyle,\n                minHeight: \"140px\",\n                resize: \"vertical\",\n                fontFamily: \"inherit\"\n              }}\n              onFocus={(e) => e.currentTarget.style.borderColor = \"rgba(59,130,246,0.5)\"}\n              onBlur={(e) => e.currentTarget.style.borderColor = \"rgba(148,163,184,0.3)\"}\n            />\n          </div>\n\n          <div>\n            <label style={labelStyle}>Ð¦ÐµÐ½Ð° (EUR):</label>\n            <div style={{ display: \"flex\", gap: \"8px\", alignItems: \"center\" }}>\n              <input\n                type=\"number\"\n                value={newAd.price}\n                onChange={(e) => setNewAd((prev) => ({ ...prev, price: e.target.value }))}\n                placeholder=\"0.00\"\n                style={inputStyle}\n                onFocus={(e) => e.currentTarget.style.borderColor = \"rgba(59,130,246,0.5)\"}\n                onBlur={(e) => e.currentTarget.style.borderColor = \"rgba(148,163,184,0.3)\"}\n              />\n              <span style={{ color: \"#94a3b8\", fontWeight: \"600\" }}>â‚¬</span>\n            </div>\n          </div>\n\n          <div>\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n              <label style={labelStyle}>ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ:</label>\n              <div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\" }}>\n                {categoriesUpdatedAt && (\n                  <span style={{ fontSize: \"12px\", color: \"#94a3b8\" }}>\n                    ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾: {new Date(categoriesUpdatedAt).toLocaleDateString()}\n                  </span>\n                )}\n                <button\n                  type=\"button\"\n                  onClick={() => onRefreshCategories(true)}\n                  disabled={loadingCategories}\n                  className=\"secondary-button\"\n                  style={{\n                    padding: \"6px 12px\",\n                    border: \"1px solid rgba(148,163,184,0.3)\",\n                    cursor: loadingCategories ? \"not-allowed\" : \"pointer\",\n                    fontSize: \"12px\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: \"6px\"\n                  }}\n                >\n                  {loadingCategories ? <LoadingIcon size={14} /> : <RefreshIcon size={14} />}\n                  {loadingCategories ? \"ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ...\" : \"ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ\"}\n                </button>\n              </div>\n            </div>\n\n            <div style={{\n              border: \"1px solid rgba(148,163,184,0.3)\",\n              borderRadius: \"12px\",\n              background: \"rgba(15,23,42,0.7)\",\n              marginTop: \"10px\",\n              overflow: \"hidden\"\n            }}>\n              <div style={{ padding: \"12px 16px\", borderBottom: \"1px solid rgba(148,163,184,0.2)\" }}>\n                <div style={{ fontWeight: \"600\", color: \"#e2e8f0\" }}>Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ</div>\n                <div style={{ fontSize: \"12px\", color: \"#94a3b8\" }}>ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ Ð¿Ð¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼</div>\n              </div>\n\n              {/* Ð¥Ð»ÐµÐ±Ð½Ñ‹Ðµ ÐºÑ€Ð¾ÑˆÐºÐ¸ */}\n              {breadcrumb.length > 0 && (\n                <div style={{\n                  padding: \"10px 16px\",\n                  borderBottom: \"1px solid rgba(148,163,184,0.2)\",\n                  display: \"flex\",\n                  gap: \"8px\",\n                  alignItems: \"center\",\n                  flexWrap: \"wrap\",\n                  fontSize: \"12px\",\n                  color: \"#94a3b8\"\n                }}>\n                  <button\n                    onClick={() => goBackInCategories(-1)}\n                    style={{\n                      background: \"rgba(59,130,246,0.1)\",\n                      border: \"1px solid rgba(59,130,246,0.3)\",\n                      borderRadius: \"6px\",\n                      padding: \"4px 8px\",\n                      cursor: \"pointer\",\n                      color: \"#7dd3fc\",\n                      fontSize: \"12px\",\n                      transition: \"all 0.2s ease\"\n                    }}\n                    onMouseEnter={(e) => e.currentTarget.style.background = \"rgba(59,130,246,0.2)\"}\n                    onMouseLeave={(e) => e.currentTarget.style.background = \"rgba(59,130,246,0.1)\"}\n                  >\n                    Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸\n                  </button>\n                  {breadcrumb.map((cat, index) => (\n                    <React.Fragment key={cat.id || cat.url}>\n                      <ChevronRightIcon size={12} />\n                      <button\n                        onClick={() => goBackInCategories(index)}\n                        style={{\n                          background: index === breadcrumb.length - 1 ? \"rgba(59,130,246,0.2)\" : \"rgba(148,163,184,0.1)\",\n                          border: \"1px solid \" + (index === breadcrumb.length - 1 ? \"rgba(59,130,246,0.3)\" : \"rgba(148,163,184,0.2)\"),\n                          borderRadius: \"6px\",\n                          padding: \"4px 8px\",\n                          cursor: index === breadcrumb.length - 1 ? \"default\" : \"pointer\",\n                          color: index === breadcrumb.length - 1 ? \"#7dd3fc\" : \"#e2e8f0\",\n                          fontSize: \"12px\",\n                          transition: \"all 0.2s ease\"\n                        }}\n                      >\n                        {getCategoryLabel(cat)}\n                      </button>\n                    </React.Fragment>\n                  ))}\n                </div>\n              )}\n\n              <div ref={categoryListRef} style={{ padding: \"12px\", minHeight: \"220px\", maxHeight: \"300px\", overflowY: \"auto\" }}>\n                {currentCategories.length ? (\n                  currentCategories.map((category) => {\n                    return (\n                      <button\n                        key={category.id || category.url || getCategoryLabel(category)}\n                        type=\"button\"\n                        onClick={() => updateCategorySelection(category)}\n                        disabled={!newAd.accountId}\n                        style={{\n                          width: \"100%\",\n                          textAlign: \"left\",\n                          padding: \"10px 12px\",\n                          marginBottom: \"6px\",\n                          borderRadius: \"10px\",\n                          border: \"1px solid transparent\",\n                          background: \"rgba(148,163,184,0.05)\",\n                          color: \"#e2e8f0\",\n                          cursor: newAd.accountId ? \"pointer\" : \"not-allowed\",\n                          transition: \"all 0.2s ease\"\n                        }}\n                        onMouseEnter={(e) => {\n                          e.currentTarget.style.background = \"rgba(59,130,246,0.1)\";\n                          e.currentTarget.style.borderColor = \"rgba(59,130,246,0.3)\";\n                        }}\n                        onMouseLeave={(e) => {\n                          e.currentTarget.style.background = \"rgba(148,163,184,0.05)\";\n                          e.currentTarget.style.borderColor = \"transparent\";\n                        }}\n                      >\n                        <span style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n                          <span>{getCategoryLabel(category)}</span>\n                          <ChevronRightIcon size={16} color=\"#94a3b8\" />\n                        </span>\n                      </button>\n                    );\n                  })\n                ) : (\n                  <div style={{ color: \"#94a3b8\", padding: \"12px\", textAlign: \"center\" }}>\n                    {!newAd.accountId\n                      ? \"Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚\"\n                      : categoryChildrenError\n                        ? \"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Â«ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒÂ».\"\n                      : categoryPath.length > 0\n                        ? \"ÐÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹ - ÑÑ‚Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ\"\n                        : \"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹\"}\n                  </div>\n                )}\n              </div>\n\n              {categoryChildrenError && (\n                <div style={{ color: \"#f87171\", fontSize: \"12px\", padding: \"0 16px 10px\" }}>\n                  {categoryChildrenError}\n                </div>\n              )}\n\n              <div style={{\n                borderTop: \"1px solid rgba(148,163,184,0.2)\",\n                padding: \"10px 16px\",\n                color: \"#94a3b8\",\n                fontSize: \"12px\",\n                display: \"flex\",\n                gap: \"8px\",\n                flexWrap: \"wrap\",\n                alignItems: \"center\"\n              }}>\n                <span style={{\n                  background: \"rgba(59,130,246,0.2)\",\n                  padding: \"4px 8px\",\n                  borderRadius: \"999px\",\n                  color: \"#e2e8f0\",\n                  fontSize: \"11px\",\n                  fontWeight: \"600\"\n                }}>\n                  Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð¾\n                </span>\n                {breadcrumb.length > 0 ? (\n                  breadcrumb.map((cat, index) => (\n                    <React.Fragment key={cat.id || cat.url}>\n                      {index > 0 && <ChevronRightIcon size={12} />}\n                      <span style={index === breadcrumb.length - 1 ? selectedUnderlineStyle : undefined}>\n                        {getCategoryLabel(cat)}\n                      </span>\n                    </React.Fragment>\n                  ))\n                ) : (\n                  <span>â€”</span>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {loadingExtraFields && (\n            <div style={{ color: \"#94a3b8\", fontSize: \"12px\", display: \"flex\", alignItems: \"center\", gap: \"8px\" }}>\n              <LoadingIcon size={14} />\n              Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸...\n            </div>\n          )}\n\n          {!loadingExtraFields && extraFieldsError && (\n            <div style={{ color: \"#f87171\", fontSize: \"12px\" }}>\n              ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸: {extraFieldsError}\n            </div>\n          )}\n\n          {!loadingExtraFields && !extraFieldsError && (newAd.categoryId || newAd.categoryUrl) && (!extraFields || extraFields.length === 0) && (\n            <div style={{ color: \"#94a3b8\", fontSize: \"12px\" }}>\n              Ð”Ð»Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½ÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð².\n            </div>\n          )}\n\n          {!loadingExtraFields && extraFields?.length > 0 && (\n            <div style={{ marginTop: \"6px\" }}>\n              <label style={labelStyle}>Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:</label>\n              <div style={{ display: \"grid\", gap: \"12px\" }}>\n                {extraFields.map((field) => {\n                  const key = field.name || field.label;\n                  const value = key ? (extraFieldValues?.[key] || \"\") : \"\";\n                  return (\n                    <div key={field.name || field.label} style={{ display: \"flex\", flexDirection: \"column\", gap: \"6px\" }}>\n                      <span style={{ fontSize: \"12px\", color: \"#94a3b8\" }}>\n                        {field.label}{field.required ? \" *\" : \"\"}\n                      </span>\n                      <select\n                        value={value}\n                        onChange={(e) => {\n                          const nextValue = e.target.value;\n                          setExtraFieldValues((prev) => ({ ...prev, [key]: nextValue }));\n                        }}\n                        style={inputStyle}\n                      >\n                        <option value=\"\">Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ</option>\n                        {field.options?.map((option) => (\n                          <option key={option.value || option.label} value={option.value}>\n                            {option.label}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n\n          <div>\n            <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", gap: \"12px\" }}>\n              <label style={labelStyle}>PLZ (Ð¸Ð½Ð´ÐµÐºÑ):</label>\n              <button\n                type=\"button\"\n                onClick={fetchAccountPostalCode}\n                disabled={loadingPlz}\n                style={{\n                  padding: \"6px 12px\",\n                  borderRadius: \"999px\",\n                  border: \"1px solid rgba(59,130,246,0.35)\",\n                  background: \"rgba(59,130,246,0.1)\",\n                  color: \"#60a5fa\",\n                  fontSize: \"12px\",\n                  fontWeight: \"600\",\n                  cursor: loadingPlz ? \"not-allowed\" : \"pointer\",\n                  whiteSpace: \"nowrap\"\n                }}\n              >\n                {loadingPlz ? \"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...\" : \"PLZ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°\"}\n              </button>\n            </div>\n            <input\n              type=\"text\"\n              value={newAd.postalCode}\n              onChange={(e) => setNewAd((prev) => ({ ...prev, postalCode: e.target.value }))}\n              placeholder=\"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ð¾Ñ‡Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¸Ð½Ð´ÐµÐºÑ\"\n              style={inputStyle}\n              onFocus={(e) => e.currentTarget.style.borderColor = \"rgba(59,130,246,0.5)\"}\n              onBlur={(e) => e.currentTarget.style.borderColor = \"rgba(148,163,184,0.3)\"}\n            />\n          </div>\n\n          <div>\n            <label style={labelStyle}>Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ:</label>\n            <input\n              ref={imageInputRef}\n              type=\"file\"\n              accept=\"image/*\"\n              multiple\n              onChange={handleImageInputChange}\n              style={{\n                width: \"100%\",\n                padding: \"12px\",\n                border: \"1px dashed rgba(148,163,184,0.4)\",\n                borderRadius: \"12px\",\n                background: \"rgba(15,23,42,0.7)\",\n                color: \"#e2e8f0\",\n                cursor: \"pointer\",\n                transition: \"all 0.3s ease\"\n              }}\n            />\n            {adImages.length > 0 && (\n              <div style={{ marginTop: \"8px\", fontSize: \"12px\", color: \"#94a3b8\" }}>\n                Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²: {adImages.length}. ÐŸÑ€Ð°Ð²Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹ Ð¼Ñ‹ÑˆÐ¸ Ð·Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð¸ Ð¿ÐµÑ€ÐµÑ‚Ð°Ñ‰Ð¸Ñ‚Ðµ Ð´Ð»Ñ ÑÐ¼ÐµÐ½Ñ‹ Ð¿Ð¾Ñ€ÑÐ´ÐºÐ°.\n              </div>\n            )}\n            {imagePreviews.length > 0 && (\n              <div\n                style={{\n                  marginTop: \"12px\",\n                  display: \"grid\",\n                  gridTemplateColumns: \"repeat(auto-fill, minmax(96px, 1fr))\",\n                  gap: \"10px\"\n                }}\n              >\n                {imagePreviews.map((preview, index) => (\n                  <div\n                    key={preview.url}\n                    onContextMenu={(event) => event.preventDefault()}\n                    onMouseDown={(event) => startRightDrag(event, index)}\n                    onMouseEnter={() => moveRightDragTo(index)}\n                    onMouseUp={() => stopRightDrag()}\n                    style={{\n                      position: \"relative\",\n                      borderRadius: \"10px\",\n                      overflow: \"hidden\",\n                      background: \"#0b1220\",\n                      border: rightDragIndex === index\n                        ? \"1px solid rgba(34,197,94,0.75)\"\n                        : \"1px solid rgba(148,163,184,0.2)\",\n                      aspectRatio: \"1 / 1\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      boxShadow: rightDragIndex === index\n                        ? \"0 0 0 2px rgba(34,197,94,0.25)\"\n                        : \"none\",\n                      cursor: rightDragActive ? \"grabbing\" : \"default\",\n                      userSelect: \"none\"\n                    }}\n                  >\n                    <img\n                      src={preview.url}\n                      alt={`preview-${index + 1}`}\n                      draggable={false}\n                      style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\", pointerEvents: \"none\" }}\n                    />\n                    <div style={{\n                      position: \"absolute\",\n                      left: \"6px\",\n                      bottom: \"6px\",\n                      minWidth: \"22px\",\n                      height: \"22px\",\n                      padding: \"0 6px\",\n                      borderRadius: \"999px\",\n                      display: \"inline-flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      fontSize: \"11px\",\n                      fontWeight: 700,\n                      color: \"#e2e8f0\",\n                      background: \"rgba(2,6,23,0.7)\",\n                      border: \"1px solid rgba(148,163,184,0.25)\"\n                    }}>\n                      {index + 1}\n                    </div>\n                    <button\n                      type=\"button\"\n                      onClick={(event) => {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        removeAdImage(index);\n                      }}\n                      style={{\n                        position: \"absolute\",\n                        top: \"6px\",\n                        right: \"6px\",\n                        width: \"24px\",\n                        height: \"24px\",\n                        borderRadius: \"999px\",\n                        border: \"1px solid rgba(239,68,68,0.4)\",\n                        background: \"rgba(127,29,29,0.85)\",\n                        color: \"#fecaca\",\n                        fontSize: \"14px\",\n                        lineHeight: 1,\n                        cursor: \"pointer\",\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        justifyContent: \"center\"\n                      }}\n                      title=\"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾\"\n                    >\n                      Ã—\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          <div style={{ marginTop: \"28px\", display: \"flex\", gap: \"12px\", justifyContent: \"flex-end\" }}>\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"secondary-button\"\n              style={{\n                padding: \"12px 24px\",\n                border: \"none\",\n                cursor: \"pointer\",\n                borderRadius: \"14px\",\n                fontSize: \"14px\",\n                fontWeight: \"600\"\n              }}\n            >\n              ÐžÑ‚Ð¼ÐµÐ½Ð°\n            </button>\n            <button\n              type=\"button\"\n              onClick={onSubmit}\n              className=\"primary-button\"\n              disabled={publishing}\n              style={{\n                padding: \"12px 28px\",\n                color: \"white\",\n                border: \"none\",\n                cursor: publishing ? \"not-allowed\" : \"pointer\",\n                opacity: publishing ? 0.7 : 1,\n                borderRadius: \"14px\",\n                fontSize: \"14px\",\n                fontWeight: \"600\",\n                display: \"flex\",\n                alignItems: \"center\",\n                gap: \"8px\"\n              }}\n            >\n              {publishing ? \"ÐŸÑƒÐ±Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ...\" : \"ðŸ“¤ Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ðµ\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AdModal;\n"],"mappings":"0IAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CAC1D,OAASC,YAAY,KAAQ,QAAQ,CACrC,OAASC,KAAK,CAAEC,gBAAgB,CAAEC,WAAW,CAAEC,WAAW,KAAQ,SAAS,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5E,KAAM,CAAAC,OAAO,CAAGC,IAAA,EAmBV,IAnBW,CACfC,MAAM,CACNC,OAAO,CACPC,QAAQ,CACRC,UAAU,CACVC,QAAQ,CACRC,UAAU,CACVC,mBAAmB,CACnBC,iBAAiB,CACjBC,WAAW,CACXC,gBAAgB,CAChBC,mBAAmB,CACnBC,kBAAkB,CAClBC,gBAAgB,CAChBC,KAAK,CACLC,QAAQ,CACRC,QAAQ,CACRC,WAAW,CACXC,mBACF,CAAC,CAAAlB,IAAA,CACC,GAAI,CAACC,MAAM,CAAE,MAAO,KAAI,CAExB,KAAM,CAACkB,YAAY,CAAEC,eAAe,CAAC,CAAG/B,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACgC,eAAe,CAAEC,kBAAkB,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CAC1D,KAAM,CAACkC,cAAc,CAAEC,iBAAiB,CAAC,CAAGnC,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAACoC,aAAa,CAAEC,gBAAgB,CAAC,CAAGrC,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAACsC,eAAe,CAAEC,kBAAkB,CAAC,CAAGvC,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACwC,cAAc,CAAEC,iBAAiB,CAAC,CAAGzC,QAAQ,CAAC,IAAI,CAAC,CAC1D,KAAM,CAAC0C,UAAU,CAAEC,aAAa,CAAC,CAAG3C,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC4C,qBAAqB,CAAEC,wBAAwB,CAAC,CAAG7C,QAAQ,CAAC,EAAE,CAAC,CACtE,KAAM,CAAA8C,eAAe,CAAG/C,MAAM,CAAC,IAAI,CAAC,CACpC,KAAM,CAAAgD,aAAa,CAAGhD,MAAM,CAAC,IAAI,CAAC,CAClC,KAAM,CAAAiD,kBAAkB,CAAGjD,MAAM,CAAC,GAAI,CAAAkD,GAAG,CAAC,CAAC,CAAC,CAC5C,KAAM,CAAAC,eAAe,CAAGnD,MAAM,CAAC,EAAE,CAAC,CAClC,KAAM,CAAAoD,mBAAmB,CAAGpD,MAAM,CAAC,KAAK,CAAC,CACzC,KAAM,CAAAqD,oBAAoB,CAAGrD,MAAM,CAAC,GAAI,CAAAsD,GAAG,CAAC,CAAC,CAAC,CAC9C,KAAM,CAAAC,gBAAgB,CAAGvD,MAAM,CAAC,CAAC,CAAC,CAClC,KAAM,CAAAwD,YAAY,CAAGxD,MAAM,CAAC,CAAEyD,MAAM,CAAE,KAAK,CAAEC,KAAK,CAAE,CAAC,CAAE,CAAC,CAAC,CAEzD,KAAM,CAAAC,UAAU,CAAG,CACjBC,KAAK,CAAE,MAAM,CACbC,OAAO,CAAE,WAAW,CACpBC,MAAM,CAAE,iCAAiC,CACzCC,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,oBAAoB,CAChCC,QAAQ,CAAE,MAAM,CAChBC,KAAK,CAAE,SAAS,CAChBC,UAAU,CAAE,eAAe,CAC3BC,OAAO,CAAE,MACX,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,CACjBC,OAAO,CAAE,OAAO,CAChBC,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,KAAK,CACjBN,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MACZ,CAAC,CACD,KAAM,CAAAQ,sBAAsB,CAAG,CAC7BC,YAAY,CAAE,qCAAqC,CACnDC,aAAa,CAAE,KACjB,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAIC,OAAO,EAAK,CACtC,KAAM,CAAAC,IAAI,CAAGD,OAAO,CAACE,WAAW,EAAIF,OAAO,CAACG,QAAQ,EAAI,SAAS,CACjE,KAAM,CAAAC,KAAK,CAAGJ,OAAO,CAACK,YAAY,EAAI,EAAE,CACxC,MAAO,CAAAD,KAAK,IAAAE,MAAA,CAAML,IAAI,OAAAK,MAAA,CAAKF,KAAK,MAAMH,IAAI,CAC5C,CAAC,CAED,KAAM,CAAAM,gBAAgB,CAAIC,QAAQ,EAAK,CACrC,GAAI,CAACA,QAAQ,CAAE,MAAO,EAAE,CACxB,KAAM,CAAAC,GAAG,CACPD,QAAQ,CAACP,IAAI,EACbO,QAAQ,CAACE,KAAK,EACdF,QAAQ,CAACG,KAAK,EACdH,QAAQ,CAACI,YAAY,EACrBJ,QAAQ,CAACK,WAAW,CACtB,KAAM,CAAAC,IAAI,CAAGC,MAAM,CAACN,GAAG,EAAI,EAAE,CAAC,CAACO,IAAI,CAAC,CAAC,CACrC,GAAIF,IAAI,CAAE,MAAO,CAAAA,IAAI,CACrB,KAAM,CAAAG,QAAQ,CAAGT,QAAQ,CAACU,EAAE,EAAIV,QAAQ,CAACW,GAAG,EAAI,EAAE,CAClD,MAAO,CAAAJ,MAAM,CAACE,QAAQ,CAAC,CACzB,CAAC,CAED,KAAM,CAAAG,mBAAmB,CAAIC,KAAK,EAAK,OAAO,CAACC,IAAI,CAACP,MAAM,CAACM,KAAK,EAAI,EAAE,CAAC,CAAC,CAExE,KAAM,CAAAE,oBAAoB,CAAIF,KAAK,EAAK,iBAAiB,CAACC,IAAI,CAACP,MAAM,CAACM,KAAK,EAAI,EAAE,CAAC,CAAC,CAEnF,KAAM,CAAAG,qBAAqB,CAAGA,CAACC,IAAI,CAAEC,MAAM,GAAK,CAC9C,GAAI,CAACD,IAAI,EAAI,CAACC,MAAM,CAAE,MAAO,MAAK,CAClC,KAAM,CAAAC,QAAQ,CAAGD,MAAM,CAACR,EAAE,GAAKU,SAAS,EAAIF,MAAM,CAACR,EAAE,GAAK,IAAI,CAAGH,MAAM,CAACW,MAAM,CAACR,EAAE,CAAC,CAAG,EAAE,CACvF,GAAI,CAACE,mBAAmB,CAACO,QAAQ,CAAC,CAAE,MAAO,MAAK,CAChD,KAAM,CAAAE,OAAO,CAAGJ,IAAI,CAACP,EAAE,GAAKU,SAAS,EAAIH,IAAI,CAACP,EAAE,GAAK,IAAI,CAAGH,MAAM,CAACU,IAAI,CAACP,EAAE,CAAC,CAAG,EAAE,CAChF,KAAM,CAAAY,QAAQ,CAAGL,IAAI,CAACN,GAAG,CAAGJ,MAAM,CAACU,IAAI,CAACN,GAAG,CAAC,CAAG,EAAE,CACjD,KAAM,CAAAY,SAAS,CAAGhB,MAAM,CAACU,IAAI,CAACxB,IAAI,EAAIwB,IAAI,CAACf,KAAK,EAAI,EAAE,CAAC,CAACM,IAAI,CAAC,CAAC,CAACgB,WAAW,CAAC,CAAC,CAC5E,KAAM,CAAAC,YAAY,CAAGJ,OAAO,CAACb,IAAI,CAAC,CAAC,CAACgB,WAAW,CAAC,CAAC,CACjD,GAAIZ,mBAAmB,CAACa,YAAY,CAAC,CAAE,MAAO,MAAK,CACnD,GAAIV,oBAAoB,CAACO,QAAQ,CAAC,CAAE,MAAO,MAAK,CAChD,GAAII,KAAK,CAACC,OAAO,CAACV,IAAI,CAACW,QAAQ,CAAC,EAAIX,IAAI,CAACW,QAAQ,CAACC,MAAM,CAAG,CAAC,CAAE,MAAO,MAAK,CAC1E,GAAI,CAACJ,YAAY,EAAI,CAACF,SAAS,CAAE,MAAO,MAAK,CAC7C;AACA;AACA,KAAM,CAAAO,gBAAgB,CAAG,GAAI,CAAA7D,GAAG,CAAC,CAAC,IAAI,CAAE,MAAM,CAAE,KAAK,CAAE,IAAI,CAAE,KAAK,CAAE,MAAM,CAAE,OAAO,CAAC,CAAC,CACrF,MAAO,CAAA6D,gBAAgB,CAACC,GAAG,CAACN,YAAY,CAAC,EAAIK,gBAAgB,CAACC,GAAG,CAACR,SAAS,CAAC,CAC9E,CAAC,CAED,KAAM,CAAAS,sBAAsB,CAAGA,CAACC,KAAK,CAAEf,MAAM,GAC3C,CAACQ,KAAK,CAACC,OAAO,CAACM,KAAK,CAAC,CAAGA,KAAK,CAAG,EAAE,EAAEC,MAAM,CAAEjB,IAAI,EAAK,CAACD,qBAAqB,CAACC,IAAI,CAAEC,MAAM,CAAC,CAAC,CAE5F,KAAM,CAAAiB,gBAAgB,CAAInC,QAAQ,EAAK,CACrC,GAAI,CAACA,QAAQ,CAAE,MAAO,EAAE,CACxB,KAAM,CAAAU,EAAE,CAAGV,QAAQ,CAACU,EAAE,GAAKU,SAAS,EAAIpB,QAAQ,CAACU,EAAE,GAAK,IAAI,CAAGH,MAAM,CAACP,QAAQ,CAACU,EAAE,CAAC,CAAG,EAAE,CACvF,KAAM,CAAAC,GAAG,CAAGX,QAAQ,CAACW,GAAG,CAAGJ,MAAM,CAACP,QAAQ,CAACW,GAAG,CAAC,CAAG,EAAE,CACpD,GAAID,EAAE,EAAIE,mBAAmB,CAACF,EAAE,CAAC,CAAE,MAAO,CAAAA,EAAE,CAC5C,GAAIC,GAAG,CAAE,MAAO,CAAAA,GAAG,CACnB,MAAO,CAAAD,EAAE,CACX,CAAC,CAED,KAAM,CAAA0B,UAAU,CAAInB,IAAI,EAAK,CAC3B,GAAI,CAACA,IAAI,CAAE,MAAO,EAAE,CACpB,KAAM,CAAAJ,KAAK,CAAGsB,gBAAgB,CAAClB,IAAI,CAAC,CACpC,GAAIJ,KAAK,CAAE,eAAAf,MAAA,CAAgBe,KAAK,EAChC,GAAII,IAAI,CAACxB,IAAI,CAAE,cAAAK,MAAA,CAAeS,MAAM,CAACU,IAAI,CAACxB,IAAI,CAAC,EAC/C,MAAO,EAAE,CACX,CAAC,CAED,KAAM,CAAA4C,kBAAkB,CAAGA,CAACC,SAAS,CAAEC,SAAS,GAAK,CACnD,GAAI,CAACb,KAAK,CAACC,OAAO,CAACY,SAAS,CAAC,EAAI,CAACA,SAAS,CAACV,MAAM,CAAE,CAClD,MAAO,CAAAH,KAAK,CAACC,OAAO,CAACW,SAAS,CAAC,CAAGA,SAAS,CAAG,EAAE,CAClD,CACA,KAAM,CAAAE,IAAI,CAAGd,KAAK,CAACC,OAAO,CAACW,SAAS,CAAC,CAAGA,SAAS,CAAG,EAAE,CACtD,KAAM,CAAAG,OAAO,CAAG,GAAI,CAAA5E,GAAG,CAAC,CAAC,CACzB,IAAK,KAAM,CAAAoD,IAAI,GAAI,CAAAuB,IAAI,CAAE,CACvB,KAAM,CAAAE,GAAG,CAAGN,UAAU,CAACnB,IAAI,CAAC,CAC5B,GAAIyB,GAAG,CAAED,OAAO,CAACE,GAAG,CAACD,GAAG,CAAEzB,IAAI,CAAC,CACjC,CACA,KAAM,CAAA2B,IAAI,CAAG,GAAI,CAAA3E,GAAG,CAAC,CAAC,CACtB,KAAM,CAAA4E,MAAM,CAAGN,SAAS,CAACO,GAAG,CAAE7B,IAAI,EAAK,CACrC,KAAM,CAAAyB,GAAG,CAAGN,UAAU,CAACnB,IAAI,CAAC,CAC5B,GAAIyB,GAAG,CAAEE,IAAI,CAACG,GAAG,CAACL,GAAG,CAAC,CACtB,KAAM,CAAAM,QAAQ,CAAGN,GAAG,CAAGD,OAAO,CAACQ,GAAG,CAACP,GAAG,CAAC,CAAG,IAAI,CAC9C,KAAM,CAAAQ,YAAY,CAAGxB,KAAK,CAACC,OAAO,CAACV,IAAI,CAACW,QAAQ,CAAC,CAAGX,IAAI,CAACW,QAAQ,CAAG,EAAE,CACtE,KAAM,CAAAuB,YAAY,CAAG,CAAAH,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEpB,QAAQ,GAAI,EAAE,CAC7C,KAAM,CAAAwB,cAAc,CAAGF,YAAY,CAACrB,MAAM,CACtCQ,kBAAkB,CAACc,YAAY,CAAED,YAAY,CAAC,CAC9CC,YAAY,CAChB,OAAAE,aAAA,CAAAA,aAAA,CAAAA,aAAA,IACML,QAAQ,EAAI,CAAC,CAAC,EACf/B,IAAI,MACPW,QAAQ,CAAEwB,cAAc,GAE5B,CAAC,CAAC,CACF,IAAK,KAAM,CAACV,GAAG,CAAEzB,IAAI,CAAC,EAAI,CAAAwB,OAAO,CAACa,OAAO,CAAC,CAAC,CAAE,CAC3C,GAAI,CAACV,IAAI,CAACb,GAAG,CAACW,GAAG,CAAC,CAAEG,MAAM,CAACU,IAAI,CAACtC,IAAI,CAAC,CACvC,CACA,MAAO,CAAA4B,MAAM,CACf,CAAC,CAED,KAAM,CAAAW,eAAe,CAAG,QAAAA,CAACvB,KAAK,CAAEwB,WAAW,CAAgB,IAAd,CAAAC,IAAI,CAAAC,SAAA,CAAA9B,MAAA,IAAA8B,SAAA,MAAAvC,SAAA,CAAAuC,SAAA,IAAG,EAAE,CACpD,GAAI,CAACF,WAAW,EAAI,CAAC/B,KAAK,CAACC,OAAO,CAACM,KAAK,CAAC,CAAE,MAAO,EAAE,CACpD,KAAM,CAAA2B,MAAM,CAAGrD,MAAM,CAACkD,WAAW,CAAC,CAClC,IAAK,KAAM,CAAAxC,IAAI,GAAI,CAAAgB,KAAK,CAAE,KAAA4B,cAAA,CACxB,KAAM,CAAAC,OAAO,CACV7C,IAAI,CAACP,EAAE,GAAKU,SAAS,EAAIH,IAAI,CAACP,EAAE,GAAK,IAAI,EAAIH,MAAM,CAACU,IAAI,CAACP,EAAE,CAAC,GAAKkD,MAAM,EACvE3C,IAAI,CAACN,GAAG,EAAIJ,MAAM,CAACU,IAAI,CAACN,GAAG,CAAC,GAAKiD,MAAO,CAC3C,KAAM,CAAAG,SAAS,CAAG5B,gBAAgB,CAAClB,IAAI,CAAC,CACxC,KAAM,CAAA+C,QAAQ,CAAGD,SAAS,CAAG,CAAC,GAAGL,IAAI,CAAEK,SAAS,CAAC,CAAGL,IAAI,CACxD,GAAII,OAAO,CAAE,MAAO,CAAAE,QAAQ,CAC5B,IAAAH,cAAA,CAAI5C,IAAI,CAACW,QAAQ,UAAAiC,cAAA,WAAbA,cAAA,CAAehC,MAAM,CAAE,CACzB,KAAM,CAAAoC,SAAS,CAAGT,eAAe,CAACvC,IAAI,CAACW,QAAQ,CAAE6B,WAAW,CAAEO,QAAQ,CAAC,CACvE,GAAIC,SAAS,CAACpC,MAAM,CAAE,MAAO,CAAAoC,SAAS,CACxC,CACF,CACA,MAAO,EAAE,CACX,CAAC,CAED,KAAM,CAAAC,QAAQ,CAAGA,CAACjC,KAAK,CAAEpB,KAAK,GAAK,CACjC,GAAI,CAACA,KAAK,CAAE,MAAO,KAAI,CACvB,IAAK,KAAM,CAAAI,IAAI,GAAI,CAAAgB,KAAK,CAAE,KAAAkC,eAAA,CACxB,GAAI5D,MAAM,CAACU,IAAI,CAACP,EAAE,CAAC,GAAKH,MAAM,CAACM,KAAK,CAAC,EAAIN,MAAM,CAACU,IAAI,CAACN,GAAG,CAAC,GAAKJ,MAAM,CAACM,KAAK,CAAC,CAAE,MAAO,CAAAI,IAAI,CACxF,IAAAkD,eAAA,CAAIlD,IAAI,CAACW,QAAQ,UAAAuC,eAAA,WAAbA,eAAA,CAAetC,MAAM,CAAE,CACzB,KAAM,CAAAuC,KAAK,CAAGF,QAAQ,CAACjD,IAAI,CAACW,QAAQ,CAAEf,KAAK,CAAC,CAC5C,GAAIuD,KAAK,CAAE,MAAO,CAAAA,KAAK,CACzB,CACF,CACA,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAIX,IAAI,EAAK,CACrC,KAAM,CAAAY,UAAU,CAAG,EAAE,CACrB,GAAI,CAAAC,OAAO,CAAG3H,eAAe,CAC7B,IAAK,KAAM,CAAA4H,QAAQ,GAAI,CAAAd,IAAI,CAAE,CAC3B,KAAM,CAAAU,KAAK,CAAGG,OAAO,CAACE,IAAI,CAAEC,GAAG,EAC5BA,GAAG,CAAChE,EAAE,EAAIH,MAAM,CAACmE,GAAG,CAAChE,EAAE,CAAC,GAAKH,MAAM,CAACiE,QAAQ,CAAC,EAC7CE,GAAG,CAAC/D,GAAG,EAAIJ,MAAM,CAACmE,GAAG,CAAC/D,GAAG,CAAC,GAAKJ,MAAM,CAACiE,QAAQ,CACjD,CAAC,CACD,GAAI,CAACJ,KAAK,CAAE,MACZE,UAAU,CAACf,IAAI,CAACa,KAAK,CAAC,CACtBG,OAAO,CAAGvC,sBAAsB,CAACoC,KAAK,CAACxC,QAAQ,EAAI,EAAE,CAAEwC,KAAK,CAAC,CAC/D,CACA,MAAO,CAAAE,UAAU,CACnB,CAAC,CAED,KAAM,CAAAK,wBAAwB,CAAIjB,IAAI,EAAK,CACzC,KAAM,CAAAY,UAAU,CAAGD,oBAAoB,CAACX,IAAI,CAAC,CAC7C,KAAM,CAAAkB,YAAY,CAAGN,UAAU,CAACzC,MAAM,CAAGyC,UAAU,CAACA,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAC,CAAG,IAAI,CACjF,KAAM,CAAAgD,WAAW,CAAG,CAAC,GAAGP,UAAU,CAAC,CAACQ,OAAO,CAAC,CAAC,CAACL,IAAI,CAAExD,IAAI,EAAK,OAAO,CAACH,IAAI,CAACP,MAAM,CAAC,CAAAU,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEP,EAAE,GAAI,EAAE,CAAC,CAAC,CAAC,CAClG,MAAO,CACLkE,YAAY,CACZC,WAAW,CAAEA,WAAW,EAAID,YAC9B,CAAC,CACH,CAAC,CAEDlK,SAAS,CAAC,IAAM,CACdmC,kBAAkB,CAAE2F,IAAI,EAAKH,kBAAkB,CAACG,IAAI,CAAE3G,UAAU,EAAI,EAAE,CAAC,CAAC,CAC1E,CAAC,CAAE,CAACA,UAAU,CAAC,CAAC,CAEhBnB,SAAS,CAAC,IAAM,CACd,GAAIc,MAAM,CAAE,CACVmB,eAAe,CAAC,EAAE,CAAC,CACnBI,iBAAiB,CAAC,KAAK,CAAC,CACxBU,wBAAwB,CAAC,EAAE,CAAC,CAC5BnB,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IACTb,IAAI,MACPuC,UAAU,CAAE,EAAE,CACdC,WAAW,CAAE,EAAE,CACftI,YAAY,CAAE,EAAE,EAChB,CAAC,CACL,CACF,CAAC,CAAE,CAAClB,MAAM,CAAEc,QAAQ,CAAC,CAAC,CAEtB5B,SAAS,CAAC,IAAM,CACd,GAAI,CAAC6B,QAAQ,EAAIA,QAAQ,CAACsF,MAAM,GAAK,CAAC,CAAE,CACtC5E,gBAAgB,CAAC,EAAE,CAAC,CACpB,MAAO,CAAAmE,SAAS,CAClB,CAEA,KAAM,CAAA6D,QAAQ,CAAG1I,QAAQ,CAACuG,GAAG,CAAEoC,IAAI,GAAM,CACvCA,IAAI,CACJvE,GAAG,CAAEwE,GAAG,CAACC,eAAe,CAACF,IAAI,CAC/B,CAAC,CAAC,CAAC,CACHjI,gBAAgB,CAACgI,QAAQ,CAAC,CAE1B,MAAO,IAAM,CACXA,QAAQ,CAACI,OAAO,CAAEC,OAAO,EAAKH,GAAG,CAACI,eAAe,CAACD,OAAO,CAAC3E,GAAG,CAAC,CAAC,CACjE,CAAC,CACH,CAAC,CAAE,CAACpE,QAAQ,CAAC,CAAC,CAEd,KAAM,CAAAiJ,aAAa,CAAGA,CAAA,GAAM,CAC1B,GAAI,CAACrH,YAAY,CAACoG,OAAO,CAACnG,MAAM,CAAE,OAClCD,YAAY,CAACoG,OAAO,CAAG,CAAEnG,MAAM,CAAE,KAAK,CAAEC,KAAK,CAAE,CAAC,CAAE,CAAC,CACnDlB,kBAAkB,CAAC,KAAK,CAAC,CACzBE,iBAAiB,CAAC,IAAI,CAAC,CACzB,CAAC,CAED3C,SAAS,CAAC,IAAM,CACd,KAAM,CAAA+K,aAAa,CAAGA,CAAA,GAAMD,aAAa,CAAC,CAAC,CAC3C,KAAM,CAAAE,gBAAgB,CAAGA,CAAA,GAAMF,aAAa,CAAC,CAAC,CAC9CG,MAAM,CAACC,gBAAgB,CAAC,SAAS,CAAEH,aAAa,CAAC,CACjDE,MAAM,CAACC,gBAAgB,CAAC,MAAM,CAAEF,gBAAgB,CAAC,CACjD,MAAO,IAAM,CACXC,MAAM,CAACE,mBAAmB,CAAC,SAAS,CAAEJ,aAAa,CAAC,CACpDE,MAAM,CAACE,mBAAmB,CAAC,MAAM,CAAEH,gBAAgB,CAAC,CACtD,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAI,sBAAsB,CAAIC,KAAK,EAAK,KAAAC,aAAA,CACxC,KAAM,CAAAC,QAAQ,CAAGvE,KAAK,CAACwE,IAAI,CAAC,CAAAH,KAAK,SAALA,KAAK,kBAAAC,aAAA,CAALD,KAAK,CAAEnC,MAAM,UAAAoC,aAAA,iBAAbA,aAAA,CAAeG,KAAK,GAAI,EAAE,CAAC,CAACjE,MAAM,CAAEgD,IAAI,EAClE3E,MAAM,CAAC,CAAA2E,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEkB,IAAI,GAAI,EAAE,CAAC,CAAC5E,WAAW,CAAC,CAAC,CAAC6E,UAAU,CAAC,QAAQ,CAC5D,CAAC,CACD,GAAIN,KAAK,SAALA,KAAK,WAALA,KAAK,CAAEnC,MAAM,CAAEmC,KAAK,CAACnC,MAAM,CAAC/C,KAAK,CAAG,EAAE,CAC1C,GAAI,CAACoF,QAAQ,CAACpE,MAAM,CAAE,OACtBrF,WAAW,CAACyJ,QAAQ,CAAC,CACvB,CAAC,CAED,KAAM,CAAAK,aAAa,CAAIC,aAAa,EAAK,CACvCf,aAAa,CAAC,CAAC,CACfhJ,WAAW,CAAEgG,IAAI,EAAK,CACpB,KAAM,CAAAgE,IAAI,CAAG9E,KAAK,CAACC,OAAO,CAACa,IAAI,CAAC,CAAGA,IAAI,CAAG,EAAE,CAC5C,MAAO,CAAAgE,IAAI,CAACtE,MAAM,CAAC,CAACuE,CAAC,CAAEC,GAAG,GAAKA,GAAG,GAAKH,aAAa,CAAC,CACvD,CAAC,CAAC,CACF,GAAI5I,aAAa,CAAC4G,OAAO,CAAE,CACzB5G,aAAa,CAAC4G,OAAO,CAAC1D,KAAK,CAAG,EAAE,CAClC,CACF,CAAC,CAED,KAAM,CAAA8F,cAAc,CAAGA,CAACZ,KAAK,CAAE1H,KAAK,GAAK,CACvC,GAAI0H,KAAK,CAACa,MAAM,GAAK,CAAC,CAAE,OACxBb,KAAK,CAACc,cAAc,CAAC,CAAC,CACtB1I,YAAY,CAACoG,OAAO,CAAG,CAAEnG,MAAM,CAAE,IAAI,CAAEC,KAAM,CAAC,CAC9ClB,kBAAkB,CAAC,IAAI,CAAC,CACxBE,iBAAiB,CAACgB,KAAK,CAAC,CAC1B,CAAC,CAED,KAAM,CAAAyI,eAAe,CAAIC,WAAW,EAAK,CACvC,KAAM,CAAAxC,OAAO,CAAGpG,YAAY,CAACoG,OAAO,CACpC,GAAI,CAACA,OAAO,CAACnG,MAAM,CAAE,OACrB,GAAI,CAAC4I,MAAM,CAACC,SAAS,CAACF,WAAW,CAAC,CAAE,OACpC,GAAIxC,OAAO,CAAClG,KAAK,GAAK0I,WAAW,CAAE,OAEnCvK,WAAW,CAAEgG,IAAI,EAAK,CACpB,KAAM,CAAAgE,IAAI,CAAG9E,KAAK,CAACC,OAAO,CAACa,IAAI,CAAC,CAAG,CAAC,GAAGA,IAAI,CAAC,CAAG,EAAE,CACjD,GACE+B,OAAO,CAAClG,KAAK,CAAG,CAAC,EACjBkG,OAAO,CAAClG,KAAK,EAAImI,IAAI,CAAC3E,MAAM,EAC5BkF,WAAW,CAAG,CAAC,EACfA,WAAW,EAAIP,IAAI,CAAC3E,MAAM,CAC1B,CACA,MAAO,CAAAW,IAAI,CACb,CACA,KAAM,CAAC0E,KAAK,CAAC,CAAGV,IAAI,CAACW,MAAM,CAAC5C,OAAO,CAAClG,KAAK,CAAE,CAAC,CAAC,CAC7CmI,IAAI,CAACW,MAAM,CAACJ,WAAW,CAAE,CAAC,CAAEG,KAAK,CAAC,CAClC,MAAO,CAAAV,IAAI,CACb,CAAC,CAAC,CAEFrI,YAAY,CAACoG,OAAO,CAAG,CAAEnG,MAAM,CAAE,IAAI,CAAEC,KAAK,CAAE0I,WAAY,CAAC,CAC3D1J,iBAAiB,CAAC0J,WAAW,CAAC,CAChC,CAAC,CAEDrM,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACbc,QAAQ,CAAEkG,IAAI,EAAK,CACjB,KAAM,CAAA4E,WAAW,CAAG1F,KAAK,CAACC,OAAO,CAACa,IAAI,CAAC9F,YAAY,CAAC,CAAG8F,IAAI,CAAC9F,YAAY,CAAG,EAAE,CAC7E,KAAM,CAAAsH,QAAQ,CAAGtH,YAAY,CAC7B,GAAI0K,WAAW,CAACvF,MAAM,GAAKmC,QAAQ,CAACnC,MAAM,EAAIuF,WAAW,CAACC,KAAK,CAAC,CAACC,IAAI,CAAEZ,GAAG,GAAKnG,MAAM,CAAC+G,IAAI,CAAC,GAAK/G,MAAM,CAACyD,QAAQ,CAAC0C,GAAG,CAAC,CAAC,CAAC,CAAE,CACtH,MAAO,CAAAlE,IAAI,CACb,CACA,OAAAa,aAAA,CAAAA,aAAA,IAAYb,IAAI,MAAE9F,YAAY,CAAE,CAAC,GAAGsH,QAAQ,CAAC,GAC/C,CAAC,CAAC,CACJ,CAAC,CAAE,CAACxI,MAAM,CAAEkB,YAAY,CAAEJ,QAAQ,CAAC,CAAC,CAEpC5B,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACb,GAAIkB,YAAY,CAACmF,MAAM,CAAE,OACzB,GAAI/E,cAAc,CAAE,OACpB,KAAM,CAAA8G,MAAM,CAAG,CAAAvH,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAE0I,UAAU,IAAI1I,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAE2I,WAAW,EACtD,GAAI,CAACpB,MAAM,CAAE,OACb,KAAM,CAAA2D,YAAY,CAAG/D,eAAe,CAAC5G,eAAe,CAAEgH,MAAM,CAAC,CAC7D,GAAI2D,YAAY,CAAC1F,MAAM,CAAE,CACvBlF,eAAe,CAAC4K,YAAY,CAAC,CAC7BxK,iBAAiB,CAAC,IAAI,CAAC,CACzB,CACF,CAAC,CAAE,CAACvB,MAAM,CAAEkB,YAAY,CAACmF,MAAM,CAAE/E,cAAc,CAAET,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAE0I,UAAU,CAAE1I,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAE2I,WAAW,CAAEpI,eAAe,CAAC,CAAC,CAEzGlC,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACb,GAAI,CAACa,KAAK,CAACmL,SAAS,CAAE,OACtB,GAAI,CAAC9K,YAAY,CAACmF,MAAM,CAAE,OAC1B,KAAM,CAAA4F,MAAM,CAAG/K,YAAY,CAACA,YAAY,CAACmF,MAAM,CAAG,CAAC,CAAC,CACpD,KAAM,CAAAZ,IAAI,CAAGiD,QAAQ,CAACtH,eAAe,CAAE6K,MAAM,CAAC,CAC9C,GAAIxG,IAAI,GAAK,CAACA,IAAI,CAACW,QAAQ,EAAIX,IAAI,CAACW,QAAQ,CAACC,MAAM,GAAK,CAAC,CAAC,CAAE,CAC1D6F,eAAe,CAACzG,IAAI,CAAC,CACvB,CACF,CAAC,CAAE,CAACzF,MAAM,CAAEa,KAAK,CAACmL,SAAS,CAAE9K,YAAY,CAAEE,eAAe,CAAC,CAAC,CAE5DlC,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACb,GAAI,CAACkB,YAAY,CAACmF,MAAM,CAAE,CACxB8F,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC5C,OACF,CACA,KAAM,CAAArD,OAAO,CAAGsD,oBAAoB,CAAC,CAAC,CACtCF,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAElL,YAAY,CAACoL,IAAI,CAAC,KAAK,CAAC,CAAE,eAAe,CAAEvD,OAAO,CAAC1C,MAAM,CAAC,CACnG,CAAC,CAAE,CAACrG,MAAM,CAAEkB,YAAY,CAAEE,eAAe,CAAC,CAAC,CAE3ClC,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACb,GAAI,CAACkC,eAAe,CAAC6G,OAAO,CAAE,OAC9B7G,eAAe,CAAC6G,OAAO,CAACwD,SAAS,CAAG,CAAC,CACvC,CAAC,CAAE,CAACvM,MAAM,CAAEkB,YAAY,CAAC,CAAC,CAE1B,KAAM,CAAAmL,oBAAoB,CAAGA,CAAA,GAAM,CACjC,GAAInL,YAAY,CAACmF,MAAM,GAAK,CAAC,CAAE,MAAO,CAAAjF,eAAe,CAErD,GAAI,CAAA2H,OAAO,CAAG3H,eAAe,CAC7B,GAAI,CAAAsE,MAAM,CAAG,IAAI,CACjB,IAAK,KAAM,CAAAsD,QAAQ,GAAI,CAAA9H,YAAY,CAAE,CACnC,KAAM,CAAA0H,KAAK,CAAGG,OAAO,CAACE,IAAI,CAAEC,GAAG,EAC5BA,GAAG,CAAChE,EAAE,EAAIH,MAAM,CAACmE,GAAG,CAAChE,EAAE,CAAC,GAAKH,MAAM,CAACiE,QAAQ,CAAC,EAC7CE,GAAG,CAAC/D,GAAG,EAAIJ,MAAM,CAACmE,GAAG,CAAC/D,GAAG,CAAC,GAAKJ,MAAM,CAACiE,QAAQ,CACjD,CAAC,CACD,GAAI,CAACJ,KAAK,CAAE,CACV,KAAM,CAAA3D,QAAQ,CAAGyD,QAAQ,CAACtH,eAAe,CAAE4H,QAAQ,CAAC,CACpD,MAAO,CAAAxC,sBAAsB,CAAC,CAAAvB,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEmB,QAAQ,GAAI,EAAE,CAAEnB,QAAQ,CAAC,CACnE,CACAS,MAAM,CAAGkD,KAAK,CACdG,OAAO,CAAGvC,sBAAsB,CAACoC,KAAK,CAACxC,QAAQ,EAAI,EAAE,CAAEwC,KAAK,CAAC,CAC/D,CACA,MAAO,CAAAG,OAAO,CAChB,CAAC,CAED,KAAM,CAAAyD,mBAAmB,CAAGA,CAAA,GAAM,CAChC,GAAItL,YAAY,CAACmF,MAAM,GAAK,CAAC,CAAE,MAAO,KAAI,CAC1C,KAAM,CAAA4F,MAAM,CAAG/K,YAAY,CAACA,YAAY,CAACmF,MAAM,CAAG,CAAC,CAAC,CACpD,MAAO,CAAAqC,QAAQ,CAACtH,eAAe,CAAE6K,MAAM,CAAC,CAC1C,CAAC,CAED,KAAM,CAAAQ,uBAAuB,CAAG,KAAO,CAAAjI,QAAQ,EAAK,CAClD,GAAI,CAAC3D,KAAK,CAACmL,SAAS,CAAE,CACpBU,KAAK,CAAC,0BAA0B,CAAC,CACjC,OACF,CACAnL,iBAAiB,CAAC,IAAI,CAAC,CACvB,KAAM,CAAAoL,UAAU,CAAGH,mBAAmB,CAAC,CAAC,CACxC,GAAIhH,qBAAqB,CAAChB,QAAQ,CAAEmI,UAAU,CAAC,CAAE,CAC/CR,OAAO,CAACS,IAAI,CAAC,0CAA0C,CAAE,CAAApI,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEP,IAAI,IAAIO,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAEU,EAAE,EAAC,CACxF,OACF,CACA,KAAM,CAAAG,KAAK,CAAGsB,gBAAgB,CAACnC,QAAQ,CAAC,CACxC,GAAI,CAACa,KAAK,CAAE,OACZ,KAAM,CAAAwH,eAAe,CAAG9H,MAAM,CAACM,KAAK,CAAC,CAErC;AACA,KAAM,CAAAyH,WAAW,CAAG5L,YAAY,CAAC6L,SAAS,CAAE7H,EAAE,EAAKH,MAAM,CAACG,EAAE,CAAC,GAAK2H,eAAe,CAAC,CAClF,GAAIC,WAAW,GAAK,CAAC,CAAC,CAAE,CACtB,KAAM,CAAAtE,QAAQ,CAAGtH,YAAY,CAAC8L,KAAK,CAAC,CAAC,CAAEF,WAAW,CAAG,CAAC,CAAC,CACvD3L,eAAe,CAACqH,QAAQ,CAAC,CAEzB;AACA,KAAM,CAAEY,YAAY,CAAEC,WAAY,CAAC,CAAGF,wBAAwB,CAACX,QAAQ,CAAC,CACxE1H,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IACTb,IAAI,MACPuC,UAAU,CAAEF,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEnE,EAAE,CAAGH,MAAM,CAACsE,WAAW,CAACnE,EAAE,CAAC,CAAG,EAAE,CACzDsE,WAAW,CAAE,CAAAJ,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEjE,GAAG,IAAIkE,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAElE,GAAG,GAAI,EAAE,CACxD8H,WAAW,CAAEzE,QAAQ,CAAC8D,IAAI,CAAC,GAAG,CAAC,CAC/BpL,YAAY,CAAE,CAAC,GAAGsH,QAAQ,CAAC,EAC3B,CAAC,CACH,OACF,CAEA;AACA,KAAM,CAAA0E,OAAO,CAAG,CAAC,GAAGhM,YAAY,CAAE2L,eAAe,CAAC,CAClD1L,eAAe,CAAC+L,OAAO,CAAC,CACxBjL,wBAAwB,CAAC,EAAE,CAAC,CAE5B;AACA;AACA,KAAM,CAAAkL,cAAc,CAAG,KAAM,CAAAjB,eAAe,CAAC1H,QAAQ,CAAC,CAEtD;AACA,KAAM,CAAE4E,YAAY,CAAEC,WAAY,CAAC,CAAGF,wBAAwB,CAAC+D,OAAO,CAAC,CACvE,KAAM,CAAAE,aAAa,CAAGlH,KAAK,CAACC,OAAO,CAAC3B,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,CAAE4B,QAAQ,CAAC,CAAG5B,QAAQ,CAAC4B,QAAQ,CAAG,EAAE,CAChF,KAAM,CAAAiH,gBAAgB,CAAGnH,KAAK,CAACC,OAAO,CAACiD,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEhD,QAAQ,CAAC,CAAGgD,YAAY,CAAChD,QAAQ,CAAG,EAAE,CAC3F,KAAM,CAAAkH,eAAe,CAAGpH,KAAK,CAACC,OAAO,CAACgH,cAAc,CAAC,CAAGA,cAAc,CAAG,IAAI,CAC7E,KAAM,CAAAI,kBAAkB,CAAGD,eAAe,CACtC9G,sBAAsB,CAAC8G,eAAe,CAAE9I,QAAQ,CAAC,CAAC6B,MAAM,CAAG,CAAC,CAC5D,IAAI,CACR,KAAM,CAAAmH,gBAAgB,CACpBhH,sBAAsB,CAAC4G,aAAa,CAAE5I,QAAQ,CAAC,CAAC6B,MAAM,CAAG,CAAC,EAC1DG,sBAAsB,CAAC6G,gBAAgB,CAAEjE,YAAY,CAAC,CAAC/C,MAAM,CAAG,CAAC,CACnE,KAAM,CAAAoH,kBAAkB,CAAGN,cAAc,GAAK,IAAI,EAAI,CAACK,gBAAgB,CACvE,KAAM,CAAAE,MAAM,CAAGD,kBAAkB,CAC7B,KAAK,CACJF,kBAAkB,GAAK,IAAI,CAAG,CAACA,kBAAkB,CAAG,CAACC,gBAAiB,CAE3E1M,QAAQ,CAAEkG,IAAI,EAAK,CACjB,KAAM,CAAA2G,IAAI,CAAA9F,aAAA,IAAQb,IAAI,CAAE,CACxB,GAAI0G,MAAM,CAAE,CACVC,IAAI,CAACpE,UAAU,CAAGF,WAAW,SAAXA,WAAW,WAAXA,WAAW,CAAEnE,EAAE,CAAGH,MAAM,CAACsE,WAAW,CAACnE,EAAE,CAAC,CAAG,EAAE,CAC/DyI,IAAI,CAACnE,WAAW,CAAG,CAAAJ,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEjE,GAAG,IAAIkE,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAElE,GAAG,GAAI,EAAE,CAChE,CAAC,IAAM,CACLwI,IAAI,CAACpE,UAAU,CAAG,EAAE,CACpBoE,IAAI,CAACnE,WAAW,CAAG,EAAE,CACvB,CACAmE,IAAI,CAACV,WAAW,CAAGC,OAAO,CAACZ,IAAI,CAAC,GAAG,CAAC,CACpCqB,IAAI,CAACzM,YAAY,CAAG,CAAC,GAAGgM,OAAO,CAAC,CAEhC,GAAI,CAACS,IAAI,CAACpE,UAAU,EAAIoE,IAAI,CAACpE,UAAU,GAAKvC,IAAI,CAACuC,UAAU,CAAE,CAC3D,GAAI7I,mBAAmB,CAAE,CACvBA,mBAAmB,CAAC,CAAC,CAAC,CAAC,CACzB,CACF,CACA,MAAO,CAAAiN,IAAI,CACb,CAAC,CAAC,CACJ,CAAC,CAED,KAAM,CAAAC,kBAAkB,CAAGA,CAACnH,KAAK,CAAEwB,WAAW,CAAE7B,QAAQ,GACtDK,KAAK,CAACa,GAAG,CAAE7B,IAAI,EAAK,KAAAoI,eAAA,CAClB,KAAM,CAAAvF,OAAO,CAAGvD,MAAM,CAACU,IAAI,CAACP,EAAE,CAAC,GAAKH,MAAM,CAACkD,WAAW,CAAC,EAAIlD,MAAM,CAACU,IAAI,CAACN,GAAG,CAAC,GAAKJ,MAAM,CAACkD,WAAW,CAAC,CACnG,GAAIK,OAAO,CAAE,CACX,OAAAT,aAAA,CAAAA,aAAA,IAAYpC,IAAI,MAAEW,QAAQ,GAC5B,CACA,IAAAyH,eAAA,CAAIpI,IAAI,CAACW,QAAQ,UAAAyH,eAAA,WAAbA,eAAA,CAAexH,MAAM,CAAE,CACzB,OAAAwB,aAAA,CAAAA,aAAA,IAAYpC,IAAI,MAAEW,QAAQ,CAAEwH,kBAAkB,CAACnI,IAAI,CAACW,QAAQ,CAAE6B,WAAW,CAAE7B,QAAQ,CAAC,GACtF,CACA,MAAO,CAAAX,IAAI,CACb,CAAC,CAAC,CAEJ,KAAM,CAAAyG,eAAe,CAAG,KAAO,CAAAzG,IAAI,EAAK,CACtC,KAAM,CAAAqI,KAAK,CAAG,CAAArI,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEP,EAAE,IAAKU,SAAS,EAAI,CAAAH,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEP,EAAE,IAAK,IAAI,CAAGH,MAAM,CAACU,IAAI,CAACP,EAAE,CAAC,CAAG,EAAE,CAChF,KAAM,CAAA6I,MAAM,CAAGtI,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEN,GAAG,CAAGJ,MAAM,CAACU,IAAI,CAACN,GAAG,CAAC,CAAG,EAAE,CAChD,KAAM,CAAAU,OAAO,CAAGiI,KAAK,EAAI1I,mBAAmB,CAAC0I,KAAK,CAAC,CAAGA,KAAK,CAAG,EAAE,CAChE,KAAM,CAAAhI,QAAQ,CAAGD,OAAO,CAAG,EAAE,CAAIkI,MAAM,EAAI,EAAG,CAC9C,GAAI,CAAClI,OAAO,EAAI,CAACC,QAAQ,CAAE,OAC3B,KAAM,CAAAmC,WAAW,CAAGtB,gBAAgB,CAAClB,IAAI,CAAC,EAAII,OAAO,EAAIC,QAAQ,CACjE,GAAI,CAACmC,WAAW,CAAE,OAElB,KAAM,CAAA+F,OAAO,CAAG5L,kBAAkB,CAAC2G,OAAO,CAACtB,GAAG,CAACQ,WAAW,CAAC,CAC3D,GAAI+F,OAAO,CAAE,MAAO,CAAAA,OAAO,CAE3B,KAAM,CAAAC,IAAI,CAAG,CAAC,SAAY,CACxB,KAAM,CAAAC,MAAM,CAAG,GAAI,CAAAC,eAAe,CAAC,CAAC,CACpC,GAAItI,OAAO,CAAEqI,MAAM,CAAC/G,GAAG,CAAC,IAAI,CAAEtB,OAAO,CAAC,CAAC,IAClC,CAAAqI,MAAM,CAAC/G,GAAG,CAAC,KAAK,CAAErB,QAAQ,CAAC,CAChC,GAAIjF,KAAK,SAALA,KAAK,WAALA,KAAK,CAAEmL,SAAS,CAAEkC,MAAM,CAAC/G,GAAG,CAAC,WAAW,CAAEtG,KAAK,CAACmL,SAAS,CAAC,CAC9D,GAAI,KAAAoC,KAAA,CACF,GAAI,CAAAC,IAAI,CAAG,KAAM,CAAAhP,YAAY,6BAAAiF,MAAA,CAA6B4J,MAAM,CAACI,QAAQ,CAAC,CAAC,CAAE,CAAC,CAC9E,GAAI,CAAAC,WAAW,CAAGrI,KAAK,CAACC,OAAO,EAAAiI,KAAA,CAACC,IAAI,UAAAD,KAAA,iBAAJA,KAAA,CAAMhI,QAAQ,CAAC,CAAGiI,IAAI,CAACjI,QAAQ,CAAG,IAAI,CACtE,GAAIF,KAAK,CAACC,OAAO,CAACoI,WAAW,CAAC,EAAIA,WAAW,CAAClI,MAAM,GAAK,CAAC,CAAE,KAAAmI,MAAA,CAC1D,KAAM,CAAAC,aAAa,CAAG,GAAI,CAAAN,eAAe,CAACD,MAAM,CAACI,QAAQ,CAAC,CAAC,CAAC,CAC5DG,aAAa,CAACtH,GAAG,CAAC,SAAS,CAAE,MAAM,CAAC,CACpCkH,IAAI,CAAG,KAAM,CAAAhP,YAAY,6BAAAiF,MAAA,CAA6BmK,aAAa,CAACH,QAAQ,CAAC,CAAC,CAAE,CAAC,CACjFC,WAAW,CAAGrI,KAAK,CAACC,OAAO,EAAAqI,MAAA,CAACH,IAAI,UAAAG,MAAA,iBAAJA,MAAA,CAAMpI,QAAQ,CAAC,CAAGiI,IAAI,CAACjI,QAAQ,CAAGmI,WAAW,CAC3E,CACA,GAAI,CAACrI,KAAK,CAACC,OAAO,CAACoI,WAAW,CAAC,CAAE,MAAO,KAAI,CAC5C,KAAM,CAAAG,gBAAgB,CAAGlI,sBAAsB,CAAC+H,WAAW,CAAE9I,IAAI,CAAC,CAClE,KAAM,CAAAkJ,KAAK,CAAGzI,KAAK,CAACC,OAAO,CAACuI,gBAAgB,CAAC,CAAGA,gBAAgB,CAACrI,MAAM,CAAG,CAAC,CAC3E,KAAM,CAAAuI,MAAM,CAAG1I,KAAK,CAACC,OAAO,CAACuI,gBAAgB,CAAC,CAC1CA,gBAAgB,CAAC1B,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAAC1F,GAAG,CAAEwE,IAAI,EAAK,CAAAA,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE7H,IAAI,IAAI6H,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE5G,EAAE,IAAI4G,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE3G,GAAG,EAAC,CAC/E,EAAE,CACNgH,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAEuC,KAAK,CAAE,QAAQ,CAAE1G,WAAW,CAAE,QAAQ,CAAE2G,MAAM,CAAC,CAChGvN,kBAAkB,CAAE2F,IAAI,EAAK,KAAA6H,iBAAA,CAC3B,KAAM,CAAAlB,IAAI,CAAGC,kBAAkB,CAAC5G,IAAI,CAAEiB,WAAW,CAAEyG,gBAAgB,CAAC,CACpE,KAAM,CAAAI,OAAO,CAAGpG,QAAQ,CAACiF,IAAI,CAAE1F,WAAW,CAAC,CAC3CkE,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAE,CAAA0C,OAAO,SAAPA,OAAO,kBAAAD,iBAAA,CAAPC,OAAO,CAAE1I,QAAQ,UAAAyI,iBAAA,iBAAjBA,iBAAA,CAAmBxI,MAAM,GAAI,CAAC,CAAE,QAAQ,CAAE4B,WAAW,CAAC,CACtG,MAAO,CAAA0F,IAAI,CACb,CAAC,CAAC,CACF1L,wBAAwB,CAAC,EAAE,CAAC,CAC5B,MAAO,CAAAyM,gBAAgB,CACzB,CAAE,MAAOK,KAAK,CAAE,CACd,KAAM,CAAAC,OAAO,CAAG,CAAAD,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEC,OAAO,GAAI,aAAa,CAC/C7C,OAAO,CAAC4C,KAAK,CAAC,mCAAmC,CAAE,CACjD3G,MAAM,CAAEH,WAAW,CACnB+D,SAAS,CAAE,CAAAnL,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEmL,SAAS,GAAI,EAAE,CACjCgD,OACF,CAAC,CAAC,CACF/M,wBAAwB,6LAAAqC,MAAA,CAAuC0K,OAAO,CAAE,CAAC,CACzE,MAAO,KAAI,CACb,CACF,CAAC,EAAE,CAAC,CAEJ5M,kBAAkB,CAAC2G,OAAO,CAAC5B,GAAG,CAACc,WAAW,CAAEgG,IAAI,CAAC,CACjD,GAAI,CACF,MAAO,MAAM,CAAAA,IAAI,CACnB,CAAC,OAAS,CACR7L,kBAAkB,CAAC2G,OAAO,CAACkG,MAAM,CAAChH,WAAW,CAAC,CAChD,CACF,CAAC,CAED,KAAM,CAAAiH,sBAAsB,CAAG,KAAAA,CAAA,GAAY,CACzC,GAAI,EAACrO,KAAK,SAALA,KAAK,WAALA,KAAK,CAAEmL,SAAS,EAAE,CACrBU,KAAK,CAAC,0BAA0B,CAAC,CACjC,OACF,CACA3K,aAAa,CAAC,IAAI,CAAC,CACnB,GAAI,CACF,KAAM,CAAAsM,IAAI,CAAG,KAAM,CAAAhP,YAAY,kBAAAiF,MAAA,CAAkBzD,KAAK,CAACmL,SAAS,QAAM,CAAC,CACvE,GAAIqC,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEc,OAAO,EAAId,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEe,UAAU,CAAE,CACrCtO,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAEoI,UAAU,CAAEf,IAAI,CAACe,UAAU,EAAG,CAAC,CAChE,CAAC,IAAM,CACL1C,KAAK,CAAC,CAAA2B,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEU,KAAK,GAAI,kCAAkC,CAAC,CAC1D,CACF,CAAE,MAAOA,KAAK,CAAE,CACdrC,KAAK,CAAC,CAAAqC,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEC,OAAO,GAAI,kCAAkC,CAAC,CAC7D,CAAC,OAAS,CACRjN,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED7C,SAAS,CAAC,IAAM,CACd,GAAI,CAACc,MAAM,CAAE,OACb,GAAI,CAACa,KAAK,CAACmL,SAAS,CAAE,OACtB,GAAI9K,YAAY,CAACmF,MAAM,GAAK,CAAC,CAAE,OAC/B,KAAM,CAAAgJ,SAAS,CAAGtK,MAAM,CAAC7D,YAAY,CAAC,CAAC,CAAC,EAAI,EAAE,CAAC,CAC/C,GAAI,CAACmO,SAAS,CAAE,OAEhB,GAAI/M,eAAe,CAACyG,OAAO,GAAKsG,SAAS,CAAE,CACzC/M,eAAe,CAACyG,OAAO,CAAGsG,SAAS,CACnC7M,oBAAoB,CAACuG,OAAO,CAAG,GAAI,CAAAtG,GAAG,CAAC,CAAC,CACxCF,mBAAmB,CAACwG,OAAO,CAAG,KAAK,CACrC,CAEA,GAAIxG,mBAAmB,CAACwG,OAAO,CAAE,OACjC,KAAM,CAAAA,OAAO,CAAGsD,oBAAoB,CAAC,CAAC,CACtC,GAAI,CAACtD,OAAO,CAAC1C,MAAM,CAAE,OAErB,KAAM,CAAAiJ,KAAK,CAAG,EAAE5M,gBAAgB,CAACqG,OAAO,CACxCxG,mBAAmB,CAACwG,OAAO,CAAG,IAAI,CAElC,CAAC,SAAY,CACX,IAAK,KAAM,CAAAtD,IAAI,GAAI,CAAAsD,OAAO,CAAE,KAAAwG,eAAA,CAC1B,GAAI7M,gBAAgB,CAACqG,OAAO,GAAKuG,KAAK,CAAE,OACxC,KAAM,CAAApI,GAAG,CAAGP,gBAAgB,CAAClB,IAAI,CAAC,CAClC,GAAI,CAACyB,GAAG,CAAE,SACV,GAAI1E,oBAAoB,CAACuG,OAAO,CAACxC,GAAG,CAACW,GAAG,CAAC,CAAE,SAC3C1E,oBAAoB,CAACuG,OAAO,CAACxB,GAAG,CAACL,GAAG,CAAC,CACrC,IAAAqI,eAAA,CAAI9J,IAAI,CAACW,QAAQ,UAAAmJ,eAAA,WAAbA,eAAA,CAAelJ,MAAM,CAAE,SAC3B,KAAM,CAAA6F,eAAe,CAACzG,IAAI,CAAC,CAC3B,KAAM,IAAI,CAAA+J,OAAO,CAAEC,OAAO,EAAKC,UAAU,CAACD,OAAO,CAAE,GAAG,CAAC,CAAC,CAC1D,CACF,CAAC,EAAE,CAAC,CAACE,OAAO,CAAC,IAAM,CACjB,GAAIjN,gBAAgB,CAACqG,OAAO,GAAKuG,KAAK,CAAE,CACtC/M,mBAAmB,CAACwG,OAAO,CAAG,KAAK,CACrC,CACF,CAAC,CAAC,CACJ,CAAC,CAAE,CAAC/I,MAAM,CAAEa,KAAK,CAACmL,SAAS,CAAE9K,YAAY,CAAEE,eAAe,CAAC,CAAC,CAE5D,KAAM,CAAAwO,qBAAqB,CAAGA,CAAA,GAAM,CAClC,KAAM,CAAA9G,UAAU,CAAG,EAAE,CACrB,GAAI,CAAAC,OAAO,CAAG3H,eAAe,CAE7B,IAAK,KAAM,CAAA4H,QAAQ,GAAI,CAAA9H,YAAY,CAAE,CACnC,KAAM,CAAA0H,KAAK,CAAGG,OAAO,CAACE,IAAI,CAAEC,GAAG,EAC5BA,GAAG,CAAChE,EAAE,EAAIH,MAAM,CAACmE,GAAG,CAAChE,EAAE,CAAC,GAAKH,MAAM,CAACiE,QAAQ,CAAC,EAC7CE,GAAG,CAAC/D,GAAG,EAAIJ,MAAM,CAACmE,GAAG,CAAC/D,GAAG,CAAC,GAAKJ,MAAM,CAACiE,QAAQ,CACjD,CAAC,CACD,GAAIJ,KAAK,CAAE,CACTE,UAAU,CAACf,IAAI,CAACa,KAAK,CAAC,CACtBG,OAAO,CAAGvC,sBAAsB,CAACoC,KAAK,CAACxC,QAAQ,EAAI,EAAE,CAAEwC,KAAK,CAAC,CAC/D,CACF,CAEA,MAAO,CAAAE,UAAU,CACnB,CAAC,CAED,KAAM,CAAA+G,kBAAkB,CAAIhN,KAAK,EAAK,CACpCtB,iBAAiB,CAAC,IAAI,CAAC,CACvB,GAAIsB,KAAK,CAAG,CAAC,CAAE,CACb1B,eAAe,CAAC,EAAE,CAAC,CACrB,CAAC,IAAM,CACLA,eAAe,CAACD,YAAY,CAAC8L,KAAK,CAAC,CAAC,CAAEnK,KAAK,CAAG,CAAC,CAAC,CAAC,CACnD,CACF,CAAC,CAED,KAAM,CAAAiN,iBAAiB,CAAGzD,oBAAoB,CAAC,CAAC,CAChD,KAAM,CAAAvD,UAAU,CAAG8G,qBAAqB,CAAC,CAAC,CAE1C,mBACEjQ,IAAA,QAAKoQ,SAAS,CAAC,eAAe,CAACC,KAAK,CAAE,CACpCC,QAAQ,CAAE,OAAO,CACjBC,GAAG,CAAE,CAAC,CACNC,IAAI,CAAE,CAAC,CACPC,KAAK,CAAE,CAAC,CACRC,MAAM,CAAE,CAAC,CACTC,eAAe,CAAE,sBAAsB,CACvCC,cAAc,CAAE,WAAW,CAC3B9M,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBC,MAAM,CAAE,IAAI,CACZ1N,OAAO,CAAE,MAAM,CACf2N,SAAS,CAAE,sBACb,CAAE,CAAAvK,QAAA,cACAvG,KAAA,QAAKkQ,SAAS,CAAC,4CAA4C,CAACC,KAAK,CAAE,CACjE7M,UAAU,CAAE,iFAAiF,CAC7FD,YAAY,CAAE,MAAM,CACpBF,OAAO,CAAE,MAAM,CACfD,KAAK,CAAE,OAAO,CACd6N,QAAQ,CAAE,MAAM,CAChBC,SAAS,CAAE,MAAM,CACjBC,QAAQ,CAAE,MAAM,CAChB7N,MAAM,CAAE,kCAAkC,CAC1C8N,SAAS,CAAE,uDAAuD,CAClE1N,KAAK,CAAE,SAAS,CAChBsN,SAAS,CAAE,uBACb,CAAE,CAAAvK,QAAA,eACAvG,KAAA,QAAKmQ,KAAK,CAAE,CACVvM,OAAO,CAAE,MAAM,CACfgN,cAAc,CAAE,eAAe,CAC/BD,UAAU,CAAE,YAAY,CACxB9M,YAAY,CAAE,MAChB,CAAE,CAAA0C,QAAA,eACAvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAE+M,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,MAAO,CAAE,CAAA5K,QAAA,eACjEzG,IAAA,QAAKqQ,KAAK,CAAE,CACVjN,KAAK,CAAE,MAAM,CACbkO,MAAM,CAAE,MAAM,CACd/N,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,2EAA2E,CACvFF,MAAM,CAAE,mCAAmC,CAC3CQ,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBM,SAAS,CAAE,oCAAoC,CAC/C3N,QAAQ,CAAE,MACZ,CAAE,CAAAgD,QAAA,CAAC,cAEH,CAAK,CAAC,cACNvG,KAAA,QAAAuG,QAAA,eACEzG,IAAA,OAAIqQ,KAAK,CAAE,CAAEkB,MAAM,CAAE,CAAC,CAAE9N,QAAQ,CAAE,MAAM,CAAEO,UAAU,CAAE,KAAM,CAAE,CAAAyC,QAAA,CAAC,yGAAkB,CAAI,CAAC,cACtFzG,IAAA,MAAGqQ,KAAK,CAAE,CAAEkB,MAAM,CAAE,SAAS,CAAE7N,KAAK,CAAE,SAAS,CAAED,QAAQ,CAAE,MAAO,CAAE,CAAAgD,QAAA,CAAC,gLAErE,CAAG,CAAC,EACD,CAAC,EACH,CAAC,cACNzG,IAAA,WACEwR,OAAO,CAAElR,OAAQ,CACjB+P,KAAK,CAAE,CACLjN,KAAK,CAAE,MAAM,CACbkO,MAAM,CAAE,MAAM,CACd/N,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,uBAAuB,CACnCF,MAAM,CAAE,iCAAiC,CACzCmO,MAAM,CAAE,SAAS,CACjB/N,KAAK,CAAE,SAAS,CAChBI,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBnN,UAAU,CAAE,eACd,CAAE,CACF+N,YAAY,CAAGC,CAAC,EAAK,CACnBA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,yBAAyB,CAC5DmO,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,wBAAwB,CAC5DF,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC3M,KAAK,CAAG,SAAS,CACzC,CAAE,CACFoO,YAAY,CAAGH,CAAC,EAAK,CACnBA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,uBAAuB,CAC1DmO,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,uBAAuB,CAC3DF,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC3M,KAAK,CAAG,SAAS,CACzC,CAAE,CAAA+C,QAAA,cAEFzG,IAAA,CAACL,KAAK,EAACoS,IAAI,CAAE,EAAG,CAAE,CAAC,CACb,CAAC,EACN,CAAC,cAEN7R,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEkO,aAAa,CAAE,QAAQ,CAAEX,GAAG,CAAE,MAAO,CAAE,CAAA5K,QAAA,eACpEvG,KAAA,QAAAuG,QAAA,eACEzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,6CAAQ,CAAO,CAAC,cAC1CvG,KAAA,WACEwF,KAAK,CAAExE,KAAK,CAACmL,SAAU,CACvB4F,QAAQ,CAAGN,CAAC,EAAKxQ,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAEgF,SAAS,CAAEsF,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,EAAG,CAAE,CAC9E2K,KAAK,CAAElN,UAAW,CAAAsD,QAAA,eAElBzG,IAAA,WAAQ0F,KAAK,CAAC,EAAE,CAAAe,QAAA,CAAC,6FAAgB,CAAQ,CAAC,CACzChG,QAAQ,CAACkH,GAAG,CAAEtD,OAAO,eACpBnE,KAAA,WAAyBwF,KAAK,CAAErB,OAAO,CAACkB,EAAG,CAAAkB,QAAA,EACxCrC,kBAAkB,CAACC,OAAO,CAAC,CAAC,IAAE,CAACA,OAAO,CAAC6N,KAAK,EAAI,YAAY,CAAC,GAChE,GAFa7N,OAAO,CAACkB,EAEb,CACT,CAAC,EACI,CAAC,EACN,CAAC,cAENrF,KAAA,QAAAuG,QAAA,eACEzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,gHAAoB,CAAO,CAAC,cACtDzG,IAAA,UACEiL,IAAI,CAAC,MAAM,CACXvF,KAAK,CAAExE,KAAK,CAAC8D,KAAM,CACnBiN,QAAQ,CAAGN,CAAC,EAAKxQ,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAErC,KAAK,CAAE2M,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,EAAG,CAAE,CAC1EyM,WAAW,CAAC,sJAAmC,CAC/C9B,KAAK,CAAElN,UAAW,CAClBiP,OAAO,CAAGT,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,sBAAuB,CAC3EQ,MAAM,CAAGV,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,uBAAwB,CAC5E,CAAC,EACC,CAAC,cAEN3R,KAAA,QAAAuG,QAAA,eACEzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,mDAAS,CAAO,CAAC,cAC3CzG,IAAA,aACE0F,KAAK,CAAExE,KAAK,CAACoR,WAAY,CACzBL,QAAQ,CAAGN,CAAC,EAAKxQ,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAEiL,WAAW,CAAEX,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,EAAG,CAAE,CAChFyM,WAAW,CAAC,wJAAqC,CACjDI,IAAI,CAAC,GAAG,CACRlC,KAAK,CAAAnI,aAAA,CAAAA,aAAA,IACA/E,UAAU,MACbqP,SAAS,CAAE,OAAO,CAClBC,MAAM,CAAE,UAAU,CAClBC,UAAU,CAAE,SAAS,EACrB,CACFN,OAAO,CAAGT,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,sBAAuB,CAC3EQ,MAAM,CAAGV,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,uBAAwB,CAC5E,CAAC,EACC,CAAC,cAEN3R,KAAA,QAAAuG,QAAA,eACEzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,iCAAW,CAAO,CAAC,cAC7CvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEuN,GAAG,CAAE,KAAK,CAAER,UAAU,CAAE,QAAS,CAAE,CAAApK,QAAA,eAChEzG,IAAA,UACEiL,IAAI,CAAC,QAAQ,CACbvF,KAAK,CAAExE,KAAK,CAACyR,KAAM,CACnBV,QAAQ,CAAGN,CAAC,EAAKxQ,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAEsL,KAAK,CAAEhB,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,EAAG,CAAE,CAC1EyM,WAAW,CAAC,MAAM,CAClB9B,KAAK,CAAElN,UAAW,CAClBiP,OAAO,CAAGT,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,sBAAuB,CAC3EQ,MAAM,CAAGV,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,uBAAwB,CAC5E,CAAC,cACF7R,IAAA,SAAMqQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAEM,UAAU,CAAE,KAAM,CAAE,CAAAyC,QAAA,CAAC,QAAC,CAAM,CAAC,EAC3D,CAAC,EACH,CAAC,cAENvG,KAAA,QAAAuG,QAAA,eACEvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEgN,cAAc,CAAE,eAAe,CAAED,UAAU,CAAE,QAAS,CAAE,CAAApK,QAAA,eACrFzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,yDAAU,CAAO,CAAC,cAC5CvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEuN,GAAG,CAAE,MAAM,CAAER,UAAU,CAAE,QAAS,CAAE,CAAApK,QAAA,EAChEnF,mBAAmB,eAClBpB,KAAA,SAAMmQ,KAAK,CAAE,CAAE5M,QAAQ,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAA+C,QAAA,EAAC,0DACxC,CAAC,GAAI,CAAAmM,IAAI,CAACtR,mBAAmB,CAAC,CAACuR,kBAAkB,CAAC,CAAC,EAC1D,CACP,cACD3S,KAAA,WACE+K,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAEA,CAAA,GAAM7Q,mBAAmB,CAAC,IAAI,CAAE,CACzCmS,QAAQ,CAAElS,iBAAkB,CAC5BwP,SAAS,CAAC,kBAAkB,CAC5BC,KAAK,CAAE,CACLhN,OAAO,CAAE,UAAU,CACnBC,MAAM,CAAE,iCAAiC,CACzCmO,MAAM,CAAE7Q,iBAAiB,CAAG,aAAa,CAAG,SAAS,CACrD6C,QAAQ,CAAE,MAAM,CAChBK,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBQ,GAAG,CAAE,KACP,CAAE,CAAA5K,QAAA,EAED7F,iBAAiB,cAAGZ,IAAA,CAACF,WAAW,EAACiS,IAAI,CAAE,EAAG,CAAE,CAAC,cAAG/R,IAAA,CAACH,WAAW,EAACkS,IAAI,CAAE,EAAG,CAAE,CAAC,CACzEnR,iBAAiB,CAAG,eAAe,CAAG,UAAU,EAC3C,CAAC,EACN,CAAC,EACH,CAAC,cAENV,KAAA,QAAKmQ,KAAK,CAAE,CACV/M,MAAM,CAAE,iCAAiC,CACzCC,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,oBAAoB,CAChCuP,SAAS,CAAE,MAAM,CACjB5B,QAAQ,CAAE,QACZ,CAAE,CAAA1K,QAAA,eACAvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEhN,OAAO,CAAE,WAAW,CAAEa,YAAY,CAAE,iCAAkC,CAAE,CAAAuC,QAAA,eACpFzG,IAAA,QAAKqQ,KAAK,CAAE,CAAErM,UAAU,CAAE,KAAK,CAAEN,KAAK,CAAE,SAAU,CAAE,CAAA+C,QAAA,CAAC,yGAAkB,CAAK,CAAC,cAC7EzG,IAAA,QAAKqQ,KAAK,CAAE,CAAE5M,QAAQ,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAA+C,QAAA,CAAC,kIAAuB,CAAK,CAAC,EAC9E,CAAC,CAGL0C,UAAU,CAACzC,MAAM,CAAG,CAAC,eACpBxG,KAAA,QAAKmQ,KAAK,CAAE,CACVhN,OAAO,CAAE,WAAW,CACpBa,YAAY,CAAE,iCAAiC,CAC/CJ,OAAO,CAAE,MAAM,CACfuN,GAAG,CAAE,KAAK,CACVR,UAAU,CAAE,QAAQ,CACpBmC,QAAQ,CAAE,MAAM,CAChBvP,QAAQ,CAAE,MAAM,CAChBC,KAAK,CAAE,SACT,CAAE,CAAA+C,QAAA,eACAzG,IAAA,WACEwR,OAAO,CAAEA,CAAA,GAAMtB,kBAAkB,CAAC,CAAC,CAAC,CAAE,CACtCG,KAAK,CAAE,CACL7M,UAAU,CAAE,sBAAsB,CAClCF,MAAM,CAAE,gCAAgC,CACxCC,YAAY,CAAE,KAAK,CACnBF,OAAO,CAAE,SAAS,CAClBoO,MAAM,CAAE,SAAS,CACjB/N,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MAAM,CAChBE,UAAU,CAAE,eACd,CAAE,CACF+N,YAAY,CAAGC,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,sBAAuB,CAC/EsO,YAAY,CAAGH,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,sBAAuB,CAAAiD,QAAA,CAChF,2EAED,CAAQ,CAAC,CACR0C,UAAU,CAACxB,GAAG,CAAC,CAAC4B,GAAG,CAAErG,KAAK,gBACzBhD,KAAA,CAACZ,KAAK,CAAC2T,QAAQ,EAAAxM,QAAA,eACbzG,IAAA,CAACJ,gBAAgB,EAACmS,IAAI,CAAE,EAAG,CAAE,CAAC,cAC9B/R,IAAA,WACEwR,OAAO,CAAEA,CAAA,GAAMtB,kBAAkB,CAAChN,KAAK,CAAE,CACzCmN,KAAK,CAAE,CACL7M,UAAU,CAAEN,KAAK,GAAKiG,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAG,sBAAsB,CAAG,uBAAuB,CAC9FpD,MAAM,CAAE,YAAY,EAAIJ,KAAK,GAAKiG,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAG,sBAAsB,CAAG,uBAAuB,CAAC,CAC3GnD,YAAY,CAAE,KAAK,CACnBF,OAAO,CAAE,SAAS,CAClBoO,MAAM,CAAEvO,KAAK,GAAKiG,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC/DhD,KAAK,CAAER,KAAK,GAAKiG,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAG,SAAS,CAAG,SAAS,CAC9DjD,QAAQ,CAAE,MAAM,CAChBE,UAAU,CAAE,eACd,CAAE,CAAA8C,QAAA,CAED7B,gBAAgB,CAAC2E,GAAG,CAAC,CAChB,CAAC,GAhBUA,GAAG,CAAChE,EAAE,EAAIgE,GAAG,CAAC/D,GAiBnB,CACjB,CAAC,EACC,CACN,cAEDxF,IAAA,QAAKkT,GAAG,CAAE3Q,eAAgB,CAAC8N,KAAK,CAAE,CAAEhN,OAAO,CAAE,MAAM,CAAEmP,SAAS,CAAE,OAAO,CAAEtB,SAAS,CAAE,OAAO,CAAEiC,SAAS,CAAE,MAAO,CAAE,CAAA1M,QAAA,CAC9G0J,iBAAiB,CAACzJ,MAAM,CACvByJ,iBAAiB,CAACxI,GAAG,CAAE9C,QAAQ,EAAK,CAClC,mBACE7E,IAAA,WAEEiL,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAEA,CAAA,GAAM1E,uBAAuB,CAACjI,QAAQ,CAAE,CACjDiO,QAAQ,CAAE,CAAC5R,KAAK,CAACmL,SAAU,CAC3BgE,KAAK,CAAE,CACLjN,KAAK,CAAE,MAAM,CACbgQ,SAAS,CAAE,MAAM,CACjB/P,OAAO,CAAE,WAAW,CACpBU,YAAY,CAAE,KAAK,CACnBR,YAAY,CAAE,MAAM,CACpBD,MAAM,CAAE,uBAAuB,CAC/BE,UAAU,CAAE,wBAAwB,CACpCE,KAAK,CAAE,SAAS,CAChB+N,MAAM,CAAEvQ,KAAK,CAACmL,SAAS,CAAG,SAAS,CAAG,aAAa,CACnD1I,UAAU,CAAE,eACd,CAAE,CACF+N,YAAY,CAAGC,CAAC,EAAK,CACnBA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,sBAAsB,CACzDmO,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,sBAAsB,CAC5D,CAAE,CACFC,YAAY,CAAGH,CAAC,EAAK,CACnBA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAAC7M,UAAU,CAAG,wBAAwB,CAC3DmO,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,aAAa,CACnD,CAAE,CAAApL,QAAA,cAEFvG,KAAA,SAAMmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEgN,cAAc,CAAE,eAAe,CAAED,UAAU,CAAE,QAAS,CAAE,CAAApK,QAAA,eACtFzG,IAAA,SAAAyG,QAAA,CAAO7B,gBAAgB,CAACC,QAAQ,CAAC,CAAO,CAAC,cACzC7E,IAAA,CAACJ,gBAAgB,EAACmS,IAAI,CAAE,EAAG,CAACrO,KAAK,CAAC,SAAS,CAAE,CAAC,EAC1C,CAAC,EA5BFmB,QAAQ,CAACU,EAAE,EAAIV,QAAQ,CAACW,GAAG,EAAIZ,gBAAgB,CAACC,QAAQ,CA6BvD,CAAC,CAEb,CAAC,CAAC,cAEF7E,IAAA,QAAKqQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAEL,OAAO,CAAE,MAAM,CAAE+P,SAAS,CAAE,QAAS,CAAE,CAAA3M,QAAA,CACpE,CAACvF,KAAK,CAACmL,SAAS,CACb,0BAA0B,CAC1BhK,qBAAqB,CACnB,wDAAwD,CAC1Dd,YAAY,CAACmF,MAAM,CAAG,CAAC,CACrB,4CAA4C,CAC5C,sBAAsB,CACzB,CACN,CACE,CAAC,CAELrE,qBAAqB,eACpBrC,IAAA,QAAKqQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAED,QAAQ,CAAE,MAAM,CAAEJ,OAAO,CAAE,aAAc,CAAE,CAAAoD,QAAA,CACxEpE,qBAAqB,CACnB,CACN,cAEDnC,KAAA,QAAKmQ,KAAK,CAAE,CACVgD,SAAS,CAAE,iCAAiC,CAC5ChQ,OAAO,CAAE,WAAW,CACpBK,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MAAM,CAChBK,OAAO,CAAE,MAAM,CACfuN,GAAG,CAAE,KAAK,CACV2B,QAAQ,CAAE,MAAM,CAChBnC,UAAU,CAAE,QACd,CAAE,CAAApK,QAAA,eACAzG,IAAA,SAAMqQ,KAAK,CAAE,CACX7M,UAAU,CAAE,sBAAsB,CAClCH,OAAO,CAAE,SAAS,CAClBE,YAAY,CAAE,OAAO,CACrBG,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MAAM,CAChBO,UAAU,CAAE,KACd,CAAE,CAAAyC,QAAA,CAAC,4CAEH,CAAM,CAAC,CACN0C,UAAU,CAACzC,MAAM,CAAG,CAAC,CACpByC,UAAU,CAACxB,GAAG,CAAC,CAAC4B,GAAG,CAAErG,KAAK,gBACxBhD,KAAA,CAACZ,KAAK,CAAC2T,QAAQ,EAAAxM,QAAA,EACZvD,KAAK,CAAG,CAAC,eAAIlD,IAAA,CAACJ,gBAAgB,EAACmS,IAAI,CAAE,EAAG,CAAE,CAAC,cAC5C/R,IAAA,SAAMqQ,KAAK,CAAEnN,KAAK,GAAKiG,UAAU,CAACzC,MAAM,CAAG,CAAC,CAAGzC,sBAAsB,CAAGgC,SAAU,CAAAQ,QAAA,CAC/E7B,gBAAgB,CAAC2E,GAAG,CAAC,CAClB,CAAC,GAJYA,GAAG,CAAChE,EAAE,EAAIgE,GAAG,CAAC/D,GAKnB,CACjB,CAAC,cAEFxF,IAAA,SAAAyG,QAAA,CAAM,QAAC,CAAM,CACd,EACE,CAAC,EACH,CAAC,EACH,CAAC,CAELzF,kBAAkB,eACjBd,KAAA,QAAKmQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAED,QAAQ,CAAE,MAAM,CAAEK,OAAO,CAAE,MAAM,CAAE+M,UAAU,CAAE,QAAQ,CAAEQ,GAAG,CAAE,KAAM,CAAE,CAAA5K,QAAA,eACpGzG,IAAA,CAACF,WAAW,EAACiS,IAAI,CAAE,EAAG,CAAE,CAAC,0KAE3B,EAAK,CACN,CAEA,CAAC/Q,kBAAkB,EAAIC,gBAAgB,eACtCf,KAAA,QAAKmQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAED,QAAQ,CAAE,MAAO,CAAE,CAAAgD,QAAA,EAAC,gOACR,CAACxF,gBAAgB,EACxD,CACN,CAEA,CAACD,kBAAkB,EAAI,CAACC,gBAAgB,GAAKC,KAAK,CAAC0I,UAAU,EAAI1I,KAAK,CAAC2I,WAAW,CAAC,GAAK,CAAChJ,WAAW,EAAIA,WAAW,CAAC6F,MAAM,GAAK,CAAC,CAAC,eAChI1G,IAAA,QAAKqQ,KAAK,CAAE,CAAE3M,KAAK,CAAE,SAAS,CAAED,QAAQ,CAAE,MAAO,CAAE,CAAAgD,QAAA,CAAC,wSAEpD,CAAK,CACN,CAEA,CAACzF,kBAAkB,EAAI,CAAAH,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAE6F,MAAM,EAAG,CAAC,eAC7CxG,KAAA,QAAKmQ,KAAK,CAAE,CAAE0C,SAAS,CAAE,KAAM,CAAE,CAAAtM,QAAA,eAC/BzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,8IAAyB,CAAO,CAAC,cAC3DzG,IAAA,QAAKqQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEuN,GAAG,CAAE,MAAO,CAAE,CAAA5K,QAAA,CAC1C5F,WAAW,CAAC8G,GAAG,CAAE2L,KAAK,EAAK,KAAAC,cAAA,CAC1B,KAAM,CAAAhM,GAAG,CAAG+L,KAAK,CAAChP,IAAI,EAAIgP,KAAK,CAACvO,KAAK,CACrC,KAAM,CAAAW,KAAK,CAAG6B,GAAG,CAAI,CAAAzG,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAGyG,GAAG,CAAC,GAAI,EAAE,CAAI,EAAE,CACxD,mBACErH,KAAA,QAAqCmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAEkO,aAAa,CAAE,QAAQ,CAAEX,GAAG,CAAE,KAAM,CAAE,CAAA5K,QAAA,eACnGvG,KAAA,SAAMmQ,KAAK,CAAE,CAAE5M,QAAQ,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAA+C,QAAA,EACjD6M,KAAK,CAACvO,KAAK,CAAEuO,KAAK,CAACE,QAAQ,CAAG,IAAI,CAAG,EAAE,EACpC,CAAC,cACPtT,KAAA,WACEwF,KAAK,CAAEA,KAAM,CACbuM,QAAQ,CAAGN,CAAC,EAAK,CACf,KAAM,CAAA/I,SAAS,CAAG+I,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,CAChC3E,mBAAmB,CAAEsG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAE,CAACE,GAAG,EAAGqB,SAAS,EAAG,CAAC,CAChE,CAAE,CACFyH,KAAK,CAAElN,UAAW,CAAAsD,QAAA,eAElBzG,IAAA,WAAQ0F,KAAK,CAAC,EAAE,CAAAe,QAAA,CAAC,kDAAQ,CAAQ,CAAC,EAAA8M,cAAA,CACjCD,KAAK,CAACG,OAAO,UAAAF,cAAA,iBAAbA,cAAA,CAAe5L,GAAG,CAAE+L,MAAM,eACzB1T,IAAA,WAA2C0F,KAAK,CAAEgO,MAAM,CAAChO,KAAM,CAAAe,QAAA,CAC5DiN,MAAM,CAAC3O,KAAK,EADF2O,MAAM,CAAChO,KAAK,EAAIgO,MAAM,CAAC3O,KAE5B,CACT,CAAC,EACI,CAAC,GAlBDuO,KAAK,CAAChP,IAAI,EAAIgP,KAAK,CAACvO,KAmBzB,CAAC,CAEV,CAAC,CAAC,CACC,CAAC,EACH,CACN,cAED7E,KAAA,QAAAuG,QAAA,eACEvG,KAAA,QAAKmQ,KAAK,CAAE,CAAEvM,OAAO,CAAE,MAAM,CAAE+M,UAAU,CAAE,QAAQ,CAAEC,cAAc,CAAE,eAAe,CAAEO,GAAG,CAAE,MAAO,CAAE,CAAA5K,QAAA,eAClGzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,6CAAa,CAAO,CAAC,cAC/CzG,IAAA,WACEiL,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAEjC,sBAAuB,CAChCuD,QAAQ,CAAE3Q,UAAW,CACrBkO,KAAK,CAAE,CACLhN,OAAO,CAAE,UAAU,CACnBE,YAAY,CAAE,OAAO,CACrBD,MAAM,CAAE,iCAAiC,CACzCE,UAAU,CAAE,sBAAsB,CAClCE,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MAAM,CAChBO,UAAU,CAAE,KAAK,CACjByN,MAAM,CAAEtP,UAAU,CAAG,aAAa,CAAG,SAAS,CAC9CwR,UAAU,CAAE,QACd,CAAE,CAAAlN,QAAA,CAEDtE,UAAU,CAAG,aAAa,CAAG,cAAc,CACtC,CAAC,EACN,CAAC,cACNnC,IAAA,UACEiL,IAAI,CAAC,MAAM,CACXvF,KAAK,CAAExE,KAAK,CAACuO,UAAW,CACxBwC,QAAQ,CAAGN,CAAC,EAAKxQ,QAAQ,CAAEkG,IAAI,EAAAa,aAAA,CAAAA,aAAA,IAAWb,IAAI,MAAEoI,UAAU,CAAEkC,CAAC,CAAClJ,MAAM,CAAC/C,KAAK,EAAG,CAAE,CAC/EyM,WAAW,CAAC,kIAAyB,CACrC9B,KAAK,CAAElN,UAAW,CAClBiP,OAAO,CAAGT,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,sBAAuB,CAC3EQ,MAAM,CAAGV,CAAC,EAAKA,CAAC,CAACC,aAAa,CAACvB,KAAK,CAACwB,WAAW,CAAG,uBAAwB,CAC5E,CAAC,EACC,CAAC,cAEN3R,KAAA,QAAAuG,QAAA,eACEzG,IAAA,UAAOqQ,KAAK,CAAExM,UAAW,CAAA4C,QAAA,CAAC,qEAAY,CAAO,CAAC,cAC9CzG,IAAA,UACEkT,GAAG,CAAE1Q,aAAc,CACnByI,IAAI,CAAC,MAAM,CACX2I,MAAM,CAAC,SAAS,CAChBC,QAAQ,MACR5B,QAAQ,CAAEtH,sBAAuB,CACjC0F,KAAK,CAAE,CACLjN,KAAK,CAAE,MAAM,CACbC,OAAO,CAAE,MAAM,CACfC,MAAM,CAAE,kCAAkC,CAC1CC,YAAY,CAAE,MAAM,CACpBC,UAAU,CAAE,oBAAoB,CAChCE,KAAK,CAAE,SAAS,CAChB+N,MAAM,CAAE,SAAS,CACjB9N,UAAU,CAAE,eACd,CAAE,CACH,CAAC,CACDvC,QAAQ,CAACsF,MAAM,CAAG,CAAC,eAClBxG,KAAA,QAAKmQ,KAAK,CAAE,CAAE0C,SAAS,CAAE,KAAK,CAAEtP,QAAQ,CAAE,MAAM,CAAEC,KAAK,CAAE,SAAU,CAAE,CAAA+C,QAAA,EAAC,+FAClD,CAACrF,QAAQ,CAACsF,MAAM,CAAC,yTACrC,EAAK,CACN,CACA7E,aAAa,CAAC6E,MAAM,CAAG,CAAC,eACvB1G,IAAA,QACEqQ,KAAK,CAAE,CACL0C,SAAS,CAAE,MAAM,CACjBjP,OAAO,CAAE,MAAM,CACfgQ,mBAAmB,CAAE,sCAAsC,CAC3DzC,GAAG,CAAE,MACP,CAAE,CAAA5K,QAAA,CAED5E,aAAa,CAAC8F,GAAG,CAAC,CAACwC,OAAO,CAAEjH,KAAK,gBAChChD,KAAA,QAEE6T,aAAa,CAAGnJ,KAAK,EAAKA,KAAK,CAACc,cAAc,CAAC,CAAE,CACjDsI,WAAW,CAAGpJ,KAAK,EAAKY,cAAc,CAACZ,KAAK,CAAE1H,KAAK,CAAE,CACrDwO,YAAY,CAAEA,CAAA,GAAM/F,eAAe,CAACzI,KAAK,CAAE,CAC3C+Q,SAAS,CAAEA,CAAA,GAAM5J,aAAa,CAAC,CAAE,CACjCgG,KAAK,CAAE,CACLC,QAAQ,CAAE,UAAU,CACpB/M,YAAY,CAAE,MAAM,CACpB4N,QAAQ,CAAE,QAAQ,CAClB3N,UAAU,CAAE,SAAS,CACrBF,MAAM,CAAErB,cAAc,GAAKiB,KAAK,CAC5B,gCAAgC,CAChC,iCAAiC,CACrCgR,WAAW,CAAE,OAAO,CACpBpQ,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBM,SAAS,CAAEnP,cAAc,GAAKiB,KAAK,CAC/B,gCAAgC,CAChC,MAAM,CACVuO,MAAM,CAAE1P,eAAe,CAAG,UAAU,CAAG,SAAS,CAChDoS,UAAU,CAAE,MACd,CAAE,CAAA1N,QAAA,eAEFzG,IAAA,QACEoU,GAAG,CAAEjK,OAAO,CAAC3E,GAAI,CACjB6O,GAAG,YAAA1P,MAAA,CAAazB,KAAK,CAAG,CAAC,CAAG,CAC5BoR,SAAS,CAAE,KAAM,CACjBjE,KAAK,CAAE,CAAEjN,KAAK,CAAE,MAAM,CAAEkO,MAAM,CAAE,MAAM,CAAEiD,SAAS,CAAE,OAAO,CAAEC,aAAa,CAAE,MAAO,CAAE,CACrF,CAAC,cACFxU,IAAA,QAAKqQ,KAAK,CAAE,CACVC,QAAQ,CAAE,UAAU,CACpBE,IAAI,CAAE,KAAK,CACXE,MAAM,CAAE,KAAK,CACb+D,QAAQ,CAAE,MAAM,CAChBnD,MAAM,CAAE,MAAM,CACdjO,OAAO,CAAE,OAAO,CAChBE,YAAY,CAAE,OAAO,CACrBO,OAAO,CAAE,aAAa,CACtB+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBrN,QAAQ,CAAE,MAAM,CAChBO,UAAU,CAAE,GAAG,CACfN,KAAK,CAAE,SAAS,CAChBF,UAAU,CAAE,kBAAkB,CAC9BF,MAAM,CAAE,kCACV,CAAE,CAAAmD,QAAA,CACCvD,KAAK,CAAG,CAAC,CACP,CAAC,cACNlD,IAAA,WACEiL,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAG5G,KAAK,EAAK,CAClBA,KAAK,CAACc,cAAc,CAAC,CAAC,CACtBd,KAAK,CAAC8J,eAAe,CAAC,CAAC,CACvBvJ,aAAa,CAACjI,KAAK,CAAC,CACtB,CAAE,CACFmN,KAAK,CAAE,CACLC,QAAQ,CAAE,UAAU,CACpBC,GAAG,CAAE,KAAK,CACVE,KAAK,CAAE,KAAK,CACZrN,KAAK,CAAE,MAAM,CACbkO,MAAM,CAAE,MAAM,CACd/N,YAAY,CAAE,OAAO,CACrBD,MAAM,CAAE,+BAA+B,CACvCE,UAAU,CAAE,sBAAsB,CAClCE,KAAK,CAAE,SAAS,CAChBD,QAAQ,CAAE,MAAM,CAChBkR,UAAU,CAAE,CAAC,CACblD,MAAM,CAAE,SAAS,CACjB3N,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAClB,CAAE,CACF9L,KAAK,CAAC,qEAAc,CAAAyB,QAAA,CACrB,MAED,CAAQ,CAAC,GA5EJ0D,OAAO,CAAC3E,GA6EV,CACN,CAAC,CACC,CACN,EACE,CAAC,cAENtF,KAAA,QAAKmQ,KAAK,CAAE,CAAE0C,SAAS,CAAE,MAAM,CAAEjP,OAAO,CAAE,MAAM,CAAEuN,GAAG,CAAE,MAAM,CAAEP,cAAc,CAAE,UAAW,CAAE,CAAArK,QAAA,eAC1FzG,IAAA,WACEiL,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAElR,OAAQ,CACjB8P,SAAS,CAAC,kBAAkB,CAC5BC,KAAK,CAAE,CACLhN,OAAO,CAAE,WAAW,CACpBC,MAAM,CAAE,MAAM,CACdmO,MAAM,CAAE,SAAS,CACjBlO,YAAY,CAAE,MAAM,CACpBE,QAAQ,CAAE,MAAM,CAChBO,UAAU,CAAE,KACd,CAAE,CAAAyC,QAAA,CACH,sCAED,CAAQ,CAAC,cACTzG,IAAA,WACEiL,IAAI,CAAC,QAAQ,CACbuG,OAAO,CAAEjR,QAAS,CAClB6P,SAAS,CAAC,gBAAgB,CAC1B0C,QAAQ,CAAEtS,UAAW,CACrB6P,KAAK,CAAE,CACLhN,OAAO,CAAE,WAAW,CACpBK,KAAK,CAAE,OAAO,CACdJ,MAAM,CAAE,MAAM,CACdmO,MAAM,CAAEjR,UAAU,CAAG,aAAa,CAAG,SAAS,CAC9CoU,OAAO,CAAEpU,UAAU,CAAG,GAAG,CAAG,CAAC,CAC7B+C,YAAY,CAAE,MAAM,CACpBE,QAAQ,CAAE,MAAM,CAChBO,UAAU,CAAE,KAAK,CACjBF,OAAO,CAAE,MAAM,CACf+M,UAAU,CAAE,QAAQ,CACpBQ,GAAG,CAAE,KACP,CAAE,CAAA5K,QAAA,CAEDjG,UAAU,CAAG,eAAe,CAAG,uBAAuB,CACjD,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAL,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}