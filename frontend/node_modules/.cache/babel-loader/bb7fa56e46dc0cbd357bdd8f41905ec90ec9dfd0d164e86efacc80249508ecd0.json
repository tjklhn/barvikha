{"ast":null,"code":"var _jsxFileName = \"/Users/eurocare/Downloads/barvihaluxury-main/frontend/src/components/MessagesTab.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { apiFetchJson, getAccessToken } from \"../api\";\nimport { MessageIcon } from \"./Icons\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst SEEN_STORAGE_KEY = \"kl_messages_seen_v1\";\nconst THREAD_CACHE_TTL_MS = 2 * 60 * 1000;\nconst detectMobileView = () => {\n  var _window$screen;\n  if (typeof window === \"undefined\") return false;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth || 0;\n  const screenWidth = typeof ((_window$screen = window.screen) === null || _window$screen === void 0 ? void 0 : _window$screen.width) === \"number\" ? window.screen.width : viewportWidth;\n  const effectiveWidth = Math.min(viewportWidth || screenWidth, screenWidth || viewportWidth);\n  const mobileUa = /Android|webOS|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(typeof navigator !== \"undefined\" && navigator.userAgent || \"\");\n  const hasCoarsePointer = typeof window.matchMedia === \"function\" ? window.matchMedia(\"(pointer: coarse)\").matches : false;\n  const noHover = typeof window.matchMedia === \"function\" ? window.matchMedia(\"(hover: none)\").matches : false;\n  const touchPoints = typeof navigator !== \"undefined\" ? Number(navigator.maxTouchPoints || 0) : 0;\n  const touchLikeDevice = hasCoarsePointer || noHover || touchPoints > 1;\n  return effectiveWidth <= 768 || touchLikeDevice && effectiveWidth <= 1024 || mobileUa && effectiveWidth <= 1180;\n};\nconst normalizePreviewImageUrl = value => {\n  const raw = String(value || \"\").trim();\n  if (!raw) return \"\";\n  if (/^data:/i.test(raw)) return \"\";\n  const normalizeRuleForKleinanzeigen = parsed => {\n    const host = String(parsed.hostname || \"\").toLowerCase();\n    const isProdAdsImage = host === \"img.kleinanzeigen.de\" && parsed.pathname.startsWith(\"/api/v1/prod-ads/images/\");\n    if (!isProdAdsImage) return parsed;\n    const ruleParam = String(parsed.searchParams.get(\"rule\") || \"\");\n    const malformedRule = /(imageid|\\$\\{.*\\}|\\$_\\{.*\\})/i.test(ruleParam);\n    const validRule = /^\\$_[a-z0-9_.-]+$/i.test(ruleParam);\n    if (!validRule || malformedRule) {\n      parsed.searchParams.set(\"rule\", \"$_57.JPG\");\n    }\n    return parsed;\n  };\n  if (/^(https?:)?\\/\\//i.test(raw)) {\n    try {\n      const parsed = normalizeRuleForKleinanzeigen(new URL(raw.startsWith(\"//\") ? `https:${raw}` : raw));\n      return parsed.href;\n    } catch {\n      return raw.startsWith(\"//\") ? `https:${raw}` : raw;\n    }\n  }\n  if (/^img\\.kleinanzeigen\\.de/i.test(raw)) return normalizePreviewImageUrl(`https://${raw}`);\n  if (/^\\/api\\/v1\\/prod-ads\\/images\\//i.test(raw)) return normalizePreviewImageUrl(`https://img.kleinanzeigen.de${raw}`);\n  try {\n    const parsed = normalizeRuleForKleinanzeigen(new URL(raw, \"https://www.kleinanzeigen.de\"));\n    return parsed.href;\n  } catch {\n    return \"\";\n  }\n};\nconst toMessageImageSrc = (value, accountId) => {\n  const normalized = normalizePreviewImageUrl(value);\n  if (!normalized) return \"\";\n  const accountToken = accountId !== undefined && accountId !== null && String(accountId).trim() ? String(accountId).trim() : \"\";\n  const accessToken = getAccessToken();\n  if (normalized.startsWith(\"/api/messages/image?\")) {\n    let src = normalized;\n    if (accountToken && !/[?&]accountId=/i.test(src)) {\n      const separator = src.includes(\"?\") ? \"&\" : \"?\";\n      src = `${src}${separator}accountId=${encodeURIComponent(accountToken)}`;\n    }\n    if (accessToken && !/[?&](accessToken|token)=/i.test(src)) {\n      const separator = src.includes(\"?\") ? \"&\" : \"?\";\n      src = `${src}${separator}accessToken=${encodeURIComponent(accessToken)}`;\n    }\n    return src;\n  }\n  if (/^https?:\\/\\//i.test(normalized)) {\n    if (!accountToken) return normalized;\n    const params = new URLSearchParams();\n    params.set(\"url\", normalized);\n    params.set(\"accountId\", accountToken);\n    if (accessToken) {\n      params.set(\"accessToken\", accessToken);\n    }\n    return `/api/messages/image?${params.toString()}`;\n  }\n  return normalized;\n};\nconst getRawMessagePreviewImage = message => {\n  var _message$ad, _message$ad2, _message$ad3;\n  if (!message || typeof message !== \"object\") return \"\";\n  const candidates = [message.adImage, message.adImageUrl, message.adImageURL, message.imageUrl, message.image, message.thumbnailUrl, message.thumbnail, message.previewImage, (_message$ad = message.ad) === null || _message$ad === void 0 ? void 0 : _message$ad.image, (_message$ad2 = message.ad) === null || _message$ad2 === void 0 ? void 0 : _message$ad2.imageUrl, (_message$ad3 = message.ad) === null || _message$ad3 === void 0 ? void 0 : _message$ad3.thumbnailUrl];\n  for (const candidate of candidates) {\n    const normalized = normalizePreviewImageUrl(candidate);\n    if (normalized) return normalized;\n  }\n  return \"\";\n};\nconst getMessagePreviewImage = message => toMessageImageSrc(getRawMessagePreviewImage(message), message === null || message === void 0 ? void 0 : message.accountId);\nconst hasMessagePreviewImage = message => Boolean(getRawMessagePreviewImage(message));\nconst isPaymentAndShippingMessage = message => {\n  if (!message || typeof message !== \"object\") return false;\n  const type = String(message.type || \"\").toUpperCase();\n  return type === \"PAYMENT_AND_SHIPPING_MESSAGE\" || Boolean(message.paymentAndShippingMessageType);\n};\nconst formatEuroFromCents = value => {\n  const cents = Number(value);\n  if (!Number.isFinite(cents)) return \"\";\n  return (cents / 100).toLocaleString(\"de-DE\", {\n    style: \"currency\",\n    currency: \"EUR\"\n  });\n};\nconst pickOfferField = (message, key) => {\n  if (!message || typeof message !== \"object\") return null;\n  const direct = message[key];\n  if (direct !== undefined && direct !== null) return direct;\n  const actions = Array.isArray(message.actions) ? message.actions : [];\n  const withKey = actions.find(action => action && action[key] !== undefined && action[key] !== null);\n  return withKey ? withKey[key] : null;\n};\nconst getOfferActionText = (message, actionType, fallback = \"\") => {\n  const actions = Array.isArray(message === null || message === void 0 ? void 0 : message.actions) ? message.actions : [];\n  const action = actions.find(item => (item === null || item === void 0 ? void 0 : item.actionType) === actionType);\n  return (action === null || action === void 0 ? void 0 : action.ctaText) || fallback;\n};\nconst extractAttachmentUrls = message => {\n  const attachments = Array.isArray(message === null || message === void 0 ? void 0 : message.attachments) ? message.attachments : [];\n  const urls = [];\n  for (const item of attachments) {\n    if (!item) continue;\n    if (typeof item === \"string\") {\n      urls.push(item);\n      continue;\n    }\n    if (typeof item === \"object\") {\n      const candidate = item.url || item.href || item.src || item.imageUrl || item.thumbnailUrl;\n      if (candidate) urls.push(candidate);\n    }\n  }\n  return urls.filter(Boolean);\n};\nconst getConversationKey = message => {\n  if (!message || typeof message !== \"object\") return \"\";\n  const accountId = message.accountId != null ? String(message.accountId) : \"\";\n  const convo = message.conversationId || message.conversationUrl || message.id || \"\";\n  const convoId = convo != null ? String(convo) : \"\";\n  if (!accountId || !convoId) return \"\";\n  return `${accountId}|${convoId}`;\n};\nconst getConversationFingerprint = message => {\n  if (!message || typeof message !== \"object\") return \"\";\n  const date = String(message.date || \"\").trim();\n  const time = String(message.time || \"\").trim();\n  const text = String(message.message || \"\").trim();\n  return `${date}|${time}|${text}`;\n};\nconst loadSeenMap = () => {\n  if (typeof window === \"undefined\" || !window.localStorage) return {};\n  try {\n    const raw = window.localStorage.getItem(SEEN_STORAGE_KEY);\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return parsed && typeof parsed === \"object\" ? parsed : {};\n  } catch {\n    return {};\n  }\n};\nconst saveSeenMap = next => {\n  if (typeof window === \"undefined\" || !window.localStorage) return;\n  try {\n    window.localStorage.setItem(SEEN_STORAGE_KEY, JSON.stringify(next || {}));\n  } catch {\n    // ignore quota / serialization issues\n  }\n};\nconst MessagesTab = () => {\n  _s();\n  var _selectedMessage$mess;\n  const [messages, setMessages] = useState([]);\n  const [selectedMessage, setSelectedMessage] = useState(null);\n  const [replyText, setReplyText] = useState(\"\");\n  const [replyImages, setReplyImages] = useState([]);\n  const [sending, setSending] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [loadingThread, setLoadingThread] = useState(false);\n  const [error, setError] = useState(null);\n  const [isMobileView, setIsMobileView] = useState(() => detectMobileView());\n  const [translationByMessageId, setTranslationByMessageId] = useState({});\n  const [declineConfirmOpen, setDeclineConfirmOpen] = useState(false);\n  const [decliningOffer, setDecliningOffer] = useState(false);\n  const chatScrollRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const previewHydrationInFlight = useRef(new Set());\n  const messagesRefreshInFlight = useRef(false);\n  const translateInFlight = useRef(new Set());\n  const threadCacheRef = useRef(new Map());\n  const clearComposerImages = () => {\n    setReplyImages(prev => {\n      const existing = Array.isArray(prev) ? prev : [];\n      existing.forEach(item => {\n        if (item !== null && item !== void 0 && item.previewUrl) {\n          URL.revokeObjectURL(item.previewUrl);\n        }\n      });\n      return [];\n    });\n  };\n  const getThreadCacheKeyForMessage = message => {\n    if (!message || typeof message !== \"object\") return \"\";\n    const accountId = message.accountId != null ? String(message.accountId) : \"\";\n    const conversationId = message.conversationId != null ? String(message.conversationId) : \"\";\n    const conversationUrl = message.conversationUrl != null ? String(message.conversationUrl) : \"\";\n    if (!accountId) return \"\";\n    if (conversationId) return `${accountId}|cid:${conversationId}`;\n    if (conversationUrl) return `${accountId}|url:${conversationUrl}`;\n    return \"\";\n  };\n  const readThreadCacheEntry = message => {\n    const key = getThreadCacheKeyForMessage(message);\n    if (!key) return null;\n    const entry = threadCacheRef.current.get(key);\n    if (!entry || typeof entry !== \"object\") return null;\n    if (!entry.expiresAt || entry.expiresAt < Date.now()) {\n      threadCacheRef.current.delete(key);\n      return null;\n    }\n    return entry;\n  };\n  const writeThreadCacheEntry = (message, payload) => {\n    const key = getThreadCacheKeyForMessage(message);\n    if (!key || !payload || typeof payload !== \"object\") return;\n    threadCacheRef.current.set(key, {\n      expiresAt: Date.now() + THREAD_CACHE_TTL_MS,\n      payload: {\n        adTitle: payload.adTitle || \"\",\n        adImage: payload.adImage || \"\",\n        sender: payload.sender || \"\",\n        messages: Array.isArray(payload.messages) ? payload.messages : [],\n        conversationId: payload.conversationId || (message === null || message === void 0 ? void 0 : message.conversationId) || \"\",\n        conversationUrl: payload.conversationUrl || (message === null || message === void 0 ? void 0 : message.conversationUrl) || \"\"\n      }\n    });\n  };\n  useEffect(() => {\n    loadMessages();\n  }, []);\n  useEffect(() => {\n    const intervalId = window.setInterval(() => {\n      // Avoid background polling when the tab is hidden (mobile data / lower load).\n      if (typeof document !== \"undefined\" && document.visibilityState !== \"visible\") return;\n      loadMessages({\n        silent: true\n      });\n    }, 3 * 60 * 1000);\n    return () => window.clearInterval(intervalId);\n  }, []);\n  useEffect(() => {\n    if (!selectedMessage) return;\n    const container = chatScrollRef.current;\n    if (!container) return;\n    container.scrollTo({\n      top: container.scrollHeight,\n      behavior: \"smooth\"\n    });\n  }, [selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.id, selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.messages]);\n  useEffect(() => {\n    // Reset composer state when switching conversations.\n    setReplyText(\"\");\n    clearComposerImages();\n    setDeclineConfirmOpen(false);\n    setDecliningOffer(false);\n  }, [selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.id]);\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobileView(detectMobileView());\n    };\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n  const hydrateMissingPreviewImages = async list => {\n    if (!Array.isArray(list) || !list.length) return;\n    const candidates = list.filter(item => item && !hasMessagePreviewImage(item)).slice(0, 10);\n    for (const item of candidates) {\n      const key = String(item.conversationId || item.conversationUrl || item.id || \"\");\n      if (!key || previewHydrationInFlight.current.has(key)) continue;\n      previewHydrationInFlight.current.add(key);\n      try {\n        const params = new URLSearchParams();\n        if (item.accountId != null) params.set(\"accountId\", String(item.accountId));\n        if (item.conversationId) params.set(\"conversationId\", String(item.conversationId));\n        if (item.conversationUrl) params.set(\"conversationUrl\", String(item.conversationUrl));\n        if (!item.conversationId && !item.conversationUrl) {\n          if (item.sender) params.set(\"participant\", String(item.sender));\n          if (item.adTitle) params.set(\"adTitle\", String(item.adTitle));\n        }\n        if (!params.get(\"accountId\")) continue;\n        const data = await apiFetchJson(`/api/messages/thread?${params.toString()}`);\n        const adImage = normalizePreviewImageUrl(data === null || data === void 0 ? void 0 : data.adImage);\n        if (!adImage) continue;\n        setMessages(prev => prev.map(msg => {\n          const sameConversation = item.conversationId && msg.conversationId && String(item.conversationId) === String(msg.conversationId) || item.conversationUrl && msg.conversationUrl && String(item.conversationUrl) === String(msg.conversationUrl) || String(msg.id) === String(item.id);\n          if (!sameConversation) return msg;\n          return {\n            ...msg,\n            adImage,\n            adTitle: (data === null || data === void 0 ? void 0 : data.adTitle) || msg.adTitle,\n            conversationId: (data === null || data === void 0 ? void 0 : data.conversationId) || msg.conversationId,\n            conversationUrl: (data === null || data === void 0 ? void 0 : data.conversationUrl) || msg.conversationUrl\n          };\n        }));\n      } catch (error) {\n        console.error(\"Не удалось догрузить превью диалога:\", error);\n      } finally {\n        previewHydrationInFlight.current.delete(key);\n      }\n    }\n  };\n  const rememberConversationSeen = message => {\n    const key = getConversationKey(message);\n    if (!key) return;\n    const fingerprint = getConversationFingerprint(message);\n    if (!fingerprint) return;\n    const seen = loadSeenMap();\n    seen[key] = {\n      fingerprint,\n      seenAt: Date.now()\n    };\n    saveSeenMap(seen);\n\n    // Immediately update UI so the badge doesn't come back on refresh.\n    setMessages(prev => prev.map(msg => {\n      const msgKey = getConversationKey(msg);\n      if (!msgKey || msgKey !== key) return msg;\n      return {\n        ...msg,\n        unread: false\n      };\n    }));\n  };\n  const loadMessages = async (opts = {}) => {\n    const silent = Boolean(opts && typeof opts === \"object\" && opts.silent);\n    if (messagesRefreshInFlight.current) return;\n    messagesRefreshInFlight.current = true;\n    if (!silent) {\n      setLoading(true);\n      setError(null);\n    }\n    try {\n      const data = await apiFetchJson(\"/api/messages\");\n      const list = Array.isArray(data) ? data : [];\n      const seen = new Set();\n      const deduped = [];\n      for (const item of list) {\n        const key = item.conversationId || item.conversationUrl || item.id || `${item.accountId || \"\"}|${item.sender || \"\"}|${item.adTitle || \"\"}|${item.message || \"\"}|${item.time || \"\"}`;\n        if (seen.has(key)) continue;\n        seen.add(key);\n        deduped.push(item);\n      }\n      const seenMap = loadSeenMap();\n      const merged = deduped.map(item => {\n        const key = getConversationKey(item);\n        if (!key) return item;\n        const entry = seenMap[key];\n        if (!entry || typeof entry !== \"object\") return item;\n        const currentFingerprint = getConversationFingerprint(item);\n        if (entry.fingerprint && entry.fingerprint === currentFingerprint) {\n          return {\n            ...item,\n            unread: false\n          };\n        }\n        return item;\n      });\n      setMessages(merged);\n      hydrateMissingPreviewImages(merged);\n    } catch (err) {\n      console.error(\"Ошибка загрузки сообщений:\", err);\n      if (!silent) setError(err.message || \"Не удалось загрузить сообщения\");\n    } finally {\n      if (!silent) setLoading(false);\n      messagesRefreshInFlight.current = false;\n    }\n  };\n\n  // NOTE: Backend does not guarantee a \"mark read\" API (and Kleinanzeigen state may lag).\n  // We persist \"seen\" locally so a refresh won't resurrect the \"new\" badge.\n  const markAsRead = message => rememberConversationSeen(message);\n  const handleReplyImageSelect = event => {\n    var _event$target;\n    const files = Array.from((event === null || event === void 0 ? void 0 : (_event$target = event.target) === null || _event$target === void 0 ? void 0 : _event$target.files) || []);\n    if (event !== null && event !== void 0 && event.target) event.target.value = \"\";\n    if (!files.length) return;\n    const nextItems = files.filter(file => String((file === null || file === void 0 ? void 0 : file.type) || \"\").toLowerCase().startsWith(\"image/\")).slice(0, 10).map(file => ({\n      id: `img-${Date.now()}-${Math.random().toString(16).slice(2)}`,\n      file,\n      previewUrl: URL.createObjectURL(file)\n    }));\n    if (!nextItems.length) return;\n    setReplyImages(prev => {\n      const existing = Array.isArray(prev) ? prev : [];\n      return [...existing, ...nextItems].slice(0, 10);\n    });\n  };\n  const removeReplyImage = id => {\n    setReplyImages(prev => {\n      const existing = Array.isArray(prev) ? prev : [];\n      const target = existing.find(item => (item === null || item === void 0 ? void 0 : item.id) === id);\n      if (target !== null && target !== void 0 && target.previewUrl) {\n        URL.revokeObjectURL(target.previewUrl);\n      }\n      return existing.filter(item => (item === null || item === void 0 ? void 0 : item.id) !== id);\n    });\n  };\n  const formatRequestError = (error, fallbackText) => {\n    var _error$data, _error$data2;\n    const baseMessage = String((error === null || error === void 0 ? void 0 : error.message) || fallbackText || \"Ошибка запроса\").trim();\n    const debugId = (error === null || error === void 0 ? void 0 : (_error$data = error.data) === null || _error$data === void 0 ? void 0 : _error$data.debugId) || (error === null || error === void 0 ? void 0 : error.debugId) || \"\";\n    const requestId = (error === null || error === void 0 ? void 0 : (_error$data2 = error.data) === null || _error$data2 === void 0 ? void 0 : _error$data2.requestId) || (error === null || error === void 0 ? void 0 : error.requestId) || \"\";\n    if (debugId) {\n      return `${baseMessage} (debugId: ${debugId})`;\n    }\n    if (requestId) {\n      return `${baseMessage} (requestId: ${requestId})`;\n    }\n    return baseMessage;\n  };\n  const confirmDeclineOffer = async () => {\n    if (!selectedMessage || decliningOffer) return;\n    if (!selectedMessage.conversationId && !selectedMessage.conversationUrl) {\n      alert(\"Не найден идентификатор диалога.\");\n      return;\n    }\n    setDecliningOffer(true);\n    try {\n      const result = await apiFetchJson(\"/api/messages/offer/decline\", {\n        method: \"POST\",\n        timeoutMs: 240000,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          accountId: selectedMessage.accountId,\n          conversationId: selectedMessage.conversationId,\n          conversationUrl: selectedMessage.conversationUrl\n        })\n      });\n      const serverMessages = Array.isArray(result.messages) ? result.messages : [];\n      if (serverMessages.length) {\n        const lastMessage = serverMessages[serverMessages.length - 1];\n        const nextConversationId = result.conversationId || selectedMessage.conversationId;\n        const nextConversationUrl = result.conversationUrl || selectedMessage.conversationUrl;\n        setMessages(prev => prev.map(msg => msg.id === selectedMessage.id ? {\n          ...msg,\n          message: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.text) || msg.message,\n          date: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.date) || msg.date,\n          time: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.time) || msg.time,\n          conversationId: nextConversationId || msg.conversationId,\n          conversationUrl: nextConversationUrl || msg.conversationUrl,\n          unread: false\n        } : msg));\n        setSelectedMessage(prev => ({\n          ...prev,\n          messages: serverMessages,\n          conversationId: nextConversationId || prev.conversationId,\n          conversationUrl: nextConversationUrl || prev.conversationUrl\n        }));\n        writeThreadCacheEntry(selectedMessage, {\n          adTitle: selectedMessage.adTitle,\n          adImage: selectedMessage.adImage,\n          sender: selectedMessage.sender,\n          messages: serverMessages,\n          conversationId: nextConversationId,\n          conversationUrl: nextConversationUrl\n        });\n      } else {\n        // Fallback: refresh thread when backend doesn't return messages.\n        fetchThread(selectedMessage, {\n          force: true\n        });\n      }\n      setDeclineConfirmOpen(false);\n    } catch (error) {\n      console.error(\"Ошибка отклонения заявки:\", error, {\n        status: error === null || error === void 0 ? void 0 : error.status,\n        code: error === null || error === void 0 ? void 0 : error.code,\n        data: (error === null || error === void 0 ? void 0 : error.data) || null\n      });\n      alert(formatRequestError(error, \"Не удалось отклонить заявку\"));\n    } finally {\n      setDecliningOffer(false);\n    }\n  };\n  const sendReply = async () => {\n    if (!selectedMessage) return;\n    if (!selectedMessage.conversationId && !selectedMessage.conversationUrl && !selectedMessage.sender && !selectedMessage.adTitle) {\n      alert(\"Не найден идентификатор диалога.\");\n      return;\n    }\n    const textToSend = replyText.trim();\n    const imagesToSend = Array.isArray(replyImages) ? replyImages : [];\n    if (imagesToSend.length && !selectedMessage.conversationId && !selectedMessage.conversationUrl) {\n      alert(\"Для отправки фото нужен conversationId диалога. Откройте диалог и попробуйте снова.\");\n      return;\n    }\n    if (!textToSend && imagesToSend.length === 0) return;\n    const now = new Date();\n    const optimisticId = `local-${now.getTime()}-${Math.random().toString(16).slice(2)}`;\n    const optimisticAttachments = imagesToSend.map(item => {\n      var _item$file, _item$file2;\n      return {\n        url: (item === null || item === void 0 ? void 0 : item.previewUrl) || \"\",\n        name: (item === null || item === void 0 ? void 0 : (_item$file = item.file) === null || _item$file === void 0 ? void 0 : _item$file.name) || \"\",\n        type: (item === null || item === void 0 ? void 0 : (_item$file2 = item.file) === null || _item$file2 === void 0 ? void 0 : _item$file2.type) || \"\",\n        local: true\n      };\n    }).filter(item => item === null || item === void 0 ? void 0 : item.url);\n    const previewText = textToSend || (optimisticAttachments.length ? \"Фото\" : \"\");\n    const optimisticMessage = {\n      id: optimisticId,\n      text: textToSend,\n      date: now.toISOString().slice(0, 10),\n      time: now.toTimeString().slice(0, 5),\n      direction: \"outgoing\",\n      sender: \"Вы\",\n      pending: true,\n      ...(optimisticAttachments.length ? {\n        attachments: optimisticAttachments\n      } : {})\n    };\n\n    // Optimistic UI: show message immediately in the thread and conversation list.\n    setReplyText(\"\");\n    setReplyImages([]);\n    setSelectedMessage(prev => {\n      if (!prev) return prev;\n      const existing = Array.isArray(prev.messages) && prev.messages.length ? prev.messages : prev.message ? [{\n        id: prev.id,\n        text: prev.message,\n        sender: prev.sender,\n        date: prev.date,\n        time: prev.time,\n        direction: \"incoming\"\n      }] : [];\n      return {\n        ...prev,\n        messages: [...existing, optimisticMessage]\n      };\n    });\n    setMessages(prev => prev.map(msg => msg.id === selectedMessage.id ? {\n      ...msg,\n      message: previewText,\n      date: optimisticMessage.date,\n      time: optimisticMessage.time,\n      unread: false\n    } : msg));\n    setSending(true);\n    try {\n      const result = optimisticAttachments.length ? await (() => {\n        const form = new FormData();\n        form.append(\"accountId\", String(selectedMessage.accountId));\n        if (selectedMessage.conversationId) form.append(\"conversationId\", String(selectedMessage.conversationId));\n        if (selectedMessage.conversationUrl) form.append(\"conversationUrl\", String(selectedMessage.conversationUrl));\n        if (textToSend) form.append(\"text\", textToSend);\n        imagesToSend.forEach(item => {\n          if (!(item !== null && item !== void 0 && item.file)) return;\n          form.append(\"images\", item.file, item.file.name || \"image.jpg\");\n        });\n        return apiFetchJson(\"/api/messages/send-media\", {\n          method: \"POST\",\n          timeoutMs: 240000,\n          body: form\n        });\n      })() : await apiFetchJson(\"/api/messages/send\", {\n        method: \"POST\",\n        timeoutMs: 180000,\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          accountId: selectedMessage.accountId,\n          conversationId: selectedMessage.conversationId,\n          conversationUrl: selectedMessage.conversationUrl,\n          participant: selectedMessage.sender,\n          adTitle: selectedMessage.adTitle,\n          text: textToSend\n        })\n      });\n      if (result.success) {\n        const resolvedConversationId = result.conversationId || selectedMessage.conversationId;\n        const resolvedConversationUrl = result.conversationUrl || selectedMessage.conversationUrl;\n        const serverMessages = Array.isArray(result.messages) ? result.messages : [];\n        const hasSameOutgoing = optimisticAttachments.length ? serverMessages.some(m => String((m === null || m === void 0 ? void 0 : m.direction) || \"\").toLowerCase() === \"outgoing\" && (Array.isArray(m === null || m === void 0 ? void 0 : m.attachments) && m.attachments.length > 0 || textToSend && String((m === null || m === void 0 ? void 0 : m.text) || \"\") === textToSend)) : serverMessages.some(m => String((m === null || m === void 0 ? void 0 : m.direction) || \"\").toLowerCase() === \"outgoing\" && String((m === null || m === void 0 ? void 0 : m.text) || \"\") === textToSend);\n        const nextMessages = serverMessages.length ? hasSameOutgoing ? serverMessages : [...serverMessages, {\n          ...optimisticMessage,\n          pending: false\n        }] : null;\n        if (nextMessages) {\n          const lastMessage = nextMessages[nextMessages.length - 1];\n          setMessages(prev => prev.map(msg => msg.id === selectedMessage.id ? {\n            ...msg,\n            message: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.text) || msg.message,\n            date: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.date) || msg.date,\n            time: (lastMessage === null || lastMessage === void 0 ? void 0 : lastMessage.time) || msg.time,\n            conversationId: resolvedConversationId || msg.conversationId,\n            conversationUrl: resolvedConversationUrl || msg.conversationUrl\n          } : msg));\n          setSelectedMessage(prev => ({\n            ...prev,\n            messages: nextMessages,\n            conversationId: resolvedConversationId,\n            conversationUrl: resolvedConversationUrl\n          }));\n          writeThreadCacheEntry(selectedMessage, {\n            adTitle: selectedMessage.adTitle,\n            adImage: selectedMessage.adImage,\n            sender: selectedMessage.sender,\n            messages: nextMessages,\n            conversationId: resolvedConversationId,\n            conversationUrl: resolvedConversationUrl\n          });\n        } else {\n          // Backend may respond without thread messages. Keep optimistic entry and mark it as sent.\n          setSelectedMessage(prev => {\n            if (!prev) return prev;\n            const updated = Array.isArray(prev.messages) ? prev.messages : [];\n            return {\n              ...prev,\n              messages: updated.map(m => (m === null || m === void 0 ? void 0 : m.id) === optimisticId ? {\n                ...m,\n                pending: false\n              } : m),\n              conversationId: resolvedConversationId,\n              conversationUrl: resolvedConversationUrl\n            };\n          });\n          setMessages(prev => prev.map(msg => msg.id === selectedMessage.id ? {\n            ...msg,\n            conversationId: resolvedConversationId || msg.conversationId,\n            conversationUrl: resolvedConversationUrl || msg.conversationUrl\n          } : msg));\n        }\n      } else {\n        // Revert optimistic update on logical failure.\n        setSelectedMessage(prev => {\n          if (!prev) return prev;\n          const updated = Array.isArray(prev.messages) ? prev.messages : [];\n          return {\n            ...prev,\n            messages: updated.filter(m => (m === null || m === void 0 ? void 0 : m.id) !== optimisticId)\n          };\n        });\n        setReplyText(textToSend);\n        setReplyImages(imagesToSend);\n        const debugId = result !== null && result !== void 0 && result.debugId ? ` (debugId: ${result.debugId})` : \"\";\n        alert(\"Ошибка: \" + (result.error || \"Не удалось отправить\") + debugId);\n      }\n    } catch (err) {\n      console.error(\"Ошибка отправки:\", err, {\n        status: err === null || err === void 0 ? void 0 : err.status,\n        code: err === null || err === void 0 ? void 0 : err.code,\n        data: (err === null || err === void 0 ? void 0 : err.data) || null\n      });\n      setSelectedMessage(prev => {\n        if (!prev) return prev;\n        const updated = Array.isArray(prev.messages) ? prev.messages : [];\n        return {\n          ...prev,\n          messages: updated.filter(m => (m === null || m === void 0 ? void 0 : m.id) !== optimisticId)\n        };\n      });\n      setReplyText(textToSend);\n      setReplyImages(imagesToSend);\n      alert(formatRequestError(err, \"Ошибка при отправке сообщения\"));\n    } finally {\n      setSending(false);\n    }\n  };\n  const getTimeAgo = (date, time) => {\n    if (!date && !time) return \"\";\n    const now = new Date();\n    try {\n      const messageDate = new Date(date + \"T\" + (time || \"00:00\"));\n      if (isNaN(messageDate.getTime())) return time || date || \"\";\n      const diffHours = Math.floor((now - messageDate) / (1000 * 60 * 60));\n      if (diffHours < 1) return time || \"Только что\";\n      if (diffHours < 24) return time;\n      if (diffHours < 48) return \"Вчера\";\n      return date;\n    } catch {\n      return time || date || \"\";\n    }\n  };\n  const formatMessageDate = (date, time) => {\n    if (!date && !time) return \"\";\n    const parts = [];\n    if (date) {\n      try {\n        const d = new Date(date + \"T00:00\");\n        if (!isNaN(d.getTime())) {\n          const now = new Date();\n          const diffDays = Math.floor((now - d) / (1000 * 60 * 60 * 24));\n          if (diffDays === 0) parts.push(\"Сегодня\");else if (diffDays === 1) parts.push(\"Вчера\");else parts.push(d.toLocaleDateString(\"ru-RU\", {\n            day: \"numeric\",\n            month: \"short\"\n          }));\n        } else {\n          parts.push(date);\n        }\n      } catch {\n        parts.push(date);\n      }\n    }\n    if (time) parts.push(time);\n    return parts.join(\", \");\n  };\n  const threadMessages = selectedMessage !== null && selectedMessage !== void 0 && (_selectedMessage$mess = selectedMessage.messages) !== null && _selectedMessage$mess !== void 0 && _selectedMessage$mess.length ? selectedMessage.messages : selectedMessage ? [{\n    id: selectedMessage.id,\n    text: selectedMessage.message,\n    sender: selectedMessage.sender,\n    date: selectedMessage.date,\n    time: selectedMessage.time,\n    direction: \"incoming\"\n  }] : [];\n  const fetchThread = async (message, {\n    force = false\n  } = {}) => {\n    const cached = !force ? readThreadCacheEntry(message) : null;\n    if (cached !== null && cached !== void 0 && cached.payload) {\n      const cachedPayload = cached.payload;\n      const updatedFromCache = {\n        ...message,\n        adTitle: cachedPayload.adTitle || message.adTitle,\n        adImage: cachedPayload.adImage || message.adImage,\n        sender: message.sender || cachedPayload.sender || \"\",\n        messages: Array.isArray(cachedPayload.messages) ? cachedPayload.messages : [],\n        conversationId: cachedPayload.conversationId || message.conversationId,\n        conversationUrl: cachedPayload.conversationUrl || message.conversationUrl\n      };\n      setMessages(prev => prev.map(msg => String(msg.id) === String(message.id) ? {\n        ...msg,\n        adTitle: updatedFromCache.adTitle,\n        adImage: updatedFromCache.adImage,\n        conversationId: updatedFromCache.conversationId,\n        conversationUrl: updatedFromCache.conversationUrl\n      } : msg));\n      setSelectedMessage(updatedFromCache);\n      return;\n    }\n    setLoadingThread(true);\n    try {\n      const params = new URLSearchParams();\n      params.set(\"accountId\", message.accountId);\n      if (message.conversationId) params.set(\"conversationId\", message.conversationId);\n      if (message.conversationUrl) params.set(\"conversationUrl\", message.conversationUrl);\n      if (!message.conversationId && !message.conversationUrl) {\n        if (message.sender) params.set(\"participant\", message.sender);\n        if (message.adTitle) params.set(\"adTitle\", message.adTitle);\n      }\n      const data = await apiFetchJson(`/api/messages/thread?${params.toString()}`);\n      if (data.success) {\n        const adImage = normalizePreviewImageUrl(data.adImage || message.adImage);\n        const updated = {\n          ...message,\n          adTitle: data.adTitle || message.adTitle,\n          adImage,\n          sender: message.sender || data.participant || \"\",\n          messages: data.messages || [],\n          conversationId: data.conversationId || message.conversationId,\n          conversationUrl: data.conversationUrl || message.conversationUrl\n        };\n        setMessages(prev => prev.map(msg => String(msg.id) === String(message.id) ? {\n          ...msg,\n          adTitle: updated.adTitle,\n          adImage: updated.adImage,\n          conversationId: updated.conversationId,\n          conversationUrl: updated.conversationUrl\n        } : msg));\n        setSelectedMessage(updated);\n        writeThreadCacheEntry(updated, updated);\n      }\n    } catch (err) {\n      console.error(\"Ошибка загрузки диалога:\", err);\n    } finally {\n      setLoadingThread(false);\n    }\n  };\n  const handleKeyDown = e => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendReply();\n    }\n  };\n  const unreadCount = messages.filter(m => m.unread).length;\n  const showConversationList = !isMobileView || !selectedMessage;\n  const showChatPanel = !isMobileView || Boolean(selectedMessage);\n  const selectedRawPreviewImage = selectedMessage ? getRawMessagePreviewImage(selectedMessage) : \"\";\n  const selectedPreviewImage = selectedMessage ? toMessageImageSrc(selectedRawPreviewImage, selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.accountId) : \"\";\n  const selectedDirectPreviewImage = normalizePreviewImageUrl(selectedRawPreviewImage);\n  const hasReplyPayload = Boolean(replyText.trim()) || replyImages.length > 0;\n  const canSendReply = !sending && hasReplyPayload;\n\n  // Spinner SVG for loading states\n  const Spinner = ({\n    size = 20,\n    color = \"#7dd3fc\"\n  }) => /*#__PURE__*/_jsxDEV(\"svg\", {\n    width: size,\n    height: size,\n    viewBox: \"0 0 24 24\",\n    style: {\n      animation: \"spin 1s linear infinite\"\n    },\n    children: /*#__PURE__*/_jsxDEV(\"circle\", {\n      cx: \"12\",\n      cy: \"12\",\n      r: \"10\",\n      stroke: color,\n      strokeWidth: \"3\",\n      fill: \"none\",\n      strokeDasharray: \"31.4\",\n      strokeDashoffset: \"10\",\n      strokeLinecap: \"round\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 890,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 889,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }\n        @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.8; } }\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }\n        .msg-conv-item:hover { background: rgba(59,130,246,0.12) !important; }\n        .msg-send-btn:hover:not(:disabled) { background: #16a34a !important; }\n        .msg-refresh-btn:hover:not(:disabled) { background: #0284c7 !important; transform: scale(1.02); }\n        .msg-refresh-btn:active:not(:disabled) { transform: scale(0.98); }\n        .msg-translate-btn:hover { opacity: 1 !important; transform: translateY(-1px) scale(1.02) !important; }\n        .msg-translate-btn:active { transform: translateY(0px) scale(0.98) !important; }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 896,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"section-header\",\n      style: {\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        gap: \"12px\",\n        marginBottom: \"20px\",\n        flexWrap: \"wrap\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          margin: 0,\n          color: \"#f8fafc\",\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: \"14px\",\n          fontWeight: 700\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            width: \"42px\",\n            height: \"42px\",\n            borderRadius: \"14px\",\n            background: \"linear-gradient(135deg, rgba(249, 115, 22, 0.25), rgba(194, 65, 12, 0.2))\",\n            border: \"1px solid rgba(251, 146, 60, 0.4)\",\n            boxShadow: \"0 4px 15px rgba(251, 146, 60, 0.28)\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(MessageIcon, {\n            size: 22,\n            color: \"#fdba74\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 935,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 11\n        }, this), \"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 916,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 908,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-layout\",\n      style: {\n        display: \"flex\",\n        gap: \"20px\",\n        height: \"calc(100vh - 220px)\",\n        minHeight: \"500px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-list\",\n        style: {\n          width: \"400px\",\n          minWidth: \"340px\",\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          color: \"#e2e8f0\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          backdropFilter: \"blur(10px)\",\n          ...(showConversationList ? {} : {\n            display: \"none\"\n          })\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: \"16px 20px\",\n            borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n            background: \"rgba(15,23,42,0.5)\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n              marginBottom: \"12px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                margin: 0,\n                fontSize: \"18px\",\n                fontWeight: 700\n              },\n              children: \"\\u0414\\u0438\\u0430\\u043B\\u043E\\u0433\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 964,\n              columnNumber: 15\n            }, this), unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              style: {\n                padding: \"5px 14px\",\n                background: \"linear-gradient(135deg, #10b981, #059669)\",\n                color: \"white\",\n                borderRadius: \"9999px\",\n                fontSize: \"12px\",\n                fontWeight: 600,\n                boxShadow: \"0 0 12px rgba(16, 185, 129, 0.4)\",\n                border: \"1px solid rgba(16, 185, 129, 0.3)\"\n              },\n              children: [unreadCount, \" \", unreadCount === 1 ? \"новое\" : \"новых\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 966,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 963,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"msg-refresh-btn\",\n            onClick: loadMessages,\n            disabled: loading,\n            style: {\n              width: \"100%\",\n              padding: \"10px 16px\",\n              background: loading ? \"rgba(14,165,233,0.3)\" : \"linear-gradient(135deg, #0ea5e9, #0284c7)\",\n              color: \"white\",\n              border: \"none\",\n              borderRadius: \"10px\",\n              fontSize: \"13px\",\n              fontWeight: 600,\n              cursor: loading ? \"not-allowed\" : \"pointer\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              gap: \"8px\",\n              transition: \"all 0.15s ease\"\n            },\n            children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                size: 16,\n                color: \"#fff\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1003,\n                columnNumber: 19\n              }, this), \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439...\"]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"16\",\n                height: \"16\",\n                viewBox: \"0 0 24 24\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                strokeWidth: \"2.5\",\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                children: [/*#__PURE__*/_jsxDEV(\"polyline\", {\n                  points: \"23 4 23 10 17 10\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1009,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1010,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1008,\n                columnNumber: 19\n              }, this), \"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\"]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 980,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 958,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: \"12px\",\n            padding: \"12px 16px\",\n            background: \"rgba(239,68,68,0.15)\",\n            border: \"1px solid rgba(239,68,68,0.3)\",\n            borderRadius: \"10px\",\n            fontSize: \"13px\",\n            color: \"#fca5a5\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 600,\n              marginBottom: \"4px\"\n            },\n            children: \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1029,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1030,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: loadMessages,\n            style: {\n              marginTop: \"8px\",\n              padding: \"4px 12px\",\n              background: \"rgba(239,68,68,0.3)\",\n              color: \"#fca5a5\",\n              border: \"1px solid rgba(239,68,68,0.4)\",\n              borderRadius: \"6px\",\n              fontSize: \"12px\",\n              cursor: \"pointer\"\n            },\n            children: \"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1031,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1020,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            flex: 1,\n            overflow: \"auto\"\n          },\n          children: loading && messages.length === 0 ?\n          /*#__PURE__*/\n          // Loading skeleton\n          _jsxDEV(\"div\", {\n            style: {\n              padding: \"8px 0\"\n            },\n            children: [1, 2, 3, 4, 5].map(i => /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                padding: \"14px 20px\",\n                display: \"flex\",\n                gap: \"12px\",\n                alignItems: \"center\",\n                borderBottom: \"1px solid rgba(148,163,184,0.08)\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: \"52px\",\n                  height: \"52px\",\n                  borderRadius: \"12px\",\n                  background: \"rgba(148,163,184,0.1)\",\n                  flexShrink: 0,\n                  animation: \"pulse 1.5s ease-in-out infinite\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1062,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  flex: 1\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    height: \"14px\",\n                    width: \"60%\",\n                    background: \"rgba(148,163,184,0.1)\",\n                    borderRadius: \"4px\",\n                    marginBottom: \"8px\",\n                    animation: \"pulse 1.5s ease-in-out infinite\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1071,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    height: \"12px\",\n                    width: \"80%\",\n                    background: \"rgba(148,163,184,0.08)\",\n                    borderRadius: \"4px\",\n                    marginBottom: \"6px\",\n                    animation: \"pulse 1.5s ease-in-out infinite\",\n                    animationDelay: \"0.1s\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1079,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    height: \"10px\",\n                    width: \"40%\",\n                    background: \"rgba(148,163,184,0.06)\",\n                    borderRadius: \"4px\",\n                    animation: \"pulse 1.5s ease-in-out infinite\",\n                    animationDelay: \"0.2s\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1088,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1070,\n                columnNumber: 21\n              }, this)]\n            }, i, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1055,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1053,\n            columnNumber: 15\n          }, this) : messages.length === 0 && !loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: \"60px 20px\",\n              textAlign: \"center\",\n              color: \"#64748b\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: \"40px\",\n                marginBottom: \"12px\",\n                opacity: 0.5\n              },\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"48\",\n                height: \"48\",\n                viewBox: \"0 0 24 24\",\n                fill: \"none\",\n                stroke: \"currentColor\",\n                strokeWidth: \"1.5\",\n                style: {\n                  margin: \"0 auto\",\n                  display: \"block\",\n                  color: \"#475569\"\n                },\n                children: /*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1108,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1107,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1106,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: \"15px\",\n                fontWeight: 600,\n                marginBottom: \"4px\"\n              },\n              children: \"\\u041D\\u0435\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1111,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: \"13px\"\n              },\n              children: \"\\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \\\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\\\" \\u0434\\u043B\\u044F \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1112,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1101,\n            columnNumber: 15\n          }, this) : messages.map(message => {\n            const rawPreviewImage = getRawMessagePreviewImage(message);\n            const previewImage = toMessageImageSrc(rawPreviewImage, message === null || message === void 0 ? void 0 : message.accountId);\n            const directPreviewImage = normalizePreviewImageUrl(rawPreviewImage);\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"msg-conv-item\",\n              onClick: () => {\n                markAsRead(message);\n                setSelectedMessage(message);\n                fetchThread(message);\n              },\n              style: {\n                padding: \"14px 20px\",\n                borderBottom: \"1px solid rgba(148,163,184,0.08)\",\n                cursor: \"pointer\",\n                background: (selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.id) === message.id ? \"rgba(59,130,246,0.15)\" : message.unread ? \"rgba(34,197,94,0.08)\" : \"transparent\",\n                borderLeft: (selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.id) === message.id ? \"3px solid #3b82f6\" : message.unread ? \"3px solid #22c55e\" : \"3px solid transparent\",\n                display: \"flex\",\n                alignItems: \"flex-start\",\n                gap: \"12px\",\n                transition: \"background 0.15s ease\",\n                animation: \"fadeIn 0.2s ease\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  width: \"52px\",\n                  height: \"52px\",\n                  borderRadius: \"50%\",\n                  overflow: \"hidden\",\n                  background: \"rgba(15,23,42,0.6)\",\n                  border: \"1px solid rgba(148,163,184,0.15)\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  flexShrink: 0\n                },\n                children: [previewImage ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: previewImage,\n                  \"data-direct-src\": directPreviewImage || \"\",\n                  \"data-fallback-tried\": \"0\",\n                  alt: \"\",\n                  style: {\n                    width: \"100%\",\n                    height: \"100%\",\n                    objectFit: \"cover\"\n                  },\n                  loading: \"lazy\",\n                  referrerPolicy: \"no-referrer\",\n                  onError: e => {\n                    var _imageNode$dataset, _imageNode$dataset2;\n                    const imageNode = e.currentTarget;\n                    const directSrc = String(((_imageNode$dataset = imageNode.dataset) === null || _imageNode$dataset === void 0 ? void 0 : _imageNode$dataset.directSrc) || \"\").trim();\n                    const fallbackTried = ((_imageNode$dataset2 = imageNode.dataset) === null || _imageNode$dataset2 === void 0 ? void 0 : _imageNode$dataset2.fallbackTried) === \"1\";\n                    const currentSrc = String(imageNode.getAttribute(\"src\") || \"\").trim();\n                    if (!fallbackTried && directSrc && directSrc !== currentSrc) {\n                      imageNode.dataset.fallbackTried = \"1\";\n                      imageNode.setAttribute(\"src\", directSrc);\n                      return;\n                    }\n                    imageNode.style.display = \"none\";\n                    const fallbackNode = imageNode.nextElementSibling;\n                    if (fallbackNode) fallbackNode.style.display = \"flex\";\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1163,\n                  columnNumber: 23\n                }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: \"100%\",\n                    height: \"100%\",\n                    background: message.unread ? \"linear-gradient(135deg, #22c55e, #16a34a)\" : \"linear-gradient(135deg, #3b82f6, #2563eb)\",\n                    color: \"white\",\n                    display: previewImage ? \"none\" : \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    fontSize: \"20px\",\n                    fontWeight: 700\n                  },\n                  children: (message.sender || \"?\").charAt(0).toUpperCase()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1187,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1150,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  flex: 1,\n                  minWidth: 0\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: \"flex\",\n                    justifyContent: \"space-between\",\n                    alignItems: \"center\",\n                    marginBottom: \"3px\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontWeight: 700,\n                      fontSize: \"14px\",\n                      color: \"#f1f5f9\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      maxWidth: \"65%\"\n                    },\n                    children: message.sender || \"Неизвестный\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1208,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontSize: \"11px\",\n                      color: \"#64748b\",\n                      whiteSpace: \"nowrap\",\n                      flexShrink: 0\n                    },\n                    children: getTimeAgo(message.date, message.time)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1219,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1207,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: \"13px\",\n                    color: \"#94a3b8\",\n                    fontWeight: 600,\n                    overflow: \"hidden\",\n                    textOverflow: \"ellipsis\",\n                    whiteSpace: \"nowrap\",\n                    marginBottom: \"3px\"\n                  },\n                  children: message.adTitle || \"Без названия\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1230,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: \"12px\",\n                    color: \"#64748b\",\n                    overflow: \"hidden\",\n                    textOverflow: \"ellipsis\",\n                    whiteSpace: \"nowrap\",\n                    marginBottom: \"4px\"\n                  },\n                  children: message.message || \"\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1243,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: \"6px\"\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      fontSize: \"11px\",\n                      color: \"#475569\",\n                      background: \"rgba(148,163,184,0.1)\",\n                      padding: \"1px 6px\",\n                      borderRadius: \"4px\"\n                    },\n                    children: message.accountName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1260,\n                    columnNumber: 23\n                  }, this), message.unread && /*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      padding: \"3px 10px\",\n                      background: \"linear-gradient(135deg, #8b5cf6, #7c3aed)\",\n                      color: \"white\",\n                      borderRadius: \"9999px\",\n                      fontSize: \"10px\",\n                      fontWeight: 700,\n                      textTransform: \"uppercase\",\n                      letterSpacing: \"0.5px\",\n                      boxShadow: \"0 0 10px rgba(139, 92, 246, 0.4)\",\n                      border: \"1px solid rgba(139, 92, 246, 0.3)\"\n                    },\n                    children: \"new\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1270,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1255,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1205,\n                columnNumber: 19\n              }, this)]\n            }, message.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1120,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1050,\n          columnNumber: 11\n        }, this), messages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: \"8px 20px\",\n            borderTop: \"1px solid rgba(148,163,184,0.1)\",\n            fontSize: \"11px\",\n            color: \"#475569\",\n            textAlign: \"center\",\n            background: \"rgba(15,23,42,0.3)\"\n          },\n          children: [messages.length, \" \", messages.length === 1 ? \"диалог\" : messages.length < 5 ? \"диалога\" : \"диалогов\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1295,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 943,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"messages-chat\",\n        style: {\n          flex: 1,\n          position: \"relative\",\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          color: \"#e2e8f0\",\n          backdropFilter: \"blur(10px)\",\n          ...(showChatPanel ? {} : {\n            display: \"none\"\n          })\n        },\n        children: selectedMessage ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: \"14px 20px\",\n              borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n              background: \"rgba(15,23,42,0.6)\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"flex\",\n                  gap: \"14px\",\n                  alignItems: \"center\",\n                  flex: 1,\n                  minWidth: 0\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: \"50px\",\n                    height: \"50px\",\n                    borderRadius: \"10px\",\n                    overflow: \"hidden\",\n                    border: \"1px solid rgba(148,163,184,0.15)\",\n                    background: \"rgba(15,23,42,0.8)\",\n                    flexShrink: 0,\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\"\n                  },\n                  children: selectedPreviewImage ? /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: selectedPreviewImage,\n                    \"data-direct-src\": selectedDirectPreviewImage || \"\",\n                    \"data-fallback-tried\": \"0\",\n                    alt: \"\",\n                    style: {\n                      width: \"100%\",\n                      height: \"100%\",\n                      objectFit: \"cover\"\n                    },\n                    onError: e => {\n                      var _imageNode$dataset3, _imageNode$dataset4;\n                      const imageNode = e.currentTarget;\n                      const directSrc = String(((_imageNode$dataset3 = imageNode.dataset) === null || _imageNode$dataset3 === void 0 ? void 0 : _imageNode$dataset3.directSrc) || \"\").trim();\n                      const fallbackTried = ((_imageNode$dataset4 = imageNode.dataset) === null || _imageNode$dataset4 === void 0 ? void 0 : _imageNode$dataset4.fallbackTried) === \"1\";\n                      const currentSrc = String(imageNode.getAttribute(\"src\") || \"\").trim();\n                      if (!fallbackTried && directSrc && directSrc !== currentSrc) {\n                        imageNode.dataset.fallbackTried = \"1\";\n                        imageNode.setAttribute(\"src\", directSrc);\n                        return;\n                      }\n                      imageNode.style.display = \"none\";\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1347,\n                    columnNumber: 25\n                  }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n                    width: \"24\",\n                    height: \"24\",\n                    viewBox: \"0 0 24 24\",\n                    fill: \"none\",\n                    stroke: \"#475569\",\n                    strokeWidth: \"1.5\",\n                    children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n                      x: \"3\",\n                      y: \"3\",\n                      width: \"18\",\n                      height: \"18\",\n                      rx: \"2\",\n                      ry: \"2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1368,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                      cx: \"8.5\",\n                      cy: \"8.5\",\n                      r: \"1.5\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1369,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n                      points: \"21 15 16 10 5 21\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1370,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1367,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1334,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    minWidth: 0\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: 700,\n                      fontSize: \"15px\",\n                      color: \"#f1f5f9\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\"\n                    },\n                    children: selectedMessage.sender || \"Неизвестный\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1376,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: \"13px\",\n                      color: \"#94a3b8\",\n                      fontWeight: 500,\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      marginTop: \"2px\"\n                    },\n                    children: selectedMessage.adTitle || \"Без названия\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1386,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontSize: \"11px\",\n                      color: \"#475569\",\n                      marginTop: \"2px\"\n                    },\n                    children: selectedMessage.accountName\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1397,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1375,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1332,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setSelectedMessage(null),\n                style: {\n                  background: \"rgba(148,163,184,0.1)\",\n                  border: \"none\",\n                  width: isMobileView ? \"auto\" : \"32px\",\n                  height: \"32px\",\n                  padding: isMobileView ? \"0 10px\" : 0,\n                  borderRadius: \"8px\",\n                  cursor: \"pointer\",\n                  color: \"#94a3b8\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  fontSize: \"16px\",\n                  fontWeight: 600,\n                  flexShrink: 0\n                },\n                children: isMobileView ? \"← Назад\" : /*#__PURE__*/_jsxDEV(\"svg\", {\n                  width: \"16\",\n                  height: \"16\",\n                  viewBox: \"0 0 24 24\",\n                  fill: \"none\",\n                  stroke: \"currentColor\",\n                  strokeWidth: \"2.5\",\n                  strokeLinecap: \"round\",\n                  children: [/*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"18\",\n                    y1: \"6\",\n                    x2: \"6\",\n                    y2: \"18\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1430,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"line\", {\n                    x1: \"6\",\n                    y1: \"6\",\n                    x2: \"18\",\n                    y2: \"18\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1431,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1429,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1407,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1331,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1326,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: chatScrollRef,\n            style: {\n              flex: 1,\n              padding: \"20px\",\n              overflow: \"auto\",\n              background: \"rgba(8,12,24,0.4)\"\n            },\n            children: loadingThread ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\",\n                flexDirection: \"column\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                height: \"100%\",\n                gap: \"12px\",\n                color: \"#64748b\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                size: 32,\n                color: \"#3b82f6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1455,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  fontSize: \"14px\"\n                },\n                children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\\u0430...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1456,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1446,\n              columnNumber: 19\n            }, this) : threadMessages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: \"#64748b\",\n                textAlign: \"center\",\n                paddingTop: \"40px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: \"14px\"\n                },\n                children: \"\\u041D\\u0435\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0432 \\u044D\\u0442\\u043E\\u043C \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\\u0435\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1460,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1459,\n              columnNumber: 19\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: threadMessages.map((messageItem, idx) => {\n                const isOutgoing = messageItem.direction === \"outgoing\";\n                const isPending = Boolean(messageItem.pending);\n                const isOffer = isPaymentAndShippingMessage(messageItem);\n                const messageKey = String(messageItem.id || `idx-${idx}`);\n                const translation = translationByMessageId[messageKey] || null;\n                const hasText = Boolean(String(messageItem.text || \"\").trim());\n                const attachmentSrcs = extractAttachmentUrls(messageItem).map(url => toMessageImageSrc(url, selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.accountId)).filter(Boolean);\n                const canTranslate = !isOffer && !isOutgoing && hasText;\n                const toggleTranslate = async () => {\n                  if (!canTranslate) return;\n\n                  // Toggle off when already shown.\n                  if (translation !== null && translation !== void 0 && translation.shown && translation !== null && translation !== void 0 && translation.translatedText) {\n                    setTranslationByMessageId(prev => ({\n                      ...prev,\n                      [messageKey]: {\n                        ...prev[messageKey],\n                        shown: false\n                      }\n                    }));\n                    return;\n                  }\n\n                  // Toggle on when already fetched.\n                  if (translation !== null && translation !== void 0 && translation.translatedText && !(translation !== null && translation !== void 0 && translation.loading)) {\n                    setTranslationByMessageId(prev => ({\n                      ...prev,\n                      [messageKey]: {\n                        ...prev[messageKey],\n                        shown: true,\n                        error: \"\"\n                      }\n                    }));\n                    return;\n                  }\n                  if (translateInFlight.current.has(messageKey)) return;\n                  translateInFlight.current.add(messageKey);\n                  setTranslationByMessageId(prev => ({\n                    ...prev,\n                    [messageKey]: {\n                      ...prev[messageKey],\n                      loading: true,\n                      shown: true,\n                      error: \"\"\n                    }\n                  }));\n                  try {\n                    const result = await apiFetchJson(\"/api/translate\", {\n                      method: \"POST\",\n                      headers: {\n                        \"Content-Type\": \"application/json\"\n                      },\n                      body: JSON.stringify({\n                        text: String(messageItem.text || \"\"),\n                        to: \"ru\",\n                        accountId: selectedMessage === null || selectedMessage === void 0 ? void 0 : selectedMessage.accountId\n                      })\n                    });\n                    setTranslationByMessageId(prev => ({\n                      ...prev,\n                      [messageKey]: {\n                        loading: false,\n                        shown: true,\n                        error: \"\",\n                        translatedText: (result === null || result === void 0 ? void 0 : result.translatedText) || \"\"\n                      }\n                    }));\n                  } catch (error) {\n                    console.error(\"Ошибка перевода:\", error);\n                    setTranslationByMessageId(prev => ({\n                      ...prev,\n                      [messageKey]: {\n                        loading: false,\n                        shown: true,\n                        translatedText: \"\",\n                        error: (error === null || error === void 0 ? void 0 : error.message) || \"Не удалось перевести\"\n                      }\n                    }));\n                  } finally {\n                    translateInFlight.current.delete(messageKey);\n                  }\n                };\n                const offerTitle = String((messageItem === null || messageItem === void 0 ? void 0 : messageItem.title) || \"Anfrage erhalten\").trim() || \"Anfrage erhalten\";\n                const offerItemCents = pickOfferField(messageItem, \"itemPriceInEuroCent\");\n                const offerShippingCents = pickOfferField(messageItem, \"shippingCostInEuroCent\");\n                const offerTotalCents = pickOfferField(messageItem, \"sellerTotalInEuroCent\");\n                const offerCarrierName = pickOfferField(messageItem, \"carrierName\");\n                const offerOptionName = pickOfferField(messageItem, \"shippingOptionName\");\n                const offerOptionDesc = pickOfferField(messageItem, \"shippingOptionDescription\");\n                const offerLiabilityCents = pickOfferField(messageItem, \"liabilityLimitInEuroCent\");\n                const acceptCta = getOfferActionText(messageItem, \"ACCEPT_BUYER_OFFER_LEARN_MORE_ACTION\", \"Anfrage akzeptieren\");\n                const declineCta = getOfferActionText(messageItem, \"CANCEL_OFFER_ACTION\", \"Anfrage ablehnen\");\n                const counterCta = getOfferActionText(messageItem, \"MAKE_COUNTER_OFFER_ACTION\", \"Gegenangebot machen\");\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    marginBottom: \"12px\",\n                    display: \"flex\",\n                    justifyContent: isOutgoing ? \"flex-end\" : \"flex-start\",\n                    animation: \"fadeIn 0.2s ease\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      maxWidth: isOffer ? \"520px\" : \"70%\",\n                      minWidth: isOffer ? \"240px\" : \"120px\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        fontSize: \"11px\",\n                        color: isOutgoing ? \"#86efac\" : \"#7dd3fc\",\n                        fontWeight: 600,\n                        marginBottom: \"4px\",\n                        paddingLeft: isOutgoing ? \"0\" : \"12px\",\n                        paddingRight: isOutgoing ? \"12px\" : \"0\",\n                        textAlign: isOutgoing ? \"right\" : \"left\"\n                      },\n                      children: messageItem.sender || (isOutgoing ? \"Вы\" : selectedMessage.sender || \"\")\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1582,\n                      columnNumber: 30\n                    }, this), isOffer ? /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        borderRadius: \"18px\",\n                        padding: \"14px 14px 12px 14px\",\n                        background: \"linear-gradient(145deg, rgba(2,6,23,0.55) 0%, rgba(15,23,42,0.95) 58%, rgba(6,78,59,0.22) 100%)\",\n                        border: \"1px solid rgba(34,197,94,0.22)\",\n                        boxShadow: \"0 18px 40px rgba(0,0,0,0.45)\"\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          display: \"flex\",\n                          justifyContent: \"space-between\",\n                          alignItems: \"flex-start\",\n                          gap: \"12px\",\n                          marginBottom: \"12px\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            display: \"flex\",\n                            gap: \"10px\",\n                            alignItems: \"center\",\n                            minWidth: 0\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                            style: {\n                              width: \"36px\",\n                              height: \"36px\",\n                              borderRadius: \"12px\",\n                              background: \"rgba(34,197,94,0.18)\",\n                              border: \"1px solid rgba(34,197,94,0.25)\",\n                              display: \"flex\",\n                              alignItems: \"center\",\n                              justifyContent: \"center\",\n                              flexShrink: 0\n                            },\n                            children: /*#__PURE__*/_jsxDEV(\"span\", {\n                              style: {\n                                color: \"#4ade80\",\n                                fontWeight: 900,\n                                fontSize: \"16px\"\n                              },\n                              children: \"\\u20AC\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1621,\n                              columnNumber: 40\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1610,\n                            columnNumber: 38\n                          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                            style: {\n                              minWidth: 0\n                            },\n                            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                              style: {\n                                fontSize: \"14px\",\n                                fontWeight: 800,\n                                color: \"#bbf7d0\",\n                                overflow: \"hidden\",\n                                textOverflow: \"ellipsis\",\n                                whiteSpace: \"nowrap\"\n                              },\n                              children: offerTitle\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1624,\n                              columnNumber: 40\n                            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                              style: {\n                                fontSize: \"12px\",\n                                color: \"rgba(148,163,184,0.9)\",\n                                marginTop: \"1px\"\n                              },\n                              children: \"Sicher bezahlen\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 1634,\n                              columnNumber: 40\n                            }, this)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1623,\n                            columnNumber: 38\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1609,\n                          columnNumber: 36\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            fontSize: \"20px\",\n                            fontWeight: 900,\n                            color: \"#4ade80\",\n                            whiteSpace: \"nowrap\"\n                          },\n                          children: formatEuroFromCents(offerTotalCents)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1643,\n                          columnNumber: 36\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1602,\n                        columnNumber: 34\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          display: \"flex\",\n                          flexDirection: \"column\",\n                          gap: \"8px\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            display: \"flex\",\n                            justifyContent: \"space-between\",\n                            color: \"rgba(226,232,240,0.92)\",\n                            fontSize: \"13px\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              color: \"rgba(148,163,184,0.95)\"\n                            },\n                            children: \"Betrag\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1655,\n                            columnNumber: 38\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              fontWeight: 700\n                            },\n                            children: formatEuroFromCents(offerItemCents)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1656,\n                            columnNumber: 38\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1654,\n                          columnNumber: 36\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            display: \"flex\",\n                            justifyContent: \"space-between\",\n                            color: \"rgba(226,232,240,0.92)\",\n                            fontSize: \"13px\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              color: \"rgba(148,163,184,0.95)\"\n                            },\n                            children: \"Versand\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1659,\n                            columnNumber: 38\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              fontWeight: 700\n                            },\n                            children: formatEuroFromCents(offerShippingCents)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1660,\n                            columnNumber: 38\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1658,\n                          columnNumber: 36\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            display: \"flex\",\n                            justifyContent: \"space-between\",\n                            fontSize: \"13px\",\n                            paddingTop: \"6px\",\n                            borderTop: \"1px solid rgba(148,163,184,0.12)\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              color: \"rgba(148,163,184,0.95)\",\n                              fontWeight: 800\n                            },\n                            children: \"Gesamt\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1669,\n                            columnNumber: 38\n                          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                            style: {\n                              fontWeight: 900,\n                              color: \"#e2e8f0\"\n                            },\n                            children: formatEuroFromCents(offerTotalCents)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1670,\n                            columnNumber: 38\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1662,\n                          columnNumber: 36\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1653,\n                        columnNumber: 34\n                      }, this), offerCarrierName || offerOptionName || offerOptionDesc ? /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          marginTop: \"12px\",\n                          padding: \"12px\",\n                          borderRadius: \"14px\",\n                          background: \"rgba(2,6,23,0.25)\",\n                          border: \"1px solid rgba(148,163,184,0.14)\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            fontSize: \"13px\",\n                            fontWeight: 800,\n                            color: \"#e2e8f0\"\n                          },\n                          children: [\"Inkl. \", offerCarrierName || \"Versand\", \" \", offerOptionName || \"\"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1682,\n                          columnNumber: 38\n                        }, this), offerOptionDesc ? /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            marginTop: \"4px\",\n                            fontSize: \"12px\",\n                            color: \"rgba(148,163,184,0.95)\"\n                          },\n                          children: offerOptionDesc\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1686,\n                          columnNumber: 40\n                        }, this) : null, offerLiabilityCents ? /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            marginTop: \"6px\",\n                            fontSize: \"12px\",\n                            color: \"rgba(148,163,184,0.95)\"\n                          },\n                          children: [\"Mit Sendungsverfolgung und Haftung bis \", formatEuroFromCents(offerLiabilityCents)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1691,\n                          columnNumber: 40\n                        }, this) : null]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1675,\n                        columnNumber: 36\n                      }, this) : null, hasText ? /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          marginTop: \"12px\",\n                          fontSize: \"13px\",\n                          lineHeight: \"1.5\",\n                          color: \"rgba(226,232,240,0.92)\"\n                        },\n                        children: messageItem.text\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1699,\n                        columnNumber: 36\n                      }, this) : null, /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          marginTop: \"12px\",\n                          display: \"flex\",\n                          flexDirection: \"column\",\n                          gap: \"10px\"\n                        },\n                        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                          type: \"button\",\n                          disabled: true,\n                          style: {\n                            width: \"100%\",\n                            padding: \"10px 14px\",\n                            borderRadius: \"9999px\",\n                            border: \"1px solid rgba(34,197,94,0.32)\",\n                            background: \"linear-gradient(135deg, rgba(34,197,94,0.55), rgba(22,163,74,0.45))\",\n                            color: \"rgba(255,255,255,0.95)\",\n                            fontWeight: 900,\n                            cursor: \"not-allowed\",\n                            opacity: 0.75\n                          },\n                          title: \"\\u0421\\u043A\\u043E\\u0440\\u043E\",\n                          children: acceptCta\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1710,\n                          columnNumber: 36\n                        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                          style: {\n                            display: \"flex\",\n                            gap: \"10px\"\n                          },\n                          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                            type: \"button\",\n                            onClick: () => setDeclineConfirmOpen(true),\n                            disabled: decliningOffer,\n                            style: {\n                              flex: 1,\n                              padding: \"10px 14px\",\n                              borderRadius: \"9999px\",\n                              border: \"1px solid rgba(148,163,184,0.28)\",\n                              background: \"rgba(2,6,23,0.35)\",\n                              color: \"rgba(226,232,240,0.95)\",\n                              fontWeight: 800,\n                              cursor: decliningOffer ? \"not-allowed\" : \"pointer\",\n                              opacity: decliningOffer ? 0.7 : 1\n                            },\n                            children: declineCta\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1729,\n                            columnNumber: 38\n                          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                            type: \"button\",\n                            disabled: true,\n                            style: {\n                              flex: 1,\n                              padding: \"10px 14px\",\n                              borderRadius: \"9999px\",\n                              border: \"1px solid rgba(148,163,184,0.22)\",\n                              background: \"rgba(2,6,23,0.25)\",\n                              color: \"rgba(148,163,184,0.95)\",\n                              fontWeight: 800,\n                              cursor: \"not-allowed\",\n                              opacity: 0.75\n                            },\n                            title: \"\\u0421\\u043A\\u043E\\u0440\\u043E\",\n                            children: counterCta\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1747,\n                            columnNumber: 38\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1728,\n                          columnNumber: 36\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1709,\n                        columnNumber: 34\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          fontSize: \"10px\",\n                          color: \"rgba(148,163,184,0.8)\",\n                          marginTop: \"10px\",\n                          textAlign: \"right\"\n                        },\n                        children: isPending ? \"Отправка...\" : formatMessageDate(messageItem.date || selectedMessage.date, messageItem.time || selectedMessage.time)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1768,\n                        columnNumber: 34\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1595,\n                      columnNumber: 32\n                    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        position: \"relative\",\n                        padding: canTranslate ? \"10px 14px 18px 14px\" : \"10px 14px\",\n                        borderRadius: isOutgoing ? \"14px 14px 4px 14px\" : \"14px 14px 14px 4px\",\n                        background: isOutgoing ? \"linear-gradient(135deg, #1a4731, #14532d)\" : \"rgba(15,23,42,0.8)\",\n                        border: isOutgoing ? \"1px solid rgba(34,197,94,0.25)\" : \"1px solid rgba(148,163,184,0.15)\"\n                      },\n                      children: [attachmentSrcs.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          display: \"grid\",\n                          gridTemplateColumns: \"repeat(auto-fit, minmax(120px, 1fr))\",\n                          gap: \"8px\",\n                          marginBottom: hasText ? \"8px\" : \"0\"\n                        },\n                        children: attachmentSrcs.map((src, imageIdx) => /*#__PURE__*/_jsxDEV(\"img\", {\n                          src: src,\n                          alt: \"\",\n                          loading: \"lazy\",\n                          referrerPolicy: \"no-referrer\",\n                          style: {\n                            width: \"100%\",\n                            maxHeight: \"220px\",\n                            objectFit: \"cover\",\n                            borderRadius: \"12px\",\n                            border: \"1px solid rgba(148,163,184,0.14)\"\n                          }\n                        }, `${messageKey}-img-${imageIdx}`, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1800,\n                          columnNumber: 40\n                        }, this))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1793,\n                        columnNumber: 36\n                      }, this), hasText ? /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          fontSize: \"14px\",\n                          lineHeight: \"1.5\",\n                          whiteSpace: \"pre-wrap\",\n                          wordBreak: \"break-word\",\n                          color: \"#e2e8f0\"\n                        },\n                        children: messageItem.text\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1819,\n                        columnNumber: 36\n                      }, this) : null, canTranslate && /*#__PURE__*/_jsxDEV(\"button\", {\n                        type: \"button\",\n                        className: \"msg-translate-btn\",\n                        onClick: toggleTranslate,\n                        title: \"\\u041F\\u0435\\u0440\\u0435\\u0432\\u0435\\u0441\\u0442\\u0438 \\u043D\\u0430 \\u0440\\u0443\\u0441\\u0441\\u043A\\u0438\\u0439\",\n                        style: {\n                          position: \"absolute\",\n                          left: \"8px\",\n                          bottom: \"6px\",\n                          width: \"22px\",\n                          height: \"22px\",\n                          borderRadius: \"8px\",\n                          border: \"1px solid rgba(148,163,184,0.18)\",\n                          background: \"rgba(2,6,23,0.25)\",\n                          color: \"#94a3b8\",\n                          display: \"inline-flex\",\n                          alignItems: \"center\",\n                          justifyContent: \"center\",\n                          cursor: \"pointer\",\n                          opacity: 0.75,\n                          transition: \"transform 0.12s ease, opacity 0.12s ease, background 0.12s ease\"\n                        },\n                        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                          width: \"14\",\n                          height: \"14\",\n                          viewBox: \"0 0 24 24\",\n                          fill: \"none\",\n                          stroke: \"currentColor\",\n                          strokeWidth: \"2.2\",\n                          strokeLinecap: \"round\",\n                          strokeLinejoin: \"round\",\n                          children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M5 5h6\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1856,\n                            columnNumber: 40\n                          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M8 5c0 6-3 10-6 12\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1857,\n                            columnNumber: 40\n                          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M7 13c2 2 4 4 7 6\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1858,\n                            columnNumber: 40\n                          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M14 19h7\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1859,\n                            columnNumber: 40\n                          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M17 4l4 15\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1860,\n                            columnNumber: 40\n                          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                            d: \"M20 19l-3-9-3 9\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 1861,\n                            columnNumber: 40\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1855,\n                          columnNumber: 38\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1832,\n                        columnNumber: 36\n                      }, this), (translation === null || translation === void 0 ? void 0 : translation.shown) && /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          marginTop: \"10px\",\n                          paddingTop: \"8px\",\n                          borderTop: \"1px dashed rgba(148,163,184,0.18)\",\n                          fontSize: \"13px\",\n                          lineHeight: \"1.45\",\n                          color: translation !== null && translation !== void 0 && translation.error ? \"#fb7185\" : \"#cbd5e1\",\n                          opacity: 0.95\n                        },\n                        children: translation !== null && translation !== void 0 && translation.loading ? /*#__PURE__*/_jsxDEV(\"span\", {\n                          style: {\n                            color: \"#94a3b8\"\n                          },\n                          children: \"\\u041F\\u0435\\u0440\\u0435\\u0432\\u043E\\u0434...\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1878,\n                          columnNumber: 40\n                        }, this) : translation !== null && translation !== void 0 && translation.error ? /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: translation.error\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1880,\n                          columnNumber: 40\n                        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: translation.translatedText\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 1882,\n                          columnNumber: 40\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1868,\n                        columnNumber: 36\n                      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                        style: {\n                          fontSize: \"10px\",\n                          color: \"#64748b\",\n                          marginTop: \"6px\",\n                          textAlign: \"right\"\n                        },\n                        children: isPending ? \"Отправка...\" : formatMessageDate(messageItem.date || selectedMessage.date, messageItem.time || selectedMessage.time)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 1888,\n                        columnNumber: 34\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 1781,\n                      columnNumber: 32\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1577,\n                    columnNumber: 28\n                  }, this)\n                }, messageItem.id || idx, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1568,\n                  columnNumber: 26\n                }, this);\n              })\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1439,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: \"14px 20px\",\n              borderTop: \"1px solid rgba(148,163,184,0.15)\",\n              background: \"rgba(15,23,42,0.6)\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              ref: fileInputRef,\n              type: \"file\",\n              accept: \"image/*\",\n              multiple: true,\n              onChange: handleReplyImageSelect,\n              style: {\n                display: \"none\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1915,\n              columnNumber: 17\n            }, this), replyImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: \"10px\",\n                display: \"flex\",\n                gap: \"8px\",\n                overflowX: \"auto\",\n                paddingBottom: \"2px\"\n              },\n              children: replyImages.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  position: \"relative\",\n                  width: \"72px\",\n                  height: \"72px\",\n                  borderRadius: \"10px\",\n                  border: \"1px solid rgba(148,163,184,0.2)\",\n                  overflow: \"hidden\",\n                  flexShrink: 0\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: item.previewUrl,\n                  alt: \"\",\n                  style: {\n                    width: \"100%\",\n                    height: \"100%\",\n                    objectFit: \"cover\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1945,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => removeReplyImage(item.id),\n                  style: {\n                    position: \"absolute\",\n                    top: \"4px\",\n                    right: \"4px\",\n                    width: \"20px\",\n                    height: \"20px\",\n                    borderRadius: \"9999px\",\n                    border: \"none\",\n                    background: \"rgba(2,6,23,0.72)\",\n                    color: \"#f8fafc\",\n                    fontSize: \"12px\",\n                    cursor: \"pointer\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\"\n                  },\n                  title: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",\n                  children: \"\\xD7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1950,\n                  columnNumber: 25\n                }, this)]\n              }, item.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1933,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1925,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\",\n                gap: \"10px\",\n                alignItems: \"flex-end\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: () => {\n                  var _fileInputRef$current;\n                  return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n                },\n                disabled: sending,\n                \"aria-label\": \"Bilder hochladen\",\n                style: {\n                  width: \"42px\",\n                  height: \"42px\",\n                  borderRadius: \"12px\",\n                  border: \"1px solid rgba(148,163,184,0.25)\",\n                  background: \"rgba(15,23,42,0.7)\",\n                  color: \"#cbd5e1\",\n                  cursor: sending ? \"not-allowed\" : \"pointer\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  flexShrink: 0\n                },\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  viewBox: \"0 0 24 24\",\n                  width: \"18\",\n                  height: \"18\",\n                  fill: \"currentColor\",\n                  \"aria-hidden\": \"true\",\n                  children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M12.0004 8.54376C9.72753 8.54376 7.88501 10.4042 7.88501 12.6991C7.88501 14.994 9.72753 16.8544 12.0004 16.8544C14.2733 16.8544 16.1158 14.994 16.1158 12.6991C16.1158 10.4042 14.2733 8.54376 12.0004 8.54376ZM9.88501 12.6991C9.88501 11.5195 10.8321 10.5632 12.0004 10.5632C13.1687 10.5632 14.1158 11.5195 14.1158 12.6991C14.1158 13.8787 13.1687 14.835 12.0004 14.835C10.8321 14.835 9.88501 13.8787 9.88501 12.6991Z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1999,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                    d: \"M9.23077 4C8.91601 4 8.61962 4.14963 8.43077 4.40388L6.65385 6.79612H4.38462C3.75218 6.79612 3.14564 7.04979 2.69844 7.50134C2.25124 7.95288 2 8.5653 2 9.20388V17.5922C2 18.2308 2.25124 18.8432 2.69844 19.2948C3.14564 19.7463 3.75218 20 4.38462 20H19.6154C20.2478 20 20.8544 19.7463 21.3016 19.2948C21.7488 18.8432 22 18.2308 22 17.5922V9.20388C22 8.5653 21.7488 7.95288 21.3016 7.50134C20.8544 7.04979 20.2478 6.79612 19.6154 6.79612H17.3462L15.5692 4.40388C15.3804 4.14963 15.084 4 14.7692 4H9.23077ZM7.95385 8.41165L9.73077 6.01942H14.2692L16.0462 8.41165C16.235 8.6659 16.5314 8.81553 16.8462 8.81553H19.6154C19.7179 8.81553 19.8163 8.85665 19.8888 8.9292C19.9614 9.00175 20.0025 9.10014 20.0025 9.20263V17.5909C20.0025 17.6934 19.9614 17.7918 19.8888 17.8644C19.8163 17.9369 19.7179 17.978 19.6154 17.978H4.38462C4.28208 17.978 4.1837 17.9369 4.11115 17.8644C4.0386 17.7918 3.99748 17.6934 3.99748 17.5909V9.20263C3.99748 9.10014 4.0386 9.00175 4.11115 8.9292C4.1837 8.85665 4.28208 8.81553 4.38462 8.81553H7.15385C7.4686 8.81553 7.765 8.6659 7.95385 8.41165Z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2000,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1998,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1979,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n                value: replyText,\n                onChange: e => setReplyText(e.target.value),\n                onKeyDown: handleKeyDown,\n                placeholder: \"Nachricht schreiben...\",\n                rows: 1,\n                style: {\n                  flex: 1,\n                  padding: \"10px 14px\",\n                  border: \"1px solid rgba(148,163,184,0.2)\",\n                  borderRadius: \"12px\",\n                  resize: \"none\",\n                  minHeight: \"42px\",\n                  maxHeight: \"120px\",\n                  background: \"rgba(15,23,42,0.6)\",\n                  color: \"#e2e8f0\",\n                  fontSize: \"14px\",\n                  lineHeight: \"1.4\",\n                  outline: \"none\",\n                  fontFamily: \"inherit\"\n                },\n                onInput: e => {\n                  e.target.style.height = \"42px\";\n                  e.target.style.height = Math.min(e.target.scrollHeight, 120) + \"px\";\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2004,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"msg-send-btn\",\n                onClick: sendReply,\n                disabled: !canSendReply,\n                style: {\n                  padding: \"10px 20px\",\n                  background: sending ? \"rgba(34,197,94,0.4)\" : !hasReplyPayload ? \"rgba(148,163,184,0.15)\" : \"linear-gradient(135deg, #22c55e, #16a34a)\",\n                  color: !hasReplyPayload ? \"#64748b\" : \"white\",\n                  border: \"none\",\n                  borderRadius: \"12px\",\n                  cursor: !canSendReply ? \"not-allowed\" : \"pointer\",\n                  whiteSpace: \"nowrap\",\n                  fontSize: \"14px\",\n                  fontWeight: 600,\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  gap: \"6px\",\n                  height: \"42px\",\n                  transition: \"all 0.15s ease\"\n                },\n                children: sending ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                    size: 14,\n                    color: \"#fff\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2058,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0430\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2059,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                    width: \"16\",\n                    height: \"16\",\n                    viewBox: \"0 0 24 24\",\n                    fill: \"none\",\n                    stroke: \"currentColor\",\n                    strokeWidth: \"2.5\",\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    children: [/*#__PURE__*/_jsxDEV(\"line\", {\n                      x1: \"22\",\n                      y1: \"2\",\n                      x2: \"11\",\n                      y2: \"13\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2064,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"polygon\", {\n                      points: \"22 2 15 22 11 13 2 9 22 2\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2065,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2063,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 2067,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2031,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1978,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: \"11px\",\n                color: \"#475569\",\n                marginTop: \"6px\"\n              },\n              children: \"Enter \\u0434\\u043B\\u044F \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438, Shift+Enter \\u0434\\u043B\\u044F \\u043D\\u043E\\u0432\\u043E\\u0439 \\u0441\\u0442\\u0440\\u043E\\u043A\\u0438\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2072,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1910,\n            columnNumber: 15\n          }, this), declineConfirmOpen && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: \"absolute\",\n              inset: 0,\n              background: \"rgba(2,6,23,0.65)\",\n              backdropFilter: \"blur(2px)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              zIndex: 40,\n              padding: \"16px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: \"100%\",\n                maxWidth: \"420px\",\n                borderRadius: \"16px\",\n                border: \"1px solid rgba(148,163,184,0.2)\",\n                background: \"linear-gradient(145deg, rgba(15,23,42,0.96), rgba(2,6,23,0.98))\",\n                boxShadow: \"0 18px 60px rgba(0,0,0,0.5)\",\n                padding: \"18px\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: \"16px\",\n                  fontWeight: 700,\n                  color: \"#f8fafc\",\n                  marginBottom: \"8px\"\n                },\n                children: \"Anfrage ablehnen\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2098,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: \"13px\",\n                  lineHeight: \"1.5\",\n                  color: \"#94a3b8\",\n                  marginBottom: \"16px\"\n                },\n                children: \"M\\xF6chtest du diese Anfrage wirklich ablehnen?\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2101,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"flex\",\n                  gap: \"10px\",\n                  justifyContent: \"flex-end\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => setDeclineConfirmOpen(false),\n                  disabled: decliningOffer,\n                  style: {\n                    padding: \"10px 14px\",\n                    borderRadius: \"10px\",\n                    border: \"1px solid rgba(148,163,184,0.22)\",\n                    background: \"rgba(15,23,42,0.65)\",\n                    color: \"#cbd5e1\",\n                    cursor: decliningOffer ? \"not-allowed\" : \"pointer\"\n                  },\n                  children: \"Abbrechen\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2105,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: confirmDeclineOffer,\n                  disabled: decliningOffer,\n                  style: {\n                    padding: \"10px 14px\",\n                    borderRadius: \"10px\",\n                    border: \"1px solid rgba(239,68,68,0.35)\",\n                    background: \"linear-gradient(135deg, rgba(239,68,68,0.78), rgba(185,28,28,0.82))\",\n                    color: \"#fff\",\n                    fontWeight: 700,\n                    cursor: decliningOffer ? \"not-allowed\" : \"pointer\",\n                    display: \"inline-flex\",\n                    alignItems: \"center\",\n                    gap: \"6px\",\n                    minWidth: \"158px\",\n                    justifyContent: \"center\"\n                  },\n                  children: decliningOffer ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                    children: [/*#__PURE__*/_jsxDEV(Spinner, {\n                      size: 14,\n                      color: \"#fff\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2141,\n                      columnNumber: 29\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"Bitte warten\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 2142,\n                      columnNumber: 29\n                    }, this)]\n                  }, void 0, true) : \"Anfrage ablehnen\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 2120,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 2104,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 2089,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 2078,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) :\n        /*#__PURE__*/\n        // Empty state\n        _jsxDEV(\"div\", {\n          style: {\n            flex: 1,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            color: \"#475569\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: \"center\",\n              maxWidth: \"280px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"64\",\n              height: \"64\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              strokeWidth: \"1\",\n              style: {\n                margin: \"0 auto 16px\",\n                display: \"block\",\n                color: \"#334155\"\n              },\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 2164,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2163,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                margin: \"0 0 8px\",\n                fontSize: \"16px\",\n                color: \"#64748b\"\n              },\n              children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2166,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              style: {\n                margin: 0,\n                fontSize: \"13px\",\n                lineHeight: \"1.5\"\n              },\n              children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433 \\u0438\\u0437 \\u0441\\u043F\\u0438\\u0441\\u043A\\u0430 \\u0441\\u043B\\u0435\\u0432\\u0430 \\u0434\\u043B\\u044F \\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0430 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0438 \\u043E\\u0442\\u0432\\u0435\\u0442\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 2169,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 2162,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 2155,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1309,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 941,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(MessagesTab, \"Dc5Yo6+Tq5uRu92B7QXIW4KBCnM=\");\n_c = MessagesTab;\nexport default MessagesTab;\nvar _c;\n$RefreshReg$(_c, \"MessagesTab\");","map":{"version":3,"names":["React","useState","useEffect","useRef","apiFetchJson","getAccessToken","MessageIcon","jsxDEV","_jsxDEV","Fragment","_Fragment","SEEN_STORAGE_KEY","THREAD_CACHE_TTL_MS","detectMobileView","_window$screen","window","viewportWidth","innerWidth","document","documentElement","clientWidth","screenWidth","screen","width","effectiveWidth","Math","min","mobileUa","test","navigator","userAgent","hasCoarsePointer","matchMedia","matches","noHover","touchPoints","Number","maxTouchPoints","touchLikeDevice","normalizePreviewImageUrl","value","raw","String","trim","normalizeRuleForKleinanzeigen","parsed","host","hostname","toLowerCase","isProdAdsImage","pathname","startsWith","ruleParam","searchParams","get","malformedRule","validRule","set","URL","href","toMessageImageSrc","accountId","normalized","accountToken","undefined","accessToken","src","separator","includes","encodeURIComponent","params","URLSearchParams","toString","getRawMessagePreviewImage","message","_message$ad","_message$ad2","_message$ad3","candidates","adImage","adImageUrl","adImageURL","imageUrl","image","thumbnailUrl","thumbnail","previewImage","ad","candidate","getMessagePreviewImage","hasMessagePreviewImage","Boolean","isPaymentAndShippingMessage","type","toUpperCase","paymentAndShippingMessageType","formatEuroFromCents","cents","isFinite","toLocaleString","style","currency","pickOfferField","key","direct","actions","Array","isArray","withKey","find","action","getOfferActionText","actionType","fallback","item","ctaText","extractAttachmentUrls","attachments","urls","push","url","filter","getConversationKey","convo","conversationId","conversationUrl","id","convoId","getConversationFingerprint","date","time","text","loadSeenMap","localStorage","getItem","JSON","parse","saveSeenMap","next","setItem","stringify","MessagesTab","_s","_selectedMessage$mess","messages","setMessages","selectedMessage","setSelectedMessage","replyText","setReplyText","replyImages","setReplyImages","sending","setSending","loading","setLoading","loadingThread","setLoadingThread","error","setError","isMobileView","setIsMobileView","translationByMessageId","setTranslationByMessageId","declineConfirmOpen","setDeclineConfirmOpen","decliningOffer","setDecliningOffer","chatScrollRef","fileInputRef","previewHydrationInFlight","Set","messagesRefreshInFlight","translateInFlight","threadCacheRef","Map","clearComposerImages","prev","existing","forEach","previewUrl","revokeObjectURL","getThreadCacheKeyForMessage","readThreadCacheEntry","entry","current","expiresAt","Date","now","delete","writeThreadCacheEntry","payload","adTitle","sender","loadMessages","intervalId","setInterval","visibilityState","silent","clearInterval","container","scrollTo","top","scrollHeight","behavior","handleResize","addEventListener","removeEventListener","hydrateMissingPreviewImages","list","length","slice","has","add","data","map","msg","sameConversation","console","rememberConversationSeen","fingerprint","seen","seenAt","msgKey","unread","opts","deduped","seenMap","merged","currentFingerprint","err","markAsRead","handleReplyImageSelect","event","_event$target","files","from","target","nextItems","file","random","createObjectURL","removeReplyImage","formatRequestError","fallbackText","_error$data","_error$data2","baseMessage","debugId","requestId","confirmDeclineOffer","alert","result","method","timeoutMs","headers","body","serverMessages","lastMessage","nextConversationId","nextConversationUrl","fetchThread","force","status","code","sendReply","textToSend","imagesToSend","optimisticId","getTime","optimisticAttachments","_item$file","_item$file2","name","local","previewText","optimisticMessage","toISOString","toTimeString","direction","pending","form","FormData","append","participant","success","resolvedConversationId","resolvedConversationUrl","hasSameOutgoing","some","m","nextMessages","updated","getTimeAgo","messageDate","isNaN","diffHours","floor","formatMessageDate","parts","d","diffDays","toLocaleDateString","day","month","join","threadMessages","cached","cachedPayload","updatedFromCache","handleKeyDown","e","shiftKey","preventDefault","unreadCount","showConversationList","showChatPanel","selectedRawPreviewImage","selectedPreviewImage","selectedDirectPreviewImage","hasReplyPayload","canSendReply","Spinner","size","color","height","viewBox","animation","children","cx","cy","r","stroke","strokeWidth","fill","strokeDasharray","strokeDashoffset","strokeLinecap","fileName","_jsxFileName","lineNumber","columnNumber","className","display","alignItems","justifyContent","gap","marginBottom","flexWrap","margin","fontWeight","borderRadius","background","border","boxShadow","minHeight","minWidth","overflow","flexDirection","backdropFilter","padding","borderBottom","fontSize","onClick","disabled","cursor","transition","strokeLinejoin","points","marginTop","flex","i","flexShrink","animationDelay","textAlign","opacity","rawPreviewImage","directPreviewImage","borderLeft","alt","objectFit","referrerPolicy","onError","_imageNode$dataset","_imageNode$dataset2","imageNode","currentTarget","directSrc","dataset","fallbackTried","currentSrc","getAttribute","setAttribute","fallbackNode","nextElementSibling","charAt","textOverflow","whiteSpace","maxWidth","accountName","textTransform","letterSpacing","borderTop","position","_imageNode$dataset3","_imageNode$dataset4","x","y","rx","ry","x1","y1","x2","y2","ref","paddingTop","messageItem","idx","isOutgoing","isPending","isOffer","messageKey","translation","hasText","attachmentSrcs","canTranslate","toggleTranslate","shown","translatedText","to","offerTitle","title","offerItemCents","offerShippingCents","offerTotalCents","offerCarrierName","offerOptionName","offerOptionDesc","offerLiabilityCents","acceptCta","declineCta","counterCta","paddingLeft","paddingRight","lineHeight","gridTemplateColumns","imageIdx","maxHeight","wordBreak","left","bottom","accept","multiple","onChange","overflowX","paddingBottom","right","_fileInputRef$current","click","onKeyDown","placeholder","rows","resize","outline","fontFamily","onInput","inset","zIndex","_c","$RefreshReg$"],"sources":["/Users/eurocare/Downloads/barvihaluxury-main/frontend/src/components/MessagesTab.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { apiFetchJson, getAccessToken } from \"../api\";\nimport { MessageIcon } from \"./Icons\";\n\nconst SEEN_STORAGE_KEY = \"kl_messages_seen_v1\";\nconst THREAD_CACHE_TTL_MS = 2 * 60 * 1000;\n\nconst detectMobileView = () => {\n  if (typeof window === \"undefined\") return false;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth || 0;\n  const screenWidth = typeof window.screen?.width === \"number\" ? window.screen.width : viewportWidth;\n  const effectiveWidth = Math.min(viewportWidth || screenWidth, screenWidth || viewportWidth);\n  const mobileUa = /Android|webOS|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(\n    (typeof navigator !== \"undefined\" && navigator.userAgent) || \"\"\n  );\n  const hasCoarsePointer = typeof window.matchMedia === \"function\"\n    ? window.matchMedia(\"(pointer: coarse)\").matches\n    : false;\n  const noHover = typeof window.matchMedia === \"function\"\n    ? window.matchMedia(\"(hover: none)\").matches\n    : false;\n  const touchPoints = typeof navigator !== \"undefined\" ? Number(navigator.maxTouchPoints || 0) : 0;\n  const touchLikeDevice = hasCoarsePointer || noHover || touchPoints > 1;\n  return effectiveWidth <= 768 || (touchLikeDevice && effectiveWidth <= 1024) || (mobileUa && effectiveWidth <= 1180);\n};\n\nconst normalizePreviewImageUrl = (value) => {\n  const raw = String(value || \"\").trim();\n  if (!raw) return \"\";\n  if (/^data:/i.test(raw)) return \"\";\n  const normalizeRuleForKleinanzeigen = (parsed) => {\n    const host = String(parsed.hostname || \"\").toLowerCase();\n    const isProdAdsImage = host === \"img.kleinanzeigen.de\"\n      && parsed.pathname.startsWith(\"/api/v1/prod-ads/images/\");\n    if (!isProdAdsImage) return parsed;\n    const ruleParam = String(parsed.searchParams.get(\"rule\") || \"\");\n    const malformedRule = /(imageid|\\$\\{.*\\}|\\$_\\{.*\\})/i.test(ruleParam);\n    const validRule = /^\\$_[a-z0-9_.-]+$/i.test(ruleParam);\n    if (!validRule || malformedRule) {\n      parsed.searchParams.set(\"rule\", \"$_57.JPG\");\n    }\n    return parsed;\n  };\n  if (/^(https?:)?\\/\\//i.test(raw)) {\n    try {\n      const parsed = normalizeRuleForKleinanzeigen(new URL(raw.startsWith(\"//\") ? `https:${raw}` : raw));\n      return parsed.href;\n    } catch {\n      return raw.startsWith(\"//\") ? `https:${raw}` : raw;\n    }\n  }\n  if (/^img\\.kleinanzeigen\\.de/i.test(raw)) return normalizePreviewImageUrl(`https://${raw}`);\n  if (/^\\/api\\/v1\\/prod-ads\\/images\\//i.test(raw)) return normalizePreviewImageUrl(`https://img.kleinanzeigen.de${raw}`);\n  try {\n    const parsed = normalizeRuleForKleinanzeigen(new URL(raw, \"https://www.kleinanzeigen.de\"));\n    return parsed.href;\n  } catch {\n    return \"\";\n  }\n};\n\nconst toMessageImageSrc = (value, accountId) => {\n  const normalized = normalizePreviewImageUrl(value);\n  if (!normalized) return \"\";\n  const accountToken = accountId !== undefined && accountId !== null && String(accountId).trim()\n    ? String(accountId).trim()\n    : \"\";\n  const accessToken = getAccessToken();\n  if (normalized.startsWith(\"/api/messages/image?\")) {\n    let src = normalized;\n    if (accountToken && !/[?&]accountId=/i.test(src)) {\n      const separator = src.includes(\"?\") ? \"&\" : \"?\";\n      src = `${src}${separator}accountId=${encodeURIComponent(accountToken)}`;\n    }\n    if (accessToken && !/[?&](accessToken|token)=/i.test(src)) {\n      const separator = src.includes(\"?\") ? \"&\" : \"?\";\n      src = `${src}${separator}accessToken=${encodeURIComponent(accessToken)}`;\n    }\n    return src;\n  }\n  if (/^https?:\\/\\//i.test(normalized)) {\n    if (!accountToken) return normalized;\n    const params = new URLSearchParams();\n    params.set(\"url\", normalized);\n    params.set(\"accountId\", accountToken);\n    if (accessToken) {\n      params.set(\"accessToken\", accessToken);\n    }\n    return `/api/messages/image?${params.toString()}`;\n  }\n  return normalized;\n};\n\nconst getRawMessagePreviewImage = (message) => {\n  if (!message || typeof message !== \"object\") return \"\";\n  const candidates = [\n    message.adImage,\n    message.adImageUrl,\n    message.adImageURL,\n    message.imageUrl,\n    message.image,\n    message.thumbnailUrl,\n    message.thumbnail,\n    message.previewImage,\n    message.ad?.image,\n    message.ad?.imageUrl,\n    message.ad?.thumbnailUrl\n  ];\n  for (const candidate of candidates) {\n    const normalized = normalizePreviewImageUrl(candidate);\n    if (normalized) return normalized;\n  }\n  return \"\";\n};\n\nconst getMessagePreviewImage = (message) =>\n  toMessageImageSrc(getRawMessagePreviewImage(message), message?.accountId);\n\nconst hasMessagePreviewImage = (message) => Boolean(getRawMessagePreviewImage(message));\n\nconst isPaymentAndShippingMessage = (message) => {\n  if (!message || typeof message !== \"object\") return false;\n  const type = String(message.type || \"\").toUpperCase();\n  return type === \"PAYMENT_AND_SHIPPING_MESSAGE\" || Boolean(message.paymentAndShippingMessageType);\n};\n\nconst formatEuroFromCents = (value) => {\n  const cents = Number(value);\n  if (!Number.isFinite(cents)) return \"\";\n  return (cents / 100).toLocaleString(\"de-DE\", { style: \"currency\", currency: \"EUR\" });\n};\n\nconst pickOfferField = (message, key) => {\n  if (!message || typeof message !== \"object\") return null;\n  const direct = message[key];\n  if (direct !== undefined && direct !== null) return direct;\n  const actions = Array.isArray(message.actions) ? message.actions : [];\n  const withKey = actions.find((action) => action && action[key] !== undefined && action[key] !== null);\n  return withKey ? withKey[key] : null;\n};\n\nconst getOfferActionText = (message, actionType, fallback = \"\") => {\n  const actions = Array.isArray(message?.actions) ? message.actions : [];\n  const action = actions.find((item) => item?.actionType === actionType);\n  return action?.ctaText || fallback;\n};\n\nconst extractAttachmentUrls = (message) => {\n  const attachments = Array.isArray(message?.attachments) ? message.attachments : [];\n  const urls = [];\n  for (const item of attachments) {\n    if (!item) continue;\n    if (typeof item === \"string\") {\n      urls.push(item);\n      continue;\n    }\n    if (typeof item === \"object\") {\n      const candidate = item.url || item.href || item.src || item.imageUrl || item.thumbnailUrl;\n      if (candidate) urls.push(candidate);\n    }\n  }\n  return urls.filter(Boolean);\n};\n\nconst getConversationKey = (message) => {\n  if (!message || typeof message !== \"object\") return \"\";\n  const accountId = message.accountId != null ? String(message.accountId) : \"\";\n  const convo = message.conversationId || message.conversationUrl || message.id || \"\";\n  const convoId = convo != null ? String(convo) : \"\";\n  if (!accountId || !convoId) return \"\";\n  return `${accountId}|${convoId}`;\n};\n\nconst getConversationFingerprint = (message) => {\n  if (!message || typeof message !== \"object\") return \"\";\n  const date = String(message.date || \"\").trim();\n  const time = String(message.time || \"\").trim();\n  const text = String(message.message || \"\").trim();\n  return `${date}|${time}|${text}`;\n};\n\nconst loadSeenMap = () => {\n  if (typeof window === \"undefined\" || !window.localStorage) return {};\n  try {\n    const raw = window.localStorage.getItem(SEEN_STORAGE_KEY);\n    if (!raw) return {};\n    const parsed = JSON.parse(raw);\n    return parsed && typeof parsed === \"object\" ? parsed : {};\n  } catch {\n    return {};\n  }\n};\n\nconst saveSeenMap = (next) => {\n  if (typeof window === \"undefined\" || !window.localStorage) return;\n  try {\n    window.localStorage.setItem(SEEN_STORAGE_KEY, JSON.stringify(next || {}));\n  } catch {\n    // ignore quota / serialization issues\n  }\n};\n\nconst MessagesTab = () => {\n  const [messages, setMessages] = useState([]);\n  const [selectedMessage, setSelectedMessage] = useState(null);\n  const [replyText, setReplyText] = useState(\"\");\n  const [replyImages, setReplyImages] = useState([]);\n  const [sending, setSending] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [loadingThread, setLoadingThread] = useState(false);\n  const [error, setError] = useState(null);\n  const [isMobileView, setIsMobileView] = useState(() => detectMobileView());\n  const [translationByMessageId, setTranslationByMessageId] = useState({});\n  const [declineConfirmOpen, setDeclineConfirmOpen] = useState(false);\n  const [decliningOffer, setDecliningOffer] = useState(false);\n  const chatScrollRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const previewHydrationInFlight = useRef(new Set());\n  const messagesRefreshInFlight = useRef(false);\n  const translateInFlight = useRef(new Set());\n  const threadCacheRef = useRef(new Map());\n\n  const clearComposerImages = () => {\n    setReplyImages((prev) => {\n      const existing = Array.isArray(prev) ? prev : [];\n      existing.forEach((item) => {\n        if (item?.previewUrl) {\n          URL.revokeObjectURL(item.previewUrl);\n        }\n      });\n      return [];\n    });\n  };\n\n  const getThreadCacheKeyForMessage = (message) => {\n    if (!message || typeof message !== \"object\") return \"\";\n    const accountId = message.accountId != null ? String(message.accountId) : \"\";\n    const conversationId = message.conversationId != null ? String(message.conversationId) : \"\";\n    const conversationUrl = message.conversationUrl != null ? String(message.conversationUrl) : \"\";\n    if (!accountId) return \"\";\n    if (conversationId) return `${accountId}|cid:${conversationId}`;\n    if (conversationUrl) return `${accountId}|url:${conversationUrl}`;\n    return \"\";\n  };\n\n  const readThreadCacheEntry = (message) => {\n    const key = getThreadCacheKeyForMessage(message);\n    if (!key) return null;\n    const entry = threadCacheRef.current.get(key);\n    if (!entry || typeof entry !== \"object\") return null;\n    if (!entry.expiresAt || entry.expiresAt < Date.now()) {\n      threadCacheRef.current.delete(key);\n      return null;\n    }\n    return entry;\n  };\n\n  const writeThreadCacheEntry = (message, payload) => {\n    const key = getThreadCacheKeyForMessage(message);\n    if (!key || !payload || typeof payload !== \"object\") return;\n    threadCacheRef.current.set(key, {\n      expiresAt: Date.now() + THREAD_CACHE_TTL_MS,\n      payload: {\n        adTitle: payload.adTitle || \"\",\n        adImage: payload.adImage || \"\",\n        sender: payload.sender || \"\",\n        messages: Array.isArray(payload.messages) ? payload.messages : [],\n        conversationId: payload.conversationId || message?.conversationId || \"\",\n        conversationUrl: payload.conversationUrl || message?.conversationUrl || \"\"\n      }\n    });\n  };\n\n  useEffect(() => {\n    loadMessages();\n  }, []);\n\n  useEffect(() => {\n    const intervalId = window.setInterval(() => {\n      // Avoid background polling when the tab is hidden (mobile data / lower load).\n      if (typeof document !== \"undefined\" && document.visibilityState !== \"visible\") return;\n      loadMessages({ silent: true });\n    }, 3 * 60 * 1000);\n\n    return () => window.clearInterval(intervalId);\n  }, []);\n\n  useEffect(() => {\n    if (!selectedMessage) return;\n    const container = chatScrollRef.current;\n    if (!container) return;\n    container.scrollTo({ top: container.scrollHeight, behavior: \"smooth\" });\n  }, [selectedMessage?.id, selectedMessage?.messages]);\n\n  useEffect(() => {\n    // Reset composer state when switching conversations.\n    setReplyText(\"\");\n    clearComposerImages();\n    setDeclineConfirmOpen(false);\n    setDecliningOffer(false);\n  }, [selectedMessage?.id]);\n\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobileView(detectMobileView());\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  const hydrateMissingPreviewImages = async (list) => {\n    if (!Array.isArray(list) || !list.length) return;\n\n    const candidates = list\n      .filter((item) => item && !hasMessagePreviewImage(item))\n      .slice(0, 10);\n\n    for (const item of candidates) {\n      const key = String(item.conversationId || item.conversationUrl || item.id || \"\");\n      if (!key || previewHydrationInFlight.current.has(key)) continue;\n      previewHydrationInFlight.current.add(key);\n\n      try {\n        const params = new URLSearchParams();\n        if (item.accountId != null) params.set(\"accountId\", String(item.accountId));\n        if (item.conversationId) params.set(\"conversationId\", String(item.conversationId));\n        if (item.conversationUrl) params.set(\"conversationUrl\", String(item.conversationUrl));\n        if (!item.conversationId && !item.conversationUrl) {\n          if (item.sender) params.set(\"participant\", String(item.sender));\n          if (item.adTitle) params.set(\"adTitle\", String(item.adTitle));\n        }\n        if (!params.get(\"accountId\")) continue;\n\n        const data = await apiFetchJson(`/api/messages/thread?${params.toString()}`);\n        const adImage = normalizePreviewImageUrl(data?.adImage);\n        if (!adImage) continue;\n\n        setMessages((prev) => prev.map((msg) => {\n          const sameConversation = (\n            (item.conversationId && msg.conversationId && String(item.conversationId) === String(msg.conversationId))\n            || (item.conversationUrl && msg.conversationUrl && String(item.conversationUrl) === String(msg.conversationUrl))\n            || String(msg.id) === String(item.id)\n          );\n          if (!sameConversation) return msg;\n          return {\n            ...msg,\n            adImage,\n            adTitle: data?.adTitle || msg.adTitle,\n            conversationId: data?.conversationId || msg.conversationId,\n            conversationUrl: data?.conversationUrl || msg.conversationUrl\n          };\n        }));\n      } catch (error) {\n        console.error(\"Не удалось догрузить превью диалога:\", error);\n      } finally {\n        previewHydrationInFlight.current.delete(key);\n      }\n    }\n  };\n\n  const rememberConversationSeen = (message) => {\n    const key = getConversationKey(message);\n    if (!key) return;\n    const fingerprint = getConversationFingerprint(message);\n    if (!fingerprint) return;\n\n    const seen = loadSeenMap();\n    seen[key] = { fingerprint, seenAt: Date.now() };\n    saveSeenMap(seen);\n\n    // Immediately update UI so the badge doesn't come back on refresh.\n    setMessages((prev) => prev.map((msg) => {\n      const msgKey = getConversationKey(msg);\n      if (!msgKey || msgKey !== key) return msg;\n      return { ...msg, unread: false };\n    }));\n  };\n\n  const loadMessages = async (opts = {}) => {\n    const silent = Boolean(opts && typeof opts === \"object\" && opts.silent);\n    if (messagesRefreshInFlight.current) return;\n    messagesRefreshInFlight.current = true;\n\n    if (!silent) {\n      setLoading(true);\n      setError(null);\n    }\n    try {\n      const data = await apiFetchJson(\"/api/messages\");\n      const list = Array.isArray(data) ? data : [];\n      const seen = new Set();\n      const deduped = [];\n      for (const item of list) {\n        const key = item.conversationId\n          || item.conversationUrl\n          || item.id\n          || `${item.accountId || \"\"}|${item.sender || \"\"}|${item.adTitle || \"\"}|${item.message || \"\"}|${item.time || \"\"}`;\n        if (seen.has(key)) continue;\n        seen.add(key);\n        deduped.push(item);\n      }\n      const seenMap = loadSeenMap();\n      const merged = deduped.map((item) => {\n        const key = getConversationKey(item);\n        if (!key) return item;\n        const entry = seenMap[key];\n        if (!entry || typeof entry !== \"object\") return item;\n        const currentFingerprint = getConversationFingerprint(item);\n        if (entry.fingerprint && entry.fingerprint === currentFingerprint) {\n          return { ...item, unread: false };\n        }\n        return item;\n      });\n\n      setMessages(merged);\n      hydrateMissingPreviewImages(merged);\n    } catch (err) {\n      console.error(\"Ошибка загрузки сообщений:\", err);\n      if (!silent) setError(err.message || \"Не удалось загрузить сообщения\");\n    } finally {\n      if (!silent) setLoading(false);\n      messagesRefreshInFlight.current = false;\n    }\n  };\n\n  // NOTE: Backend does not guarantee a \"mark read\" API (and Kleinanzeigen state may lag).\n  // We persist \"seen\" locally so a refresh won't resurrect the \"new\" badge.\n  const markAsRead = (message) => rememberConversationSeen(message);\n\n  const handleReplyImageSelect = (event) => {\n    const files = Array.from(event?.target?.files || []);\n    if (event?.target) event.target.value = \"\";\n    if (!files.length) return;\n\n    const nextItems = files\n      .filter((file) => String(file?.type || \"\").toLowerCase().startsWith(\"image/\"))\n      .slice(0, 10)\n      .map((file) => ({\n        id: `img-${Date.now()}-${Math.random().toString(16).slice(2)}`,\n        file,\n        previewUrl: URL.createObjectURL(file)\n      }));\n\n    if (!nextItems.length) return;\n    setReplyImages((prev) => {\n      const existing = Array.isArray(prev) ? prev : [];\n      return [...existing, ...nextItems].slice(0, 10);\n    });\n  };\n\n  const removeReplyImage = (id) => {\n    setReplyImages((prev) => {\n      const existing = Array.isArray(prev) ? prev : [];\n      const target = existing.find((item) => item?.id === id);\n      if (target?.previewUrl) {\n        URL.revokeObjectURL(target.previewUrl);\n      }\n      return existing.filter((item) => item?.id !== id);\n    });\n  };\n\n  const formatRequestError = (error, fallbackText) => {\n    const baseMessage = String(error?.message || fallbackText || \"Ошибка запроса\").trim();\n    const debugId = error?.data?.debugId || error?.debugId || \"\";\n    const requestId = error?.data?.requestId || error?.requestId || \"\";\n    if (debugId) {\n      return `${baseMessage} (debugId: ${debugId})`;\n    }\n    if (requestId) {\n      return `${baseMessage} (requestId: ${requestId})`;\n    }\n    return baseMessage;\n  };\n\n  const confirmDeclineOffer = async () => {\n    if (!selectedMessage || decliningOffer) return;\n    if (!selectedMessage.conversationId && !selectedMessage.conversationUrl) {\n      alert(\"Не найден идентификатор диалога.\");\n      return;\n    }\n    setDecliningOffer(true);\n    try {\n      const result = await apiFetchJson(\"/api/messages/offer/decline\", {\n        method: \"POST\",\n        timeoutMs: 240000,\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          accountId: selectedMessage.accountId,\n          conversationId: selectedMessage.conversationId,\n          conversationUrl: selectedMessage.conversationUrl\n        })\n      });\n\n      const serverMessages = Array.isArray(result.messages) ? result.messages : [];\n      if (serverMessages.length) {\n        const lastMessage = serverMessages[serverMessages.length - 1];\n        const nextConversationId = result.conversationId || selectedMessage.conversationId;\n        const nextConversationUrl = result.conversationUrl || selectedMessage.conversationUrl;\n        setMessages((prev) => prev.map((msg) => (\n          msg.id === selectedMessage.id\n            ? {\n              ...msg,\n              message: lastMessage?.text || msg.message,\n              date: lastMessage?.date || msg.date,\n              time: lastMessage?.time || msg.time,\n              conversationId: nextConversationId || msg.conversationId,\n              conversationUrl: nextConversationUrl || msg.conversationUrl,\n              unread: false\n            }\n            : msg\n        )));\n        setSelectedMessage((prev) => ({\n          ...prev,\n          messages: serverMessages,\n          conversationId: nextConversationId || prev.conversationId,\n          conversationUrl: nextConversationUrl || prev.conversationUrl\n        }));\n        writeThreadCacheEntry(selectedMessage, {\n          adTitle: selectedMessage.adTitle,\n          adImage: selectedMessage.adImage,\n          sender: selectedMessage.sender,\n          messages: serverMessages,\n          conversationId: nextConversationId,\n          conversationUrl: nextConversationUrl\n        });\n      } else {\n        // Fallback: refresh thread when backend doesn't return messages.\n        fetchThread(selectedMessage, { force: true });\n      }\n      setDeclineConfirmOpen(false);\n    } catch (error) {\n      console.error(\"Ошибка отклонения заявки:\", error, {\n        status: error?.status,\n        code: error?.code,\n        data: error?.data || null\n      });\n      alert(formatRequestError(error, \"Не удалось отклонить заявку\"));\n    } finally {\n      setDecliningOffer(false);\n    }\n  };\n\n  const sendReply = async () => {\n    if (!selectedMessage) return;\n    if (!selectedMessage.conversationId && !selectedMessage.conversationUrl\n      && !selectedMessage.sender && !selectedMessage.adTitle) {\n      alert(\"Не найден идентификатор диалога.\");\n      return;\n    }\n\n    const textToSend = replyText.trim();\n    const imagesToSend = Array.isArray(replyImages) ? replyImages : [];\n    if (imagesToSend.length && !selectedMessage.conversationId && !selectedMessage.conversationUrl) {\n      alert(\"Для отправки фото нужен conversationId диалога. Откройте диалог и попробуйте снова.\");\n      return;\n    }\n    if (!textToSend && imagesToSend.length === 0) return;\n    const now = new Date();\n    const optimisticId = `local-${now.getTime()}-${Math.random().toString(16).slice(2)}`;\n    const optimisticAttachments = imagesToSend.map((item) => ({\n      url: item?.previewUrl || \"\",\n      name: item?.file?.name || \"\",\n      type: item?.file?.type || \"\",\n      local: true\n    })).filter((item) => item?.url);\n    const previewText = textToSend || (optimisticAttachments.length ? \"Фото\" : \"\");\n    const optimisticMessage = {\n      id: optimisticId,\n      text: textToSend,\n      date: now.toISOString().slice(0, 10),\n      time: now.toTimeString().slice(0, 5),\n      direction: \"outgoing\",\n      sender: \"Вы\",\n      pending: true,\n      ...(optimisticAttachments.length ? { attachments: optimisticAttachments } : {})\n    };\n\n    // Optimistic UI: show message immediately in the thread and conversation list.\n    setReplyText(\"\");\n    setReplyImages([]);\n    setSelectedMessage((prev) => {\n      if (!prev) return prev;\n      const existing = Array.isArray(prev.messages) && prev.messages.length\n        ? prev.messages\n        : prev.message\n          ? [{\n            id: prev.id,\n            text: prev.message,\n            sender: prev.sender,\n            date: prev.date,\n            time: prev.time,\n            direction: \"incoming\"\n          }]\n          : [];\n      return {\n        ...prev,\n        messages: [...existing, optimisticMessage]\n      };\n    });\n    setMessages((prev) => prev.map((msg) => (\n      msg.id === selectedMessage.id\n        ? {\n          ...msg,\n          message: previewText,\n          date: optimisticMessage.date,\n          time: optimisticMessage.time,\n          unread: false\n        }\n        : msg\n    )));\n\n    setSending(true);\n    try {\n      const result = optimisticAttachments.length\n        ? await (() => {\n          const form = new FormData();\n          form.append(\"accountId\", String(selectedMessage.accountId));\n          if (selectedMessage.conversationId) form.append(\"conversationId\", String(selectedMessage.conversationId));\n          if (selectedMessage.conversationUrl) form.append(\"conversationUrl\", String(selectedMessage.conversationUrl));\n          if (textToSend) form.append(\"text\", textToSend);\n          imagesToSend.forEach((item) => {\n            if (!item?.file) return;\n            form.append(\"images\", item.file, item.file.name || \"image.jpg\");\n          });\n          return apiFetchJson(\"/api/messages/send-media\", {\n            method: \"POST\",\n            timeoutMs: 240000,\n            body: form\n          });\n        })()\n        : await apiFetchJson(\"/api/messages/send\", {\n          method: \"POST\",\n          timeoutMs: 180000,\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            accountId: selectedMessage.accountId,\n            conversationId: selectedMessage.conversationId,\n            conversationUrl: selectedMessage.conversationUrl,\n            participant: selectedMessage.sender,\n            adTitle: selectedMessage.adTitle,\n            text: textToSend\n          })\n        });\n      if (result.success) {\n        const resolvedConversationId = result.conversationId || selectedMessage.conversationId;\n        const resolvedConversationUrl = result.conversationUrl || selectedMessage.conversationUrl;\n        const serverMessages = Array.isArray(result.messages) ? result.messages : [];\n        const hasSameOutgoing = optimisticAttachments.length\n          ? serverMessages.some((m) => (\n            String(m?.direction || \"\").toLowerCase() === \"outgoing\"\n            && (\n              (Array.isArray(m?.attachments) && m.attachments.length > 0)\n              || (textToSend && String(m?.text || \"\") === textToSend)\n            )\n          ))\n          : serverMessages.some((m) => (\n            String(m?.direction || \"\").toLowerCase() === \"outgoing\"\n            && String(m?.text || \"\") === textToSend\n          ));\n        const nextMessages = serverMessages.length\n          ? (hasSameOutgoing ? serverMessages : [...serverMessages, { ...optimisticMessage, pending: false }])\n          : null;\n\n        if (nextMessages) {\n          const lastMessage = nextMessages[nextMessages.length - 1];\n          setMessages((prev) => prev.map((msg) => (\n            msg.id === selectedMessage.id\n              ? {\n                ...msg,\n                message: lastMessage?.text || msg.message,\n                date: lastMessage?.date || msg.date,\n                time: lastMessage?.time || msg.time,\n                conversationId: resolvedConversationId || msg.conversationId,\n                conversationUrl: resolvedConversationUrl || msg.conversationUrl\n              }\n              : msg\n          )));\n          setSelectedMessage((prev) => ({\n            ...prev,\n            messages: nextMessages,\n            conversationId: resolvedConversationId,\n            conversationUrl: resolvedConversationUrl\n          }));\n          writeThreadCacheEntry(selectedMessage, {\n            adTitle: selectedMessage.adTitle,\n            adImage: selectedMessage.adImage,\n            sender: selectedMessage.sender,\n            messages: nextMessages,\n            conversationId: resolvedConversationId,\n            conversationUrl: resolvedConversationUrl\n          });\n        } else {\n          // Backend may respond without thread messages. Keep optimistic entry and mark it as sent.\n          setSelectedMessage((prev) => {\n            if (!prev) return prev;\n            const updated = Array.isArray(prev.messages) ? prev.messages : [];\n            return {\n              ...prev,\n              messages: updated.map((m) => (m?.id === optimisticId ? { ...m, pending: false } : m)),\n              conversationId: resolvedConversationId,\n              conversationUrl: resolvedConversationUrl\n            };\n          });\n          setMessages((prev) => prev.map((msg) => (\n            msg.id === selectedMessage.id\n              ? {\n                ...msg,\n                conversationId: resolvedConversationId || msg.conversationId,\n                conversationUrl: resolvedConversationUrl || msg.conversationUrl\n              }\n              : msg\n          )));\n        }\n      } else {\n        // Revert optimistic update on logical failure.\n        setSelectedMessage((prev) => {\n          if (!prev) return prev;\n          const updated = Array.isArray(prev.messages) ? prev.messages : [];\n          return { ...prev, messages: updated.filter((m) => m?.id !== optimisticId) };\n        });\n        setReplyText(textToSend);\n        setReplyImages(imagesToSend);\n        const debugId = result?.debugId ? ` (debugId: ${result.debugId})` : \"\";\n        alert(\"Ошибка: \" + (result.error || \"Не удалось отправить\") + debugId);\n      }\n    } catch (err) {\n      console.error(\"Ошибка отправки:\", err, {\n        status: err?.status,\n        code: err?.code,\n        data: err?.data || null\n      });\n      setSelectedMessage((prev) => {\n        if (!prev) return prev;\n        const updated = Array.isArray(prev.messages) ? prev.messages : [];\n        return { ...prev, messages: updated.filter((m) => m?.id !== optimisticId) };\n      });\n      setReplyText(textToSend);\n      setReplyImages(imagesToSend);\n      alert(formatRequestError(err, \"Ошибка при отправке сообщения\"));\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const getTimeAgo = (date, time) => {\n    if (!date && !time) return \"\";\n    const now = new Date();\n    try {\n      const messageDate = new Date(date + \"T\" + (time || \"00:00\"));\n      if (isNaN(messageDate.getTime())) return time || date || \"\";\n      const diffHours = Math.floor((now - messageDate) / (1000 * 60 * 60));\n      if (diffHours < 1) return time || \"Только что\";\n      if (diffHours < 24) return time;\n      if (diffHours < 48) return \"Вчера\";\n      return date;\n    } catch {\n      return time || date || \"\";\n    }\n  };\n\n  const formatMessageDate = (date, time) => {\n    if (!date && !time) return \"\";\n    const parts = [];\n    if (date) {\n      try {\n        const d = new Date(date + \"T00:00\");\n        if (!isNaN(d.getTime())) {\n          const now = new Date();\n          const diffDays = Math.floor((now - d) / (1000 * 60 * 60 * 24));\n          if (diffDays === 0) parts.push(\"Сегодня\");\n          else if (diffDays === 1) parts.push(\"Вчера\");\n          else parts.push(d.toLocaleDateString(\"ru-RU\", { day: \"numeric\", month: \"short\" }));\n        } else {\n          parts.push(date);\n        }\n      } catch {\n        parts.push(date);\n      }\n    }\n    if (time) parts.push(time);\n    return parts.join(\", \");\n  };\n\n  const threadMessages = selectedMessage?.messages?.length\n    ? selectedMessage.messages\n    : selectedMessage\n      ? [{\n        id: selectedMessage.id,\n        text: selectedMessage.message,\n        sender: selectedMessage.sender,\n        date: selectedMessage.date,\n        time: selectedMessage.time,\n        direction: \"incoming\"\n      }]\n      : [];\n\n  const fetchThread = async (message, { force = false } = {}) => {\n    const cached = !force ? readThreadCacheEntry(message) : null;\n    if (cached?.payload) {\n      const cachedPayload = cached.payload;\n      const updatedFromCache = {\n        ...message,\n        adTitle: cachedPayload.adTitle || message.adTitle,\n        adImage: cachedPayload.adImage || message.adImage,\n        sender: message.sender || cachedPayload.sender || \"\",\n        messages: Array.isArray(cachedPayload.messages) ? cachedPayload.messages : [],\n        conversationId: cachedPayload.conversationId || message.conversationId,\n        conversationUrl: cachedPayload.conversationUrl || message.conversationUrl\n      };\n      setMessages((prev) => prev.map((msg) => (\n        String(msg.id) === String(message.id)\n          ? {\n            ...msg,\n            adTitle: updatedFromCache.adTitle,\n            adImage: updatedFromCache.adImage,\n            conversationId: updatedFromCache.conversationId,\n            conversationUrl: updatedFromCache.conversationUrl\n          }\n          : msg\n      )));\n      setSelectedMessage(updatedFromCache);\n      return;\n    }\n\n    setLoadingThread(true);\n    try {\n      const params = new URLSearchParams();\n      params.set(\"accountId\", message.accountId);\n      if (message.conversationId) params.set(\"conversationId\", message.conversationId);\n      if (message.conversationUrl) params.set(\"conversationUrl\", message.conversationUrl);\n      if (!message.conversationId && !message.conversationUrl) {\n        if (message.sender) params.set(\"participant\", message.sender);\n        if (message.adTitle) params.set(\"adTitle\", message.adTitle);\n      }\n      const data = await apiFetchJson(`/api/messages/thread?${params.toString()}`);\n      if (data.success) {\n        const adImage = normalizePreviewImageUrl(data.adImage || message.adImage);\n        const updated = {\n          ...message,\n          adTitle: data.adTitle || message.adTitle,\n          adImage,\n          sender: message.sender || data.participant || \"\",\n          messages: data.messages || [],\n          conversationId: data.conversationId || message.conversationId,\n          conversationUrl: data.conversationUrl || message.conversationUrl\n        };\n        setMessages((prev) => prev.map((msg) => (\n          String(msg.id) === String(message.id)\n            ? {\n              ...msg,\n              adTitle: updated.adTitle,\n              adImage: updated.adImage,\n              conversationId: updated.conversationId,\n              conversationUrl: updated.conversationUrl\n            }\n            : msg\n        )));\n        setSelectedMessage(updated);\n        writeThreadCacheEntry(updated, updated);\n      }\n    } catch (err) {\n      console.error(\"Ошибка загрузки диалога:\", err);\n    } finally {\n      setLoadingThread(false);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendReply();\n    }\n  };\n\n  const unreadCount = messages.filter(m => m.unread).length;\n  const showConversationList = !isMobileView || !selectedMessage;\n  const showChatPanel = !isMobileView || Boolean(selectedMessage);\n  const selectedRawPreviewImage = selectedMessage ? getRawMessagePreviewImage(selectedMessage) : \"\";\n  const selectedPreviewImage = selectedMessage\n    ? toMessageImageSrc(selectedRawPreviewImage, selectedMessage?.accountId)\n    : \"\";\n  const selectedDirectPreviewImage = normalizePreviewImageUrl(selectedRawPreviewImage);\n  const hasReplyPayload = Boolean(replyText.trim()) || replyImages.length > 0;\n  const canSendReply = !sending && hasReplyPayload;\n\n  // Spinner SVG for loading states\n  const Spinner = ({ size = 20, color = \"#7dd3fc\" }) => (\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" style={{ animation: \"spin 1s linear infinite\" }}>\n      <circle cx=\"12\" cy=\"12\" r=\"10\" stroke={color} strokeWidth=\"3\" fill=\"none\" strokeDasharray=\"31.4\" strokeDashoffset=\"10\" strokeLinecap=\"round\" />\n    </svg>\n  );\n\n  return (\n    <>\n      <style>{`\n        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }\n        @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.8; } }\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }\n        .msg-conv-item:hover { background: rgba(59,130,246,0.12) !important; }\n        .msg-send-btn:hover:not(:disabled) { background: #16a34a !important; }\n        .msg-refresh-btn:hover:not(:disabled) { background: #0284c7 !important; transform: scale(1.02); }\n        .msg-refresh-btn:active:not(:disabled) { transform: scale(0.98); }\n        .msg-translate-btn:hover { opacity: 1 !important; transform: translateY(-1px) scale(1.02) !important; }\n        .msg-translate-btn:active { transform: translateY(0px) scale(0.98) !important; }\n      `}</style>\n\n      <div className=\"section-header\" style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"space-between\",\n        gap: \"12px\",\n        marginBottom: \"20px\",\n        flexWrap: \"wrap\"\n      }}>\n        <h2 style={{\n          margin: 0,\n          color: \"#f8fafc\",\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: \"14px\",\n          fontWeight: 700\n        }}>\n          <span style={{\n            width: \"42px\",\n            height: \"42px\",\n            borderRadius: \"14px\",\n            background: \"linear-gradient(135deg, rgba(249, 115, 22, 0.25), rgba(194, 65, 12, 0.2))\",\n            border: \"1px solid rgba(251, 146, 60, 0.4)\",\n            boxShadow: \"0 4px 15px rgba(251, 146, 60, 0.28)\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          }}>\n            <MessageIcon size={22} color=\"#fdba74\" />\n          </span>\n          Сообщения\n        </h2>\n      </div>\n\n      <div className=\"messages-layout\" style={{ display: \"flex\", gap: \"20px\", height: \"calc(100vh - 220px)\", minHeight: \"500px\" }}>\n        {/* Conversation List */}\n        <div className=\"messages-list\" style={{\n          width: \"400px\",\n          minWidth: \"340px\",\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          color: \"#e2e8f0\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          backdropFilter: \"blur(10px)\",\n          ...(showConversationList ? {} : { display: \"none\" })\n        }}>\n          {/* Header */}\n          <div style={{\n            padding: \"16px 20px\",\n            borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n            background: \"rgba(15,23,42,0.5)\"\n          }}>\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"12px\" }}>\n              <h3 style={{ margin: 0, fontSize: \"18px\", fontWeight: 700 }}>Диалоги</h3>\n              {unreadCount > 0 && (\n                <span style={{\n                  padding: \"5px 14px\",\n                  background: \"linear-gradient(135deg, #10b981, #059669)\",\n                  color: \"white\",\n                  borderRadius: \"9999px\",\n                  fontSize: \"12px\",\n                  fontWeight: 600,\n                  boxShadow: \"0 0 12px rgba(16, 185, 129, 0.4)\",\n                  border: \"1px solid rgba(16, 185, 129, 0.3)\"\n                }}>\n                  {unreadCount} {unreadCount === 1 ? \"новое\" : \"новых\"}\n                </span>\n              )}\n            </div>\n            <button\n              className=\"msg-refresh-btn\"\n              onClick={loadMessages}\n              disabled={loading}\n              style={{\n                width: \"100%\",\n                padding: \"10px 16px\",\n                background: loading ? \"rgba(14,165,233,0.3)\" : \"linear-gradient(135deg, #0ea5e9, #0284c7)\",\n                color: \"white\",\n                border: \"none\",\n                borderRadius: \"10px\",\n                fontSize: \"13px\",\n                fontWeight: 600,\n                cursor: loading ? \"not-allowed\" : \"pointer\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                transition: \"all 0.15s ease\"\n              }}\n            >\n              {loading ? (\n                <>\n                  <Spinner size={16} color=\"#fff\" />\n                  Загрузка сообщений...\n                </>\n              ) : (\n                <>\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                    <polyline points=\"23 4 23 10 17 10\" />\n                    <path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\" />\n                  </svg>\n                  Обновить сообщения\n                </>\n              )}\n            </button>\n          </div>\n\n          {/* Error state */}\n          {error && (\n            <div style={{\n              margin: \"12px\",\n              padding: \"12px 16px\",\n              background: \"rgba(239,68,68,0.15)\",\n              border: \"1px solid rgba(239,68,68,0.3)\",\n              borderRadius: \"10px\",\n              fontSize: \"13px\",\n              color: \"#fca5a5\"\n            }}>\n              <div style={{ fontWeight: 600, marginBottom: \"4px\" }}>Ошибка загрузки</div>\n              <div>{error}</div>\n              <button\n                onClick={loadMessages}\n                style={{\n                  marginTop: \"8px\",\n                  padding: \"4px 12px\",\n                  background: \"rgba(239,68,68,0.3)\",\n                  color: \"#fca5a5\",\n                  border: \"1px solid rgba(239,68,68,0.4)\",\n                  borderRadius: \"6px\",\n                  fontSize: \"12px\",\n                  cursor: \"pointer\"\n                }}\n              >\n                Попробовать снова\n              </button>\n            </div>\n          )}\n\n          {/* Conversation list */}\n          <div style={{ flex: 1, overflow: \"auto\" }}>\n            {loading && messages.length === 0 ? (\n              // Loading skeleton\n              <div style={{ padding: \"8px 0\" }}>\n                {[1, 2, 3, 4, 5].map(i => (\n                  <div key={i} style={{\n                    padding: \"14px 20px\",\n                    display: \"flex\",\n                    gap: \"12px\",\n                    alignItems: \"center\",\n                    borderBottom: \"1px solid rgba(148,163,184,0.08)\"\n                  }}>\n                    <div style={{\n                      width: \"52px\",\n                      height: \"52px\",\n                      borderRadius: \"12px\",\n                      background: \"rgba(148,163,184,0.1)\",\n                      flexShrink: 0,\n                      animation: \"pulse 1.5s ease-in-out infinite\"\n                    }} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{\n                        height: \"14px\",\n                        width: \"60%\",\n                        background: \"rgba(148,163,184,0.1)\",\n                        borderRadius: \"4px\",\n                        marginBottom: \"8px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\"\n                      }} />\n                      <div style={{\n                        height: \"12px\",\n                        width: \"80%\",\n                        background: \"rgba(148,163,184,0.08)\",\n                        borderRadius: \"4px\",\n                        marginBottom: \"6px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\",\n                        animationDelay: \"0.1s\"\n                      }} />\n                      <div style={{\n                        height: \"10px\",\n                        width: \"40%\",\n                        background: \"rgba(148,163,184,0.06)\",\n                        borderRadius: \"4px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\",\n                        animationDelay: \"0.2s\"\n                      }} />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : messages.length === 0 && !loading ? (\n              <div style={{\n                padding: \"60px 20px\",\n                textAlign: \"center\",\n                color: \"#64748b\"\n              }}>\n                <div style={{ fontSize: \"40px\", marginBottom: \"12px\", opacity: 0.5 }}>\n                  <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" style={{ margin: \"0 auto\", display: \"block\", color: \"#475569\" }}>\n                    <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n                  </svg>\n                </div>\n                <div style={{ fontSize: \"15px\", fontWeight: 600, marginBottom: \"4px\" }}>Нет сообщений</div>\n                <div style={{ fontSize: \"13px\" }}>Нажмите \"Обновить\" для загрузки</div>\n              </div>\n            ) : (\n              messages.map((message) => {\n                const rawPreviewImage = getRawMessagePreviewImage(message);\n                const previewImage = toMessageImageSrc(rawPreviewImage, message?.accountId);\n                const directPreviewImage = normalizePreviewImageUrl(rawPreviewImage);\n                return (\n                <div\n                  key={message.id}\n                  className=\"msg-conv-item\"\n                  onClick={() => {\n                    markAsRead(message);\n                    setSelectedMessage(message);\n                    fetchThread(message);\n                  }}\n                  style={{\n                    padding: \"14px 20px\",\n                    borderBottom: \"1px solid rgba(148,163,184,0.08)\",\n                    cursor: \"pointer\",\n                    background: selectedMessage?.id === message.id\n                      ? \"rgba(59,130,246,0.15)\"\n                      : message.unread\n                        ? \"rgba(34,197,94,0.08)\"\n                        : \"transparent\",\n                    borderLeft: selectedMessage?.id === message.id\n                      ? \"3px solid #3b82f6\"\n                      : message.unread\n                        ? \"3px solid #22c55e\"\n                        : \"3px solid transparent\",\n                    display: \"flex\",\n                    alignItems: \"flex-start\",\n                    gap: \"12px\",\n                    transition: \"background 0.15s ease\",\n                    animation: \"fadeIn 0.2s ease\"\n                  }}\n                >\n                  {/* Product image / avatar */}\n                  <div style={{\n                    width: \"52px\",\n                    height: \"52px\",\n                    borderRadius: \"50%\",\n                    overflow: \"hidden\",\n                    background: \"rgba(15,23,42,0.6)\",\n                    border: \"1px solid rgba(148,163,184,0.15)\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    flexShrink: 0\n                  }}>\n                    {previewImage ? (\n                      <img\n                        src={previewImage}\n                        data-direct-src={directPreviewImage || \"\"}\n                        data-fallback-tried=\"0\"\n                        alt=\"\"\n                        style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n                        loading=\"lazy\"\n                        referrerPolicy=\"no-referrer\"\n                        onError={(e) => {\n                          const imageNode = e.currentTarget;\n                          const directSrc = String(imageNode.dataset?.directSrc || \"\").trim();\n                          const fallbackTried = imageNode.dataset?.fallbackTried === \"1\";\n                          const currentSrc = String(imageNode.getAttribute(\"src\") || \"\").trim();\n                          if (!fallbackTried && directSrc && directSrc !== currentSrc) {\n                            imageNode.dataset.fallbackTried = \"1\";\n                            imageNode.setAttribute(\"src\", directSrc);\n                            return;\n                          }\n                          imageNode.style.display = \"none\";\n                          const fallbackNode = imageNode.nextElementSibling;\n                          if (fallbackNode) fallbackNode.style.display = \"flex\";\n                        }}\n                      />\n                    ) : null}\n                    <div style={{\n                      width: \"100%\",\n                      height: \"100%\",\n                      background: message.unread\n                        ? \"linear-gradient(135deg, #22c55e, #16a34a)\"\n                        : \"linear-gradient(135deg, #3b82f6, #2563eb)\",\n                      color: \"white\",\n                      display: previewImage ? \"none\" : \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      fontSize: \"20px\",\n                      fontWeight: 700\n                    }}>\n                      {(message.sender || \"?\").charAt(0).toUpperCase()}\n                    </div>\n                  </div>\n\n                  {/* Content */}\n                  <div style={{ flex: 1, minWidth: 0 }}>\n                    {/* Top row: sender + time */}\n                    <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"3px\" }}>\n                      <span style={{\n                        fontWeight: 700,\n                        fontSize: \"14px\",\n                        color: \"#f1f5f9\",\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\",\n                        maxWidth: \"65%\"\n                      }}>\n                        {message.sender || \"Неизвестный\"}\n                      </span>\n                      <span style={{\n                        fontSize: \"11px\",\n                        color: \"#64748b\",\n                        whiteSpace: \"nowrap\",\n                        flexShrink: 0\n                      }}>\n                        {getTimeAgo(message.date, message.time)}\n                      </span>\n                    </div>\n\n                    {/* Ad title */}\n                    <div style={{\n                      fontSize: \"13px\",\n                      color: \"#94a3b8\",\n                      fontWeight: 600,\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      marginBottom: \"3px\"\n                    }}>\n                      {message.adTitle || \"Без названия\"}\n                    </div>\n\n                    {/* Last message preview */}\n                    <div style={{\n                      fontSize: \"12px\",\n                      color: \"#64748b\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      marginBottom: \"4px\"\n                    }}>\n                      {message.message || \"\"}\n                    </div>\n\n                    {/* Account label + unread badge */}\n                    <div style={{\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      gap: \"6px\"\n                    }}>\n                      <span style={{\n                        fontSize: \"11px\",\n                        color: \"#475569\",\n                        background: \"rgba(148,163,184,0.1)\",\n                        padding: \"1px 6px\",\n                        borderRadius: \"4px\"\n                      }}>\n                        {message.accountName}\n                      </span>\n                      {message.unread && (\n                        <span style={{\n                          padding: \"3px 10px\",\n                          background: \"linear-gradient(135deg, #8b5cf6, #7c3aed)\",\n                          color: \"white\",\n                          borderRadius: \"9999px\",\n                          fontSize: \"10px\",\n                          fontWeight: 700,\n                          textTransform: \"uppercase\",\n                          letterSpacing: \"0.5px\",\n                          boxShadow: \"0 0 10px rgba(139, 92, 246, 0.4)\",\n                          border: \"1px solid rgba(139, 92, 246, 0.3)\"\n                        }}>\n                          new\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                );\n              })\n            )}\n          </div>\n\n          {/* Message count footer */}\n          {messages.length > 0 && (\n            <div style={{\n              padding: \"8px 20px\",\n              borderTop: \"1px solid rgba(148,163,184,0.1)\",\n              fontSize: \"11px\",\n              color: \"#475569\",\n              textAlign: \"center\",\n              background: \"rgba(15,23,42,0.3)\"\n            }}>\n              {messages.length} {messages.length === 1 ? \"диалог\" : messages.length < 5 ? \"диалога\" : \"диалогов\"}\n            </div>\n          )}\n        </div>\n\n        {/* Chat Panel */}\n        <div className=\"messages-chat\" style={{\n          flex: 1,\n          position: \"relative\",\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          color: \"#e2e8f0\",\n          backdropFilter: \"blur(10px)\",\n          ...(showChatPanel ? {} : { display: \"none\" })\n        }}>\n          {selectedMessage ? (\n            <>\n              {/* Chat header */}\n              <div style={{\n                padding: \"14px 20px\",\n                borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n                background: \"rgba(15,23,42,0.6)\"\n              }}>\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n                  <div style={{ display: \"flex\", gap: \"14px\", alignItems: \"center\", flex: 1, minWidth: 0 }}>\n                    {/* Product image in header */}\n                    <div style={{\n                      width: \"50px\",\n                      height: \"50px\",\n                      borderRadius: \"10px\",\n                      overflow: \"hidden\",\n                      border: \"1px solid rgba(148,163,184,0.15)\",\n                      background: \"rgba(15,23,42,0.8)\",\n                      flexShrink: 0,\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\"\n                    }}>\n                      {selectedPreviewImage ? (\n                        <img\n                          src={selectedPreviewImage}\n                          data-direct-src={selectedDirectPreviewImage || \"\"}\n                          data-fallback-tried=\"0\"\n                          alt=\"\"\n                          style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n                          onError={(e) => {\n                            const imageNode = e.currentTarget;\n                            const directSrc = String(imageNode.dataset?.directSrc || \"\").trim();\n                            const fallbackTried = imageNode.dataset?.fallbackTried === \"1\";\n                            const currentSrc = String(imageNode.getAttribute(\"src\") || \"\").trim();\n                            if (!fallbackTried && directSrc && directSrc !== currentSrc) {\n                              imageNode.dataset.fallbackTried = \"1\";\n                              imageNode.setAttribute(\"src\", directSrc);\n                              return;\n                            }\n                            imageNode.style.display = \"none\";\n                          }}\n                        />\n                      ) : (\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#475569\" strokeWidth=\"1.5\">\n                          <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n                          <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\n                          <polyline points=\"21 15 16 10 5 21\" />\n                        </svg>\n                      )}\n                    </div>\n\n                    <div style={{ minWidth: 0 }}>\n                      <div style={{\n                        fontWeight: 700,\n                        fontSize: \"15px\",\n                        color: \"#f1f5f9\",\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\"\n                      }}>\n                        {selectedMessage.sender || \"Неизвестный\"}\n                      </div>\n                      <div style={{\n                        fontSize: \"13px\",\n                        color: \"#94a3b8\",\n                        fontWeight: 500,\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\",\n                        marginTop: \"2px\"\n                      }}>\n                        {selectedMessage.adTitle || \"Без названия\"}\n                      </div>\n                      <div style={{\n                        fontSize: \"11px\",\n                        color: \"#475569\",\n                        marginTop: \"2px\"\n                      }}>\n                        {selectedMessage.accountName}\n                      </div>\n                    </div>\n                  </div>\n\n                  <button\n                    onClick={() => setSelectedMessage(null)}\n                    style={{\n                      background: \"rgba(148,163,184,0.1)\",\n                      border: \"none\",\n                      width: isMobileView ? \"auto\" : \"32px\",\n                      height: \"32px\",\n                      padding: isMobileView ? \"0 10px\" : 0,\n                      borderRadius: \"8px\",\n                      cursor: \"pointer\",\n                      color: \"#94a3b8\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      fontSize: \"16px\",\n                      fontWeight: 600,\n                      flexShrink: 0\n                    }}\n                  >\n                    {isMobileView ? (\n                      \"← Назад\"\n                    ) : (\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\">\n                        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n                      </svg>\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              {/* Messages area */}\n              <div ref={chatScrollRef} style={{\n                flex: 1,\n                padding: \"20px\",\n                overflow: \"auto\",\n                background: \"rgba(8,12,24,0.4)\"\n              }}>\n                {loadingThread ? (\n                  <div style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    height: \"100%\",\n                    gap: \"12px\",\n                    color: \"#64748b\"\n                  }}>\n                    <Spinner size={32} color=\"#3b82f6\" />\n                    <span style={{ fontSize: \"14px\" }}>Загрузка диалога...</span>\n                  </div>\n                ) : threadMessages.length === 0 ? (\n                  <div style={{ color: \"#64748b\", textAlign: \"center\", paddingTop: \"40px\" }}>\n                    <div style={{ fontSize: \"14px\" }}>Нет сообщений в этом диалоге</div>\n                  </div>\n                ) : (\n                  <>\n\t                    {threadMessages.map((messageItem, idx) => {\n\t                      const isOutgoing = messageItem.direction === \"outgoing\";\n\t                      const isPending = Boolean(messageItem.pending);\n\t                      const isOffer = isPaymentAndShippingMessage(messageItem);\n\t                      const messageKey = String(messageItem.id || `idx-${idx}`);\n\t                      const translation = translationByMessageId[messageKey] || null;\n\t                      const hasText = Boolean(String(messageItem.text || \"\").trim());\n\t                      const attachmentSrcs = extractAttachmentUrls(messageItem)\n\t                        .map((url) => toMessageImageSrc(url, selectedMessage?.accountId))\n\t                        .filter(Boolean);\n\t                      const canTranslate = !isOffer && !isOutgoing && hasText;\n\n\t                      const toggleTranslate = async () => {\n\t                        if (!canTranslate) return;\n\n                        // Toggle off when already shown.\n                        if (translation?.shown && translation?.translatedText) {\n                          setTranslationByMessageId((prev) => ({\n                            ...prev,\n                            [messageKey]: { ...prev[messageKey], shown: false }\n                          }));\n                          return;\n                        }\n\n                        // Toggle on when already fetched.\n                        if (translation?.translatedText && !translation?.loading) {\n                          setTranslationByMessageId((prev) => ({\n                            ...prev,\n                            [messageKey]: { ...prev[messageKey], shown: true, error: \"\" }\n                          }));\n                          return;\n                        }\n\n                        if (translateInFlight.current.has(messageKey)) return;\n                        translateInFlight.current.add(messageKey);\n                        setTranslationByMessageId((prev) => ({\n                          ...prev,\n                          [messageKey]: {\n                            ...prev[messageKey],\n                            loading: true,\n                            shown: true,\n                            error: \"\"\n                          }\n                        }));\n\n                        try {\n                          const result = await apiFetchJson(\"/api/translate\", {\n                            method: \"POST\",\n                            headers: { \"Content-Type\": \"application/json\" },\n                            body: JSON.stringify({\n                              text: String(messageItem.text || \"\"),\n                              to: \"ru\",\n                              accountId: selectedMessage?.accountId\n                            })\n                          });\n                          setTranslationByMessageId((prev) => ({\n                            ...prev,\n                            [messageKey]: {\n                              loading: false,\n                              shown: true,\n                              error: \"\",\n                              translatedText: result?.translatedText || \"\"\n                            }\n                          }));\n                        } catch (error) {\n                          console.error(\"Ошибка перевода:\", error);\n                          setTranslationByMessageId((prev) => ({\n                            ...prev,\n                            [messageKey]: {\n                              loading: false,\n                              shown: true,\n                              translatedText: \"\",\n                              error: error?.message || \"Не удалось перевести\"\n                            }\n                          }));\n                        } finally {\n                          translateInFlight.current.delete(messageKey);\n                        }\n\t                      };\n\t                      const offerTitle = String(messageItem?.title || \"Anfrage erhalten\").trim() || \"Anfrage erhalten\";\n\t                      const offerItemCents = pickOfferField(messageItem, \"itemPriceInEuroCent\");\n\t                      const offerShippingCents = pickOfferField(messageItem, \"shippingCostInEuroCent\");\n\t                      const offerTotalCents = pickOfferField(messageItem, \"sellerTotalInEuroCent\");\n\t                      const offerCarrierName = pickOfferField(messageItem, \"carrierName\");\n\t                      const offerOptionName = pickOfferField(messageItem, \"shippingOptionName\");\n\t                      const offerOptionDesc = pickOfferField(messageItem, \"shippingOptionDescription\");\n\t                      const offerLiabilityCents = pickOfferField(messageItem, \"liabilityLimitInEuroCent\");\n\n\t                      const acceptCta = getOfferActionText(\n\t                        messageItem,\n\t                        \"ACCEPT_BUYER_OFFER_LEARN_MORE_ACTION\",\n\t                        \"Anfrage akzeptieren\"\n\t                      );\n\t                      const declineCta = getOfferActionText(\n\t                        messageItem,\n\t                        \"CANCEL_OFFER_ACTION\",\n\t                        \"Anfrage ablehnen\"\n\t                      );\n\t                      const counterCta = getOfferActionText(\n\t                        messageItem,\n\t                        \"MAKE_COUNTER_OFFER_ACTION\",\n\t                        \"Gegenangebot machen\"\n\t                      );\n\t                      return (\n\t                        <div\n\t                          key={messageItem.id || idx}\n\t                          style={{\n                            marginBottom: \"12px\",\n                            display: \"flex\",\n                            justifyContent: isOutgoing ? \"flex-end\" : \"flex-start\",\n                            animation: \"fadeIn 0.2s ease\"\n                          }}\n\t                        >\n\t                          <div style={{\n\t                            maxWidth: isOffer ? \"520px\" : \"70%\",\n\t                            minWidth: isOffer ? \"240px\" : \"120px\"\n\t                          }}>\n\t                            {/* Sender name */}\n\t                            <div style={{\n\t                              fontSize: \"11px\",\n\t                              color: isOutgoing ? \"#86efac\" : \"#7dd3fc\",\n                              fontWeight: 600,\n                              marginBottom: \"4px\",\n                              paddingLeft: isOutgoing ? \"0\" : \"12px\",\n                              paddingRight: isOutgoing ? \"12px\" : \"0\",\n                              textAlign: isOutgoing ? \"right\" : \"left\"\n                            }}>\n\t                              {messageItem.sender || (isOutgoing ? \"Вы\" : selectedMessage.sender || \"\")}\n\t                            </div>\n\n\t                            {isOffer ? (\n\t                              <div style={{\n\t                                borderRadius: \"18px\",\n\t                                padding: \"14px 14px 12px 14px\",\n\t                                background: \"linear-gradient(145deg, rgba(2,6,23,0.55) 0%, rgba(15,23,42,0.95) 58%, rgba(6,78,59,0.22) 100%)\",\n\t                                border: \"1px solid rgba(34,197,94,0.22)\",\n\t                                boxShadow: \"0 18px 40px rgba(0,0,0,0.45)\"\n\t                              }}>\n\t                                <div style={{\n\t                                  display: \"flex\",\n\t                                  justifyContent: \"space-between\",\n\t                                  alignItems: \"flex-start\",\n\t                                  gap: \"12px\",\n\t                                  marginBottom: \"12px\"\n\t                                }}>\n\t                                  <div style={{ display: \"flex\", gap: \"10px\", alignItems: \"center\", minWidth: 0 }}>\n\t                                    <div style={{\n\t                                      width: \"36px\",\n\t                                      height: \"36px\",\n\t                                      borderRadius: \"12px\",\n\t                                      background: \"rgba(34,197,94,0.18)\",\n\t                                      border: \"1px solid rgba(34,197,94,0.25)\",\n\t                                      display: \"flex\",\n\t                                      alignItems: \"center\",\n\t                                      justifyContent: \"center\",\n\t                                      flexShrink: 0\n\t                                    }}>\n\t                                      <span style={{ color: \"#4ade80\", fontWeight: 900, fontSize: \"16px\" }}>€</span>\n\t                                    </div>\n\t                                    <div style={{ minWidth: 0 }}>\n\t                                      <div style={{\n\t                                        fontSize: \"14px\",\n\t                                        fontWeight: 800,\n\t                                        color: \"#bbf7d0\",\n\t                                        overflow: \"hidden\",\n\t                                        textOverflow: \"ellipsis\",\n\t                                        whiteSpace: \"nowrap\"\n\t                                      }}>\n\t                                        {offerTitle}\n\t                                      </div>\n\t                                      <div style={{\n\t                                        fontSize: \"12px\",\n\t                                        color: \"rgba(148,163,184,0.9)\",\n\t                                        marginTop: \"1px\"\n\t                                      }}>\n\t                                        Sicher bezahlen\n\t                                      </div>\n\t                                    </div>\n\t                                  </div>\n\t                                  <div style={{\n\t                                    fontSize: \"20px\",\n\t                                    fontWeight: 900,\n\t                                    color: \"#4ade80\",\n\t                                    whiteSpace: \"nowrap\"\n\t                                  }}>\n\t                                    {formatEuroFromCents(offerTotalCents)}\n\t                                  </div>\n\t                                </div>\n\n\t                                <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"8px\" }}>\n\t                                  <div style={{ display: \"flex\", justifyContent: \"space-between\", color: \"rgba(226,232,240,0.92)\", fontSize: \"13px\" }}>\n\t                                    <span style={{ color: \"rgba(148,163,184,0.95)\" }}>Betrag</span>\n\t                                    <span style={{ fontWeight: 700 }}>{formatEuroFromCents(offerItemCents)}</span>\n\t                                  </div>\n\t                                  <div style={{ display: \"flex\", justifyContent: \"space-between\", color: \"rgba(226,232,240,0.92)\", fontSize: \"13px\" }}>\n\t                                    <span style={{ color: \"rgba(148,163,184,0.95)\" }}>Versand</span>\n\t                                    <span style={{ fontWeight: 700 }}>{formatEuroFromCents(offerShippingCents)}</span>\n\t                                  </div>\n\t                                  <div style={{\n\t                                    display: \"flex\",\n\t                                    justifyContent: \"space-between\",\n\t                                    fontSize: \"13px\",\n\t                                    paddingTop: \"6px\",\n\t                                    borderTop: \"1px solid rgba(148,163,184,0.12)\"\n\t                                  }}>\n\t                                    <span style={{ color: \"rgba(148,163,184,0.95)\", fontWeight: 800 }}>Gesamt</span>\n\t                                    <span style={{ fontWeight: 900, color: \"#e2e8f0\" }}>{formatEuroFromCents(offerTotalCents)}</span>\n\t                                  </div>\n\t                                </div>\n\n\t                                {(offerCarrierName || offerOptionName || offerOptionDesc) ? (\n\t                                  <div style={{\n\t                                    marginTop: \"12px\",\n\t                                    padding: \"12px\",\n\t                                    borderRadius: \"14px\",\n\t                                    background: \"rgba(2,6,23,0.25)\",\n\t                                    border: \"1px solid rgba(148,163,184,0.14)\"\n\t                                  }}>\n\t                                    <div style={{ fontSize: \"13px\", fontWeight: 800, color: \"#e2e8f0\" }}>\n\t                                      Inkl. {offerCarrierName || \"Versand\"} {offerOptionName || \"\"}\n\t                                    </div>\n\t                                    {offerOptionDesc ? (\n\t                                      <div style={{ marginTop: \"4px\", fontSize: \"12px\", color: \"rgba(148,163,184,0.95)\" }}>\n\t                                        {offerOptionDesc}\n\t                                      </div>\n\t                                    ) : null}\n\t                                    {offerLiabilityCents ? (\n\t                                      <div style={{ marginTop: \"6px\", fontSize: \"12px\", color: \"rgba(148,163,184,0.95)\" }}>\n\t                                        Mit Sendungsverfolgung und Haftung bis {formatEuroFromCents(offerLiabilityCents)}\n\t                                      </div>\n\t                                    ) : null}\n\t                                  </div>\n\t                                ) : null}\n\n\t                                {hasText ? (\n\t                                  <div style={{\n\t                                    marginTop: \"12px\",\n\t                                    fontSize: \"13px\",\n\t                                    lineHeight: \"1.5\",\n\t                                    color: \"rgba(226,232,240,0.92)\"\n\t                                  }}>\n\t                                    {messageItem.text}\n\t                                  </div>\n\t                                ) : null}\n\n\t                                <div style={{ marginTop: \"12px\", display: \"flex\", flexDirection: \"column\", gap: \"10px\" }}>\n\t                                  <button\n\t                                    type=\"button\"\n\t                                    disabled\n\t                                    style={{\n\t                                      width: \"100%\",\n\t                                      padding: \"10px 14px\",\n\t                                      borderRadius: \"9999px\",\n\t                                      border: \"1px solid rgba(34,197,94,0.32)\",\n\t                                      background: \"linear-gradient(135deg, rgba(34,197,94,0.55), rgba(22,163,74,0.45))\",\n\t                                      color: \"rgba(255,255,255,0.95)\",\n\t                                      fontWeight: 900,\n\t                                      cursor: \"not-allowed\",\n\t                                      opacity: 0.75\n\t                                    }}\n\t                                    title=\"Скоро\"\n\t                                  >\n\t                                    {acceptCta}\n\t                                  </button>\n\t                                  <div style={{ display: \"flex\", gap: \"10px\" }}>\n\t                                    <button\n\t                                      type=\"button\"\n\t                                      onClick={() => setDeclineConfirmOpen(true)}\n\t                                      disabled={decliningOffer}\n\t                                      style={{\n\t                                        flex: 1,\n\t                                        padding: \"10px 14px\",\n\t                                        borderRadius: \"9999px\",\n\t                                        border: \"1px solid rgba(148,163,184,0.28)\",\n\t                                        background: \"rgba(2,6,23,0.35)\",\n\t                                        color: \"rgba(226,232,240,0.95)\",\n\t                                        fontWeight: 800,\n\t                                        cursor: decliningOffer ? \"not-allowed\" : \"pointer\",\n\t                                        opacity: decliningOffer ? 0.7 : 1\n\t                                      }}\n\t                                    >\n\t                                      {declineCta}\n\t                                    </button>\n\t                                    <button\n\t                                      type=\"button\"\n\t                                      disabled\n\t                                      style={{\n\t                                        flex: 1,\n\t                                        padding: \"10px 14px\",\n\t                                        borderRadius: \"9999px\",\n\t                                        border: \"1px solid rgba(148,163,184,0.22)\",\n\t                                        background: \"rgba(2,6,23,0.25)\",\n\t                                        color: \"rgba(148,163,184,0.95)\",\n\t                                        fontWeight: 800,\n\t                                        cursor: \"not-allowed\",\n\t                                        opacity: 0.75\n\t                                      }}\n\t                                      title=\"Скоро\"\n\t                                    >\n\t                                      {counterCta}\n\t                                    </button>\n\t                                  </div>\n\t                                </div>\n\n\t                                <div style={{\n\t                                  fontSize: \"10px\",\n\t                                  color: \"rgba(148,163,184,0.8)\",\n\t                                  marginTop: \"10px\",\n\t                                  textAlign: \"right\"\n\t                                }}>\n\t                                  {isPending ? \"Отправка...\" : formatMessageDate(\n\t                                    messageItem.date || selectedMessage.date,\n\t                                    messageItem.time || selectedMessage.time\n\t                                  )}\n\t                                </div>\n\t                              </div>\n\t                            ) : (\n\t                              <div style={{\n\t                                position: \"relative\",\n\t                                padding: canTranslate ? \"10px 14px 18px 14px\" : \"10px 14px\",\n\t                                borderRadius: isOutgoing ? \"14px 14px 4px 14px\" : \"14px 14px 14px 4px\",\n\t                                background: isOutgoing\n\t                                  ? \"linear-gradient(135deg, #1a4731, #14532d)\"\n\t                                  : \"rgba(15,23,42,0.8)\",\n\t                                border: isOutgoing\n\t                                  ? \"1px solid rgba(34,197,94,0.25)\"\n\t                                  : \"1px solid rgba(148,163,184,0.15)\"\n\t                              }}>\n\t                                {attachmentSrcs.length > 0 && (\n\t                                  <div style={{\n\t                                    display: \"grid\",\n\t                                    gridTemplateColumns: \"repeat(auto-fit, minmax(120px, 1fr))\",\n\t                                    gap: \"8px\",\n\t                                    marginBottom: hasText ? \"8px\" : \"0\"\n\t                                  }}>\n\t                                    {attachmentSrcs.map((src, imageIdx) => (\n\t                                      <img\n\t                                        key={`${messageKey}-img-${imageIdx}`}\n\t                                        src={src}\n\t                                        alt=\"\"\n\t                                        loading=\"lazy\"\n\t                                        referrerPolicy=\"no-referrer\"\n\t                                        style={{\n\t                                          width: \"100%\",\n\t                                          maxHeight: \"220px\",\n\t                                          objectFit: \"cover\",\n\t                                          borderRadius: \"12px\",\n\t                                          border: \"1px solid rgba(148,163,184,0.14)\"\n\t                                        }}\n\t                                      />\n\t                                    ))}\n\t                                  </div>\n\t                                )}\n\n\t                                {hasText ? (\n\t                                  <div style={{\n\t                                    fontSize: \"14px\",\n\t                                    lineHeight: \"1.5\",\n\t                                    whiteSpace: \"pre-wrap\",\n\t                                    wordBreak: \"break-word\",\n\t                                    color: \"#e2e8f0\"\n\t                                  }}>\n\t                                    {messageItem.text}\n\t                                  </div>\n\t                                ) : null}\n\n\t                                {/* Translate button */}\n\t                                {canTranslate && (\n\t                                  <button\n\t                                    type=\"button\"\n\t                                    className=\"msg-translate-btn\"\n\t                                    onClick={toggleTranslate}\n\t                                    title=\"Перевести на русский\"\n\t                                    style={{\n\t                                      position: \"absolute\",\n\t                                      left: \"8px\",\n\t                                      bottom: \"6px\",\n\t                                      width: \"22px\",\n\t                                      height: \"22px\",\n\t                                      borderRadius: \"8px\",\n\t                                      border: \"1px solid rgba(148,163,184,0.18)\",\n\t                                      background: \"rgba(2,6,23,0.25)\",\n\t                                      color: \"#94a3b8\",\n\t                                      display: \"inline-flex\",\n\t                                      alignItems: \"center\",\n\t                                      justifyContent: \"center\",\n\t                                      cursor: \"pointer\",\n\t                                      opacity: 0.75,\n\t                                      transition: \"transform 0.12s ease, opacity 0.12s ease, background 0.12s ease\"\n\t                                    }}\n\t                                  >\n\t                                    <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n\t                                      <path d=\"M5 5h6\" />\n\t                                      <path d=\"M8 5c0 6-3 10-6 12\" />\n\t                                      <path d=\"M7 13c2 2 4 4 7 6\" />\n\t                                      <path d=\"M14 19h7\" />\n\t                                      <path d=\"M17 4l4 15\" />\n\t                                      <path d=\"M20 19l-3-9-3 9\" />\n\t                                    </svg>\n\t                                  </button>\n\t                                )}\n\n\t                                {/* Translation result */}\n\t                                {translation?.shown && (\n\t                                  <div style={{\n\t                                    marginTop: \"10px\",\n\t                                    paddingTop: \"8px\",\n\t                                    borderTop: \"1px dashed rgba(148,163,184,0.18)\",\n\t                                    fontSize: \"13px\",\n\t                                    lineHeight: \"1.45\",\n\t                                    color: translation?.error ? \"#fb7185\" : \"#cbd5e1\",\n\t                                    opacity: 0.95\n\t                                  }}>\n\t                                    {translation?.loading ? (\n\t                                      <span style={{ color: \"#94a3b8\" }}>Перевод...</span>\n\t                                    ) : translation?.error ? (\n\t                                      <span>{translation.error}</span>\n\t                                    ) : (\n\t                                      <span>{translation.translatedText}</span>\n\t                                    )}\n\t                                  </div>\n\t                                )}\n\n\t                                {/* Timestamp */}\n\t                                <div style={{\n\t                                  fontSize: \"10px\",\n\t                                  color: \"#64748b\",\n\t                                  marginTop: \"6px\",\n\t                                  textAlign: \"right\"\n\t                                }}>\n\t                                  {isPending ? \"Отправка...\" : formatMessageDate(\n\t                                    messageItem.date || selectedMessage.date,\n\t                                    messageItem.time || selectedMessage.time\n\t                                  )}\n\t                                </div>\n\t                              </div>\n\t                            )}\n\t                          </div>\n\t                        </div>\n\t                      );\n\t                    })}\n                  </>\n                )}\n              </div>\n\n              {/* Reply input */}\n              <div style={{\n                padding: \"14px 20px\",\n                borderTop: \"1px solid rgba(148,163,184,0.15)\",\n                background: \"rgba(15,23,42,0.6)\"\n              }}>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  multiple\n                  onChange={handleReplyImageSelect}\n                  style={{ display: \"none\" }}\n                />\n\n                {replyImages.length > 0 && (\n                  <div style={{\n                    marginBottom: \"10px\",\n                    display: \"flex\",\n                    gap: \"8px\",\n                    overflowX: \"auto\",\n                    paddingBottom: \"2px\"\n                  }}>\n                    {replyImages.map((item) => (\n                      <div\n                        key={item.id}\n                        style={{\n                          position: \"relative\",\n                          width: \"72px\",\n                          height: \"72px\",\n                          borderRadius: \"10px\",\n                          border: \"1px solid rgba(148,163,184,0.2)\",\n                          overflow: \"hidden\",\n                          flexShrink: 0\n                        }}\n                      >\n                        <img\n                          src={item.previewUrl}\n                          alt=\"\"\n                          style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => removeReplyImage(item.id)}\n                          style={{\n                            position: \"absolute\",\n                            top: \"4px\",\n                            right: \"4px\",\n                            width: \"20px\",\n                            height: \"20px\",\n                            borderRadius: \"9999px\",\n                            border: \"none\",\n                            background: \"rgba(2,6,23,0.72)\",\n                            color: \"#f8fafc\",\n                            fontSize: \"12px\",\n                            cursor: \"pointer\",\n                            display: \"flex\",\n                            alignItems: \"center\",\n                            justifyContent: \"center\"\n                          }}\n                          title=\"Удалить\"\n                        >\n                          ×\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                <div style={{ display: \"flex\", gap: \"10px\", alignItems: \"flex-end\" }}>\n                  <button\n                    type=\"button\"\n                    onClick={() => fileInputRef.current?.click()}\n                    disabled={sending}\n                    aria-label=\"Bilder hochladen\"\n                    style={{\n                      width: \"42px\",\n                      height: \"42px\",\n                      borderRadius: \"12px\",\n                      border: \"1px solid rgba(148,163,184,0.25)\",\n                      background: \"rgba(15,23,42,0.7)\",\n                      color: \"#cbd5e1\",\n                      cursor: sending ? \"not-allowed\" : \"pointer\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      flexShrink: 0\n                    }}\n                  >\n                    <svg viewBox=\"0 0 24 24\" width=\"18\" height=\"18\" fill=\"currentColor\" aria-hidden=\"true\">\n                      <path d=\"M12.0004 8.54376C9.72753 8.54376 7.88501 10.4042 7.88501 12.6991C7.88501 14.994 9.72753 16.8544 12.0004 16.8544C14.2733 16.8544 16.1158 14.994 16.1158 12.6991C16.1158 10.4042 14.2733 8.54376 12.0004 8.54376ZM9.88501 12.6991C9.88501 11.5195 10.8321 10.5632 12.0004 10.5632C13.1687 10.5632 14.1158 11.5195 14.1158 12.6991C14.1158 13.8787 13.1687 14.835 12.0004 14.835C10.8321 14.835 9.88501 13.8787 9.88501 12.6991Z\" />\n                      <path d=\"M9.23077 4C8.91601 4 8.61962 4.14963 8.43077 4.40388L6.65385 6.79612H4.38462C3.75218 6.79612 3.14564 7.04979 2.69844 7.50134C2.25124 7.95288 2 8.5653 2 9.20388V17.5922C2 18.2308 2.25124 18.8432 2.69844 19.2948C3.14564 19.7463 3.75218 20 4.38462 20H19.6154C20.2478 20 20.8544 19.7463 21.3016 19.2948C21.7488 18.8432 22 18.2308 22 17.5922V9.20388C22 8.5653 21.7488 7.95288 21.3016 7.50134C20.8544 7.04979 20.2478 6.79612 19.6154 6.79612H17.3462L15.5692 4.40388C15.3804 4.14963 15.084 4 14.7692 4H9.23077ZM7.95385 8.41165L9.73077 6.01942H14.2692L16.0462 8.41165C16.235 8.6659 16.5314 8.81553 16.8462 8.81553H19.6154C19.7179 8.81553 19.8163 8.85665 19.8888 8.9292C19.9614 9.00175 20.0025 9.10014 20.0025 9.20263V17.5909C20.0025 17.6934 19.9614 17.7918 19.8888 17.8644C19.8163 17.9369 19.7179 17.978 19.6154 17.978H4.38462C4.28208 17.978 4.1837 17.9369 4.11115 17.8644C4.0386 17.7918 3.99748 17.6934 3.99748 17.5909V9.20263C3.99748 9.10014 4.0386 9.00175 4.11115 8.9292C4.1837 8.85665 4.28208 8.81553 4.38462 8.81553H7.15385C7.4686 8.81553 7.765 8.6659 7.95385 8.41165Z\" />\n                    </svg>\n                  </button>\n\n                  <textarea\n                    value={replyText}\n                    onChange={(e) => setReplyText(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"Nachricht schreiben...\"\n                    rows={1}\n                    style={{\n                      flex: 1,\n                      padding: \"10px 14px\",\n                      border: \"1px solid rgba(148,163,184,0.2)\",\n                      borderRadius: \"12px\",\n                      resize: \"none\",\n                      minHeight: \"42px\",\n                      maxHeight: \"120px\",\n                      background: \"rgba(15,23,42,0.6)\",\n                      color: \"#e2e8f0\",\n                      fontSize: \"14px\",\n                      lineHeight: \"1.4\",\n                      outline: \"none\",\n                      fontFamily: \"inherit\"\n                    }}\n                    onInput={(e) => {\n                      e.target.style.height = \"42px\";\n                      e.target.style.height = Math.min(e.target.scrollHeight, 120) + \"px\";\n                    }}\n                  />\n\n                  <button\n                    className=\"msg-send-btn\"\n                    onClick={sendReply}\n                    disabled={!canSendReply}\n                    style={{\n                      padding: \"10px 20px\",\n                      background: sending\n                        ? \"rgba(34,197,94,0.4)\"\n                        : !hasReplyPayload\n                          ? \"rgba(148,163,184,0.15)\"\n                          : \"linear-gradient(135deg, #22c55e, #16a34a)\",\n                      color: !hasReplyPayload ? \"#64748b\" : \"white\",\n                      border: \"none\",\n                      borderRadius: \"12px\",\n                      cursor: !canSendReply ? \"not-allowed\" : \"pointer\",\n                      whiteSpace: \"nowrap\",\n                      fontSize: \"14px\",\n                      fontWeight: 600,\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      gap: \"6px\",\n                      height: \"42px\",\n                      transition: \"all 0.15s ease\"\n                    }}\n                  >\n                    {sending ? (\n                      <>\n                        <Spinner size={14} color=\"#fff\" />\n                        <span>Отправка</span>\n                      </>\n                    ) : (\n                      <>\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                          <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n                          <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n                        </svg>\n                        <span>Отправить</span>\n                      </>\n                    )}\n                  </button>\n                </div>\n                <div style={{ fontSize: \"11px\", color: \"#475569\", marginTop: \"6px\" }}>\n                  Enter для отправки, Shift+Enter для новой строки\n                </div>\n              </div>\n\n              {declineConfirmOpen && (\n                <div style={{\n                  position: \"absolute\",\n                  inset: 0,\n                  background: \"rgba(2,6,23,0.65)\",\n                  backdropFilter: \"blur(2px)\",\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  zIndex: 40,\n                  padding: \"16px\"\n                }}>\n                  <div style={{\n                    width: \"100%\",\n                    maxWidth: \"420px\",\n                    borderRadius: \"16px\",\n                    border: \"1px solid rgba(148,163,184,0.2)\",\n                    background: \"linear-gradient(145deg, rgba(15,23,42,0.96), rgba(2,6,23,0.98))\",\n                    boxShadow: \"0 18px 60px rgba(0,0,0,0.5)\",\n                    padding: \"18px\"\n                  }}>\n                    <div style={{ fontSize: \"16px\", fontWeight: 700, color: \"#f8fafc\", marginBottom: \"8px\" }}>\n                      Anfrage ablehnen\n                    </div>\n                    <div style={{ fontSize: \"13px\", lineHeight: \"1.5\", color: \"#94a3b8\", marginBottom: \"16px\" }}>\n                      Möchtest du diese Anfrage wirklich ablehnen?\n                    </div>\n                    <div style={{ display: \"flex\", gap: \"10px\", justifyContent: \"flex-end\" }}>\n                      <button\n                        type=\"button\"\n                        onClick={() => setDeclineConfirmOpen(false)}\n                        disabled={decliningOffer}\n                        style={{\n                          padding: \"10px 14px\",\n                          borderRadius: \"10px\",\n                          border: \"1px solid rgba(148,163,184,0.22)\",\n                          background: \"rgba(15,23,42,0.65)\",\n                          color: \"#cbd5e1\",\n                          cursor: decliningOffer ? \"not-allowed\" : \"pointer\"\n                        }}\n                      >\n                        Abbrechen\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={confirmDeclineOffer}\n                        disabled={decliningOffer}\n                        style={{\n                          padding: \"10px 14px\",\n                          borderRadius: \"10px\",\n                          border: \"1px solid rgba(239,68,68,0.35)\",\n                          background: \"linear-gradient(135deg, rgba(239,68,68,0.78), rgba(185,28,28,0.82))\",\n                          color: \"#fff\",\n                          fontWeight: 700,\n                          cursor: decliningOffer ? \"not-allowed\" : \"pointer\",\n                          display: \"inline-flex\",\n                          alignItems: \"center\",\n                          gap: \"6px\",\n                          minWidth: \"158px\",\n                          justifyContent: \"center\"\n                        }}\n                      >\n                        {decliningOffer ? (\n                          <>\n                            <Spinner size={14} color=\"#fff\" />\n                            <span>Bitte warten</span>\n                          </>\n                        ) : (\n                          \"Anfrage ablehnen\"\n                        )}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </>\n          ) : (\n            // Empty state\n            <div style={{\n              flex: 1,\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              color: \"#475569\"\n            }}>\n              <div style={{ textAlign: \"center\", maxWidth: \"280px\" }}>\n                <svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1\" style={{ margin: \"0 auto 16px\", display: \"block\", color: \"#334155\" }}>\n                  <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n                </svg>\n                <h3 style={{ margin: \"0 0 8px\", fontSize: \"16px\", color: \"#64748b\" }}>\n                  Выберите диалог\n                </h3>\n                <p style={{ margin: 0, fontSize: \"13px\", lineHeight: \"1.5\" }}>\n                  Выберите диалог из списка слева для просмотра сообщений и ответа\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default MessagesTab;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}