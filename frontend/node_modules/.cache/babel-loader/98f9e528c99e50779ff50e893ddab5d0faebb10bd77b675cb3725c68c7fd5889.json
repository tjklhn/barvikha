{"ast":null,"code":"import _objectSpread from\"/Users/eurocare/Downloads/barvihaluxury-main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import{apiFetchJson}from\"../api\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const detectMobileView=()=>{var _window$screen;if(typeof window===\"undefined\")return false;const viewportWidth=window.innerWidth||document.documentElement.clientWidth||0;const screenWidth=typeof((_window$screen=window.screen)===null||_window$screen===void 0?void 0:_window$screen.width)===\"number\"?window.screen.width:viewportWidth;const effectiveWidth=Math.min(viewportWidth||screenWidth,screenWidth||viewportWidth);const mobileUa=/Android|webOS|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(typeof navigator!==\"undefined\"&&navigator.userAgent||\"\");const hasCoarsePointer=typeof window.matchMedia===\"function\"?window.matchMedia(\"(pointer: coarse)\").matches:false;const noHover=typeof window.matchMedia===\"function\"?window.matchMedia(\"(hover: none)\").matches:false;const touchPoints=typeof navigator!==\"undefined\"?Number(navigator.maxTouchPoints||0):0;const touchLikeDevice=hasCoarsePointer||noHover||touchPoints>1;return effectiveWidth<=768||touchLikeDevice&&effectiveWidth<=1024||mobileUa&&effectiveWidth<=1180;};const MessagesTab=()=>{var _selectedMessage$mess;const[messages,setMessages]=useState([]);const[selectedMessage,setSelectedMessage]=useState(null);const[replyText,setReplyText]=useState(\"\");const[sending,setSending]=useState(false);const[loading,setLoading]=useState(false);const[loadingThread,setLoadingThread]=useState(false);const[error,setError]=useState(null);const[isMobileView,setIsMobileView]=useState(()=>detectMobileView());const chatScrollRef=useRef(null);useEffect(()=>{loadMessages();},[]);useEffect(()=>{if(!selectedMessage)return;const container=chatScrollRef.current;if(!container)return;container.scrollTo({top:container.scrollHeight,behavior:\"smooth\"});},[selectedMessage===null||selectedMessage===void 0?void 0:selectedMessage.id,selectedMessage===null||selectedMessage===void 0?void 0:selectedMessage.messages]);useEffect(()=>{const handleResize=()=>{setIsMobileView(detectMobileView());};window.addEventListener(\"resize\",handleResize);return()=>window.removeEventListener(\"resize\",handleResize);},[]);const loadMessages=async()=>{setLoading(true);setError(null);try{const data=await apiFetchJson(\"/api/messages\");const list=Array.isArray(data)?data:[];const seen=new Set();const deduped=[];for(const item of list){const key=item.conversationId||item.conversationUrl||item.id||\"\".concat(item.accountId||\"\",\"|\").concat(item.sender||\"\",\"|\").concat(item.adTitle||\"\",\"|\").concat(item.message||\"\",\"|\").concat(item.time||\"\");if(seen.has(key))continue;seen.add(key);deduped.push(item);}setMessages(deduped);}catch(err){console.error(\"Ошибка загрузки сообщений:\",err);setError(err.message||\"Не удалось загрузить сообщения\");}finally{setLoading(false);}};const markAsRead=async messageId=>{// Immediately update UI for better responsiveness\nsetMessages(prev=>prev.map(msg=>msg.id===messageId?_objectSpread(_objectSpread({},msg),{},{unread:false}):msg));try{await apiFetchJson(\"/api/messages/\".concat(messageId,\"/read\"),{method:\"PUT\"});}catch(err){console.error(\"Ошибка при отметке сообщения как прочитанного:\",err);// Optionally revert on error\n}};const sendReply=async()=>{if(!replyText.trim()||!selectedMessage)return;if(!selectedMessage.conversationId&&!selectedMessage.conversationUrl&&!selectedMessage.sender&&!selectedMessage.adTitle){alert(\"Не найден идентификатор диалога.\");return;}setSending(true);try{const result=await apiFetchJson(\"/api/messages/send\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({accountId:selectedMessage.accountId,conversationId:selectedMessage.conversationId,conversationUrl:selectedMessage.conversationUrl,participant:selectedMessage.sender,adTitle:selectedMessage.adTitle,text:replyText})});if(result.success){const resolvedConversationId=result.conversationId||selectedMessage.conversationId;const resolvedConversationUrl=result.conversationUrl||selectedMessage.conversationUrl;const latestMessages=result.messages||[];const lastMessage=latestMessages[latestMessages.length-1];if(lastMessage){setMessages(prev=>prev.map(msg=>msg.id===selectedMessage.id?_objectSpread(_objectSpread({},msg),{},{message:lastMessage.text,date:lastMessage.date,time:lastMessage.time,conversationId:resolvedConversationId||msg.conversationId,conversationUrl:resolvedConversationUrl||msg.conversationUrl}):msg));}setSelectedMessage(prev=>_objectSpread(_objectSpread({},prev),{},{messages:latestMessages,conversationId:resolvedConversationId,conversationUrl:resolvedConversationUrl}));setReplyText(\"\");}else{alert(\"Ошибка: \"+(result.error||\"Не удалось отправить\"));}}catch(err){console.error(\"Ошибка отправки:\",err);alert(\"Ошибка при отправке сообщения\");}finally{setSending(false);}};const getTimeAgo=(date,time)=>{if(!date&&!time)return\"\";const now=new Date();try{const messageDate=new Date(date+\"T\"+(time||\"00:00\"));if(isNaN(messageDate.getTime()))return time||date||\"\";const diffHours=Math.floor((now-messageDate)/(1000*60*60));if(diffHours<1)return time||\"Только что\";if(diffHours<24)return time;if(diffHours<48)return\"Вчера\";return date;}catch(_unused){return time||date||\"\";}};const formatMessageDate=(date,time)=>{if(!date&&!time)return\"\";const parts=[];if(date){try{const d=new Date(date+\"T00:00\");if(!isNaN(d.getTime())){const now=new Date();const diffDays=Math.floor((now-d)/(1000*60*60*24));if(diffDays===0)parts.push(\"Сегодня\");else if(diffDays===1)parts.push(\"Вчера\");else parts.push(d.toLocaleDateString(\"ru-RU\",{day:\"numeric\",month:\"short\"}));}else{parts.push(date);}}catch(_unused2){parts.push(date);}}if(time)parts.push(time);return parts.join(\", \");};const threadMessages=selectedMessage!==null&&selectedMessage!==void 0&&(_selectedMessage$mess=selectedMessage.messages)!==null&&_selectedMessage$mess!==void 0&&_selectedMessage$mess.length?selectedMessage.messages:selectedMessage?[{id:selectedMessage.id,text:selectedMessage.message,sender:selectedMessage.sender,date:selectedMessage.date,time:selectedMessage.time,direction:\"incoming\"}]:[];const fetchThread=async message=>{setLoadingThread(true);try{const params=new URLSearchParams();params.set(\"accountId\",message.accountId);if(message.conversationId)params.set(\"conversationId\",message.conversationId);if(message.conversationUrl)params.set(\"conversationUrl\",message.conversationUrl);if(!message.conversationId&&!message.conversationUrl){if(message.sender)params.set(\"participant\",message.sender);if(message.adTitle)params.set(\"adTitle\",message.adTitle);}const data=await apiFetchJson(\"/api/messages/thread?\".concat(params.toString()));if(data.success){const updated=_objectSpread(_objectSpread({},message),{},{adTitle:data.adTitle||message.adTitle,adImage:data.adImage||message.adImage,sender:message.sender||data.participant||\"\",messages:data.messages||[],conversationId:data.conversationId||message.conversationId,conversationUrl:data.conversationUrl||message.conversationUrl});setSelectedMessage(updated);}}catch(err){console.error(\"Ошибка загрузки диалога:\",err);}finally{setLoadingThread(false);}};const handleKeyDown=e=>{if(e.key===\"Enter\"&&!e.shiftKey){e.preventDefault();sendReply();}};const unreadCount=messages.filter(m=>m.unread).length;const showConversationList=!isMobileView||!selectedMessage;const showChatPanel=!isMobileView||Boolean(selectedMessage);// Spinner SVG for loading states\nconst Spinner=_ref=>{let{size=20,color=\"#7dd3fc\"}=_ref;return/*#__PURE__*/_jsx(\"svg\",{width:size,height:size,viewBox:\"0 0 24 24\",style:{animation:\"spin 1s linear infinite\"},children:/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",stroke:color,strokeWidth:\"3\",fill:\"none\",strokeDasharray:\"31.4\",strokeDashoffset:\"10\",strokeLinecap:\"round\"})});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"style\",{children:\"\\n        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }\\n        @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.8; } }\\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }\\n        .msg-conv-item:hover { background: rgba(59,130,246,0.12) !important; }\\n        .msg-send-btn:hover:not(:disabled) { background: #16a34a !important; }\\n        .msg-refresh-btn:hover:not(:disabled) { background: #0284c7 !important; transform: scale(1.02); }\\n        .msg-refresh-btn:active:not(:disabled) { transform: scale(0.98); }\\n      \"}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-layout\",style:{display:\"flex\",gap:\"20px\",height:\"calc(100vh - 220px)\",minHeight:\"500px\"},children:[showConversationList&&/*#__PURE__*/_jsxs(\"div\",{className:\"messages-list\",style:{width:\"400px\",minWidth:\"340px\",background:\"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",borderRadius:\"20px\",overflow:\"hidden\",boxShadow:\"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",border:\"1px solid rgba(148,163,184,0.12)\",color:\"#e2e8f0\",display:\"flex\",flexDirection:\"column\",backdropFilter:\"blur(10px)\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"16px 20px\",borderBottom:\"1px solid rgba(148,163,184,0.15)\",background:\"rgba(15,23,42,0.5)\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:\"12px\"},children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,fontSize:\"18px\",fontWeight:700},children:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\"}),unreadCount>0&&/*#__PURE__*/_jsxs(\"span\",{style:{padding:\"5px 14px\",background:\"linear-gradient(135deg, #10b981, #059669)\",color:\"white\",borderRadius:\"9999px\",fontSize:\"12px\",fontWeight:600,boxShadow:\"0 0 12px rgba(16, 185, 129, 0.4)\",border:\"1px solid rgba(16, 185, 129, 0.3)\"},children:[unreadCount,\" \",unreadCount===1?\"новое\":\"новых\"]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"msg-refresh-btn\",onClick:loadMessages,disabled:loading,style:{width:\"100%\",padding:\"10px 16px\",background:loading?\"rgba(14,165,233,0.3)\":\"linear-gradient(135deg, #0ea5e9, #0284c7)\",color:\"white\",border:\"none\",borderRadius:\"10px\",fontSize:\"13px\",fontWeight:600,cursor:loading?\"not-allowed\":\"pointer\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",gap:\"8px\",transition:\"all 0.15s ease\"},children:loading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Spinner,{size:16,color:\"#fff\"}),\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2.5\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"23 4 23 10 17 10\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\"})]}),\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u044F\"]})})]}),error&&/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"12px\",padding:\"12px 16px\",background:\"rgba(239,68,68,0.15)\",border:\"1px solid rgba(239,68,68,0.3)\",borderRadius:\"10px\",fontSize:\"13px\",color:\"#fca5a5\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:600,marginBottom:\"4px\"},children:\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438\"}),/*#__PURE__*/_jsx(\"div\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:loadMessages,style:{marginTop:\"8px\",padding:\"4px 12px\",background:\"rgba(239,68,68,0.3)\",color:\"#fca5a5\",border:\"1px solid rgba(239,68,68,0.4)\",borderRadius:\"6px\",fontSize:\"12px\",cursor:\"pointer\"},children:\"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u043D\\u043E\\u0432\\u0430\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,overflow:\"auto\"},children:loading&&messages.length===0?/*#__PURE__*/// Loading skeleton\n_jsx(\"div\",{style:{padding:\"8px 0\"},children:[1,2,3,4,5].map(i=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"14px 20px\",display:\"flex\",gap:\"12px\",alignItems:\"center\",borderBottom:\"1px solid rgba(148,163,184,0.08)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"52px\",height:\"52px\",borderRadius:\"12px\",background:\"rgba(148,163,184,0.1)\",flexShrink:0,animation:\"pulse 1.5s ease-in-out infinite\"}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{height:\"14px\",width:\"60%\",background:\"rgba(148,163,184,0.1)\",borderRadius:\"4px\",marginBottom:\"8px\",animation:\"pulse 1.5s ease-in-out infinite\"}}),/*#__PURE__*/_jsx(\"div\",{style:{height:\"12px\",width:\"80%\",background:\"rgba(148,163,184,0.08)\",borderRadius:\"4px\",marginBottom:\"6px\",animation:\"pulse 1.5s ease-in-out infinite\",animationDelay:\"0.1s\"}}),/*#__PURE__*/_jsx(\"div\",{style:{height:\"10px\",width:\"40%\",background:\"rgba(148,163,184,0.06)\",borderRadius:\"4px\",animation:\"pulse 1.5s ease-in-out infinite\",animationDelay:\"0.2s\"}})]})]},i))}):messages.length===0&&!loading?/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"60px 20px\",textAlign:\"center\",color:\"#64748b\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"40px\",marginBottom:\"12px\",opacity:0.5},children:/*#__PURE__*/_jsx(\"svg\",{width:\"48\",height:\"48\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"1.5\",style:{margin:\"0 auto\",display:\"block\",color:\"#475569\"},children:/*#__PURE__*/_jsx(\"path\",{d:\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"15px\",fontWeight:600,marginBottom:\"4px\"},children:\"\\u041D\\u0435\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"13px\"},children:\"\\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \\\"\\u041E\\u0431\\u043D\\u043E\\u0432\\u0438\\u0442\\u044C\\\" \\u0434\\u043B\\u044F \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438\"})]}):messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:\"msg-conv-item\",onClick:()=>{setSelectedMessage(message);fetchThread(message);if(message.unread)markAsRead(message.id);},style:{padding:\"14px 20px\",borderBottom:\"1px solid rgba(148,163,184,0.08)\",cursor:\"pointer\",background:(selectedMessage===null||selectedMessage===void 0?void 0:selectedMessage.id)===message.id?\"rgba(59,130,246,0.15)\":message.unread?\"rgba(34,197,94,0.08)\":\"transparent\",borderLeft:(selectedMessage===null||selectedMessage===void 0?void 0:selectedMessage.id)===message.id?\"3px solid #3b82f6\":message.unread?\"3px solid #22c55e\":\"3px solid transparent\",display:\"flex\",alignItems:\"flex-start\",gap:\"12px\",transition:\"background 0.15s ease\",animation:\"fadeIn 0.2s ease\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"52px\",height:\"52px\",borderRadius:\"12px\",overflow:\"hidden\",background:\"rgba(15,23,42,0.6)\",border:\"1px solid rgba(148,163,184,0.15)\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",flexShrink:0},children:message.adImage?/*#__PURE__*/_jsx(\"img\",{src:message.adImage,alt:\"\",style:{width:\"100%\",height:\"100%\",objectFit:\"cover\"},onError:e=>{e.target.style.display=\"none\";}}):/*#__PURE__*/_jsx(\"div\",{style:{width:\"100%\",height:\"100%\",background:message.unread?\"linear-gradient(135deg, #22c55e, #16a34a)\":\"linear-gradient(135deg, #3b82f6, #2563eb)\",color:\"white\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"20px\",fontWeight:700},children:(message.sender||\"?\").charAt(0).toUpperCase()})}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,minWidth:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:\"3px\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:700,fontSize:\"14px\",color:\"#f1f5f9\",overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",maxWidth:\"65%\"},children:message.sender||\"Неизвестный\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:\"11px\",color:\"#64748b\",whiteSpace:\"nowrap\",flexShrink:0},children:getTimeAgo(message.date,message.time)})]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"13px\",color:\"#94a3b8\",fontWeight:600,overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",marginBottom:\"3px\"},children:message.adTitle||\"Без названия\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"12px\",color:\"#64748b\",overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",marginBottom:\"4px\"},children:message.message||\"\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:\"6px\"},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:\"11px\",color:\"#475569\",background:\"rgba(148,163,184,0.1)\",padding:\"1px 6px\",borderRadius:\"4px\"},children:message.accountName}),message.unread&&/*#__PURE__*/_jsx(\"span\",{style:{padding:\"3px 10px\",background:\"linear-gradient(135deg, #8b5cf6, #7c3aed)\",color:\"white\",borderRadius:\"9999px\",fontSize:\"10px\",fontWeight:700,textTransform:\"uppercase\",letterSpacing:\"0.5px\",boxShadow:\"0 0 10px rgba(139, 92, 246, 0.4)\",border:\"1px solid rgba(139, 92, 246, 0.3)\"},children:\"new\"})]})]})]},message.id))}),messages.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"8px 20px\",borderTop:\"1px solid rgba(148,163,184,0.1)\",fontSize:\"11px\",color:\"#475569\",textAlign:\"center\",background:\"rgba(15,23,42,0.3)\"},children:[messages.length,\" \",messages.length===1?\"диалог\":messages.length<5?\"диалога\":\"диалогов\"]})]}),showChatPanel&&/*#__PURE__*/_jsx(\"div\",{className:\"messages-chat\",style:{flex:1,background:\"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",borderRadius:\"20px\",overflow:\"hidden\",boxShadow:\"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",border:\"1px solid rgba(148,163,184,0.12)\",display:\"flex\",flexDirection:\"column\",color:\"#e2e8f0\",backdropFilter:\"blur(10px)\"},children:selectedMessage?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{padding:\"14px 20px\",borderBottom:\"1px solid rgba(148,163,184,0.15)\",background:\"rgba(15,23,42,0.6)\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"14px\",alignItems:\"center\",flex:1,minWidth:0},children:[/*#__PURE__*/_jsx(\"div\",{style:{width:\"50px\",height:\"50px\",borderRadius:\"10px\",overflow:\"hidden\",border:\"1px solid rgba(148,163,184,0.15)\",background:\"rgba(15,23,42,0.8)\",flexShrink:0,display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},children:selectedMessage.adImage?/*#__PURE__*/_jsx(\"img\",{src:selectedMessage.adImage,alt:\"\",style:{width:\"100%\",height:\"100%\",objectFit:\"cover\"},onError:e=>{e.target.style.display=\"none\";}}):/*#__PURE__*/_jsxs(\"svg\",{width:\"24\",height:\"24\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"#475569\",strokeWidth:\"1.5\",children:[/*#__PURE__*/_jsx(\"rect\",{x:\"3\",y:\"3\",width:\"18\",height:\"18\",rx:\"2\",ry:\"2\"}),/*#__PURE__*/_jsx(\"circle\",{cx:\"8.5\",cy:\"8.5\",r:\"1.5\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"21 15 16 10 5 21\"})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{minWidth:0},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:700,fontSize:\"15px\",color:\"#f1f5f9\",overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\"},children:selectedMessage.sender||\"Неизвестный\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"13px\",color:\"#94a3b8\",fontWeight:500,overflow:\"hidden\",textOverflow:\"ellipsis\",whiteSpace:\"nowrap\",marginTop:\"2px\"},children:selectedMessage.adTitle||\"Без названия\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"11px\",color:\"#475569\",marginTop:\"2px\"},children:selectedMessage.accountName})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedMessage(null),style:{background:\"rgba(148,163,184,0.1)\",border:\"none\",width:isMobileView?\"auto\":\"32px\",height:\"32px\",padding:isMobileView?\"0 10px\":0,borderRadius:\"8px\",cursor:\"pointer\",color:\"#94a3b8\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:\"16px\",fontWeight:600,flexShrink:0},children:isMobileView?\"← Назад\":/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2.5\",strokeLinecap:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"18\",y1:\"6\",x2:\"6\",y2:\"18\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"6\",y1:\"6\",x2:\"18\",y2:\"18\"})]})})]})}),/*#__PURE__*/_jsx(\"div\",{ref:chatScrollRef,style:{flex:1,padding:\"20px\",overflow:\"auto\",background:\"rgba(8,12,24,0.4)\"},children:loadingThread?/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\",height:\"100%\",gap:\"12px\",color:\"#64748b\"},children:[/*#__PURE__*/_jsx(Spinner,{size:32,color:\"#3b82f6\"}),/*#__PURE__*/_jsx(\"span\",{style:{fontSize:\"14px\"},children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\\u0430...\"})]}):threadMessages.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:\"#64748b\",textAlign:\"center\",paddingTop:\"40px\"},children:/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"14px\"},children:\"\\u041D\\u0435\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0432 \\u044D\\u0442\\u043E\\u043C \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\\u0435\"})}):/*#__PURE__*/_jsx(_Fragment,{children:threadMessages.map((messageItem,idx)=>{const isOutgoing=messageItem.direction===\"outgoing\";return/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:\"12px\",display:\"flex\",justifyContent:isOutgoing?\"flex-end\":\"flex-start\",animation:\"fadeIn 0.2s ease\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:\"70%\",minWidth:\"120px\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"11px\",color:isOutgoing?\"#86efac\":\"#7dd3fc\",fontWeight:600,marginBottom:\"4px\",paddingLeft:isOutgoing?\"0\":\"12px\",paddingRight:isOutgoing?\"12px\":\"0\",textAlign:isOutgoing?\"right\":\"left\"},children:messageItem.sender||(isOutgoing?\"Вы\":selectedMessage.sender||\"\")}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"10px 14px\",borderRadius:isOutgoing?\"14px 14px 4px 14px\":\"14px 14px 14px 4px\",background:isOutgoing?\"linear-gradient(135deg, #1a4731, #14532d)\":\"rgba(15,23,42,0.8)\",border:isOutgoing?\"1px solid rgba(34,197,94,0.25)\":\"1px solid rgba(148,163,184,0.15)\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"14px\",lineHeight:\"1.5\",whiteSpace:\"pre-wrap\",wordBreak:\"break-word\",color:\"#e2e8f0\"},children:messageItem.text}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"10px\",color:\"#64748b\",marginTop:\"6px\",textAlign:\"right\"},children:formatMessageDate(messageItem.date||selectedMessage.date,messageItem.time||selectedMessage.time)})]})]})},messageItem.id||idx);})})}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"14px 20px\",borderTop:\"1px solid rgba(148,163,184,0.15)\",background:\"rgba(15,23,42,0.6)\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"10px\",alignItems:\"flex-end\"},children:[/*#__PURE__*/_jsx(\"textarea\",{value:replyText,onChange:e=>setReplyText(e.target.value),onKeyDown:handleKeyDown,placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435...\",rows:1,style:{flex:1,padding:\"10px 14px\",border:\"1px solid rgba(148,163,184,0.2)\",borderRadius:\"12px\",resize:\"none\",minHeight:\"42px\",maxHeight:\"120px\",background:\"rgba(15,23,42,0.6)\",color:\"#e2e8f0\",fontSize:\"14px\",lineHeight:\"1.4\",outline:\"none\",fontFamily:\"inherit\"},onInput:e=>{e.target.style.height=\"42px\";e.target.style.height=Math.min(e.target.scrollHeight,120)+\"px\";}}),/*#__PURE__*/_jsx(\"button\",{className:\"msg-send-btn\",onClick:sendReply,disabled:sending||!replyText.trim(),style:{padding:\"10px 20px\",background:sending?\"rgba(34,197,94,0.4)\":!replyText.trim()?\"rgba(148,163,184,0.15)\":\"linear-gradient(135deg, #22c55e, #16a34a)\",color:!replyText.trim()?\"#64748b\":\"white\",border:\"none\",borderRadius:\"12px\",cursor:sending||!replyText.trim()?\"not-allowed\":\"pointer\",whiteSpace:\"nowrap\",fontSize:\"14px\",fontWeight:600,display:\"flex\",alignItems:\"center\",gap:\"6px\",height:\"42px\",transition:\"all 0.15s ease\"},children:sending?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Spinner,{size:14,color:\"#fff\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0430\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2.5\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"line\",{x1:\"22\",y1:\"2\",x2:\"11\",y2:\"13\"}),/*#__PURE__*/_jsx(\"polygon\",{points:\"22 2 15 22 11 13 2 9 22 2\"})]}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"11px\",color:\"#475569\",marginTop:\"6px\"},children:\"Enter \\u0434\\u043B\\u044F \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043A\\u0438, Shift+Enter \\u0434\\u043B\\u044F \\u043D\\u043E\\u0432\\u043E\\u0439 \\u0441\\u0442\\u0440\\u043E\\u043A\\u0438\"})]})]}):/*#__PURE__*/// Empty state\n_jsx(\"div\",{style:{flex:1,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",color:\"#475569\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\",maxWidth:\"280px\"},children:[/*#__PURE__*/_jsx(\"svg\",{width:\"64\",height:\"64\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"1\",style:{margin:\"0 auto 16px\",display:\"block\",color:\"#334155\"},children:/*#__PURE__*/_jsx(\"path\",{d:\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"})}),/*#__PURE__*/_jsx(\"h3\",{style:{margin:\"0 0 8px\",fontSize:\"16px\",color:\"#64748b\"},children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:0,fontSize:\"13px\",lineHeight:\"1.5\"},children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0438\\u0430\\u043B\\u043E\\u0433 \\u0438\\u0437 \\u0441\\u043F\\u0438\\u0441\\u043A\\u0430 \\u0441\\u043B\\u0435\\u0432\\u0430 \\u0434\\u043B\\u044F \\u043F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0430 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0438 \\u043E\\u0442\\u0432\\u0435\\u0442\\u0430\"})]})})})]})]});};export default MessagesTab;","map":{"version":3,"names":["React","useState","useEffect","useRef","apiFetchJson","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","detectMobileView","_window$screen","window","viewportWidth","innerWidth","document","documentElement","clientWidth","screenWidth","screen","width","effectiveWidth","Math","min","mobileUa","test","navigator","userAgent","hasCoarsePointer","matchMedia","matches","noHover","touchPoints","Number","maxTouchPoints","touchLikeDevice","MessagesTab","_selectedMessage$mess","messages","setMessages","selectedMessage","setSelectedMessage","replyText","setReplyText","sending","setSending","loading","setLoading","loadingThread","setLoadingThread","error","setError","isMobileView","setIsMobileView","chatScrollRef","loadMessages","container","current","scrollTo","top","scrollHeight","behavior","id","handleResize","addEventListener","removeEventListener","data","list","Array","isArray","seen","Set","deduped","item","key","conversationId","conversationUrl","concat","accountId","sender","adTitle","message","time","has","add","push","err","console","markAsRead","messageId","prev","map","msg","_objectSpread","unread","method","sendReply","trim","alert","result","headers","body","JSON","stringify","participant","text","success","resolvedConversationId","resolvedConversationUrl","latestMessages","lastMessage","length","date","getTimeAgo","now","Date","messageDate","isNaN","getTime","diffHours","floor","_unused","formatMessageDate","parts","d","diffDays","toLocaleDateString","day","month","_unused2","join","threadMessages","direction","fetchThread","params","URLSearchParams","set","toString","updated","adImage","handleKeyDown","e","shiftKey","preventDefault","unreadCount","filter","m","showConversationList","showChatPanel","Boolean","Spinner","_ref","size","color","height","viewBox","style","animation","children","cx","cy","r","stroke","strokeWidth","fill","strokeDasharray","strokeDashoffset","strokeLinecap","className","display","gap","minHeight","minWidth","background","borderRadius","overflow","boxShadow","border","flexDirection","backdropFilter","padding","borderBottom","justifyContent","alignItems","marginBottom","margin","fontSize","fontWeight","onClick","disabled","cursor","transition","strokeLinejoin","points","marginTop","flex","i","flexShrink","animationDelay","textAlign","opacity","borderLeft","src","alt","objectFit","onError","target","charAt","toUpperCase","textOverflow","whiteSpace","maxWidth","accountName","textTransform","letterSpacing","borderTop","x","y","rx","ry","x1","y1","x2","y2","ref","paddingTop","messageItem","idx","isOutgoing","paddingLeft","paddingRight","lineHeight","wordBreak","value","onChange","onKeyDown","placeholder","rows","resize","maxHeight","outline","fontFamily","onInput"],"sources":["/Users/eurocare/Downloads/barvihaluxury-main/frontend/src/components/MessagesTab.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { apiFetchJson } from \"../api\";\n\nconst detectMobileView = () => {\n  if (typeof window === \"undefined\") return false;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth || 0;\n  const screenWidth = typeof window.screen?.width === \"number\" ? window.screen.width : viewportWidth;\n  const effectiveWidth = Math.min(viewportWidth || screenWidth, screenWidth || viewportWidth);\n  const mobileUa = /Android|webOS|iPhone|iPad|iPod|Opera Mini|IEMobile/i.test(\n    (typeof navigator !== \"undefined\" && navigator.userAgent) || \"\"\n  );\n  const hasCoarsePointer = typeof window.matchMedia === \"function\"\n    ? window.matchMedia(\"(pointer: coarse)\").matches\n    : false;\n  const noHover = typeof window.matchMedia === \"function\"\n    ? window.matchMedia(\"(hover: none)\").matches\n    : false;\n  const touchPoints = typeof navigator !== \"undefined\" ? Number(navigator.maxTouchPoints || 0) : 0;\n  const touchLikeDevice = hasCoarsePointer || noHover || touchPoints > 1;\n  return effectiveWidth <= 768 || (touchLikeDevice && effectiveWidth <= 1024) || (mobileUa && effectiveWidth <= 1180);\n};\n\nconst MessagesTab = () => {\n  const [messages, setMessages] = useState([]);\n  const [selectedMessage, setSelectedMessage] = useState(null);\n  const [replyText, setReplyText] = useState(\"\");\n  const [sending, setSending] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [loadingThread, setLoadingThread] = useState(false);\n  const [error, setError] = useState(null);\n  const [isMobileView, setIsMobileView] = useState(() => detectMobileView());\n  const chatScrollRef = useRef(null);\n\n  useEffect(() => {\n    loadMessages();\n  }, []);\n\n  useEffect(() => {\n    if (!selectedMessage) return;\n    const container = chatScrollRef.current;\n    if (!container) return;\n    container.scrollTo({ top: container.scrollHeight, behavior: \"smooth\" });\n  }, [selectedMessage?.id, selectedMessage?.messages]);\n\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobileView(detectMobileView());\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  const loadMessages = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const data = await apiFetchJson(\"/api/messages\");\n      const list = Array.isArray(data) ? data : [];\n      const seen = new Set();\n      const deduped = [];\n      for (const item of list) {\n        const key = item.conversationId\n          || item.conversationUrl\n          || item.id\n          || `${item.accountId || \"\"}|${item.sender || \"\"}|${item.adTitle || \"\"}|${item.message || \"\"}|${item.time || \"\"}`;\n        if (seen.has(key)) continue;\n        seen.add(key);\n        deduped.push(item);\n      }\n      setMessages(deduped);\n    } catch (err) {\n      console.error(\"Ошибка загрузки сообщений:\", err);\n      setError(err.message || \"Не удалось загрузить сообщения\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const markAsRead = async (messageId) => {\n    // Immediately update UI for better responsiveness\n    setMessages(prev => prev.map(msg =>\n      msg.id === messageId ? { ...msg, unread: false } : msg\n    ));\n\n    try {\n      await apiFetchJson(`/api/messages/${messageId}/read`, {\n        method: \"PUT\"\n      });\n    } catch (err) {\n      console.error(\"Ошибка при отметке сообщения как прочитанного:\", err);\n      // Optionally revert on error\n    }\n  };\n\n  const sendReply = async () => {\n    if (!replyText.trim() || !selectedMessage) return;\n    if (!selectedMessage.conversationId && !selectedMessage.conversationUrl\n      && !selectedMessage.sender && !selectedMessage.adTitle) {\n      alert(\"Не найден идентификатор диалога.\");\n      return;\n    }\n\n    setSending(true);\n    try {\n      const result = await apiFetchJson(\"/api/messages/send\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          accountId: selectedMessage.accountId,\n          conversationId: selectedMessage.conversationId,\n          conversationUrl: selectedMessage.conversationUrl,\n          participant: selectedMessage.sender,\n          adTitle: selectedMessage.adTitle,\n          text: replyText\n        })\n      });\n      if (result.success) {\n        const resolvedConversationId = result.conversationId || selectedMessage.conversationId;\n        const resolvedConversationUrl = result.conversationUrl || selectedMessage.conversationUrl;\n        const latestMessages = result.messages || [];\n        const lastMessage = latestMessages[latestMessages.length - 1];\n        if (lastMessage) {\n          setMessages(prev => prev.map(msg => (\n            msg.id === selectedMessage.id\n              ? {\n                ...msg,\n                message: lastMessage.text,\n                date: lastMessage.date,\n                time: lastMessage.time,\n                conversationId: resolvedConversationId || msg.conversationId,\n                conversationUrl: resolvedConversationUrl || msg.conversationUrl\n              }\n              : msg\n          )));\n        }\n        setSelectedMessage(prev => ({\n          ...prev,\n          messages: latestMessages,\n          conversationId: resolvedConversationId,\n          conversationUrl: resolvedConversationUrl\n        }));\n        setReplyText(\"\");\n      } else {\n        alert(\"Ошибка: \" + (result.error || \"Не удалось отправить\"));\n      }\n    } catch (err) {\n      console.error(\"Ошибка отправки:\", err);\n      alert(\"Ошибка при отправке сообщения\");\n    } finally {\n      setSending(false);\n    }\n  };\n\n  const getTimeAgo = (date, time) => {\n    if (!date && !time) return \"\";\n    const now = new Date();\n    try {\n      const messageDate = new Date(date + \"T\" + (time || \"00:00\"));\n      if (isNaN(messageDate.getTime())) return time || date || \"\";\n      const diffHours = Math.floor((now - messageDate) / (1000 * 60 * 60));\n      if (diffHours < 1) return time || \"Только что\";\n      if (diffHours < 24) return time;\n      if (diffHours < 48) return \"Вчера\";\n      return date;\n    } catch {\n      return time || date || \"\";\n    }\n  };\n\n  const formatMessageDate = (date, time) => {\n    if (!date && !time) return \"\";\n    const parts = [];\n    if (date) {\n      try {\n        const d = new Date(date + \"T00:00\");\n        if (!isNaN(d.getTime())) {\n          const now = new Date();\n          const diffDays = Math.floor((now - d) / (1000 * 60 * 60 * 24));\n          if (diffDays === 0) parts.push(\"Сегодня\");\n          else if (diffDays === 1) parts.push(\"Вчера\");\n          else parts.push(d.toLocaleDateString(\"ru-RU\", { day: \"numeric\", month: \"short\" }));\n        } else {\n          parts.push(date);\n        }\n      } catch {\n        parts.push(date);\n      }\n    }\n    if (time) parts.push(time);\n    return parts.join(\", \");\n  };\n\n  const threadMessages = selectedMessage?.messages?.length\n    ? selectedMessage.messages\n    : selectedMessage\n      ? [{\n        id: selectedMessage.id,\n        text: selectedMessage.message,\n        sender: selectedMessage.sender,\n        date: selectedMessage.date,\n        time: selectedMessage.time,\n        direction: \"incoming\"\n      }]\n      : [];\n\n  const fetchThread = async (message) => {\n    setLoadingThread(true);\n    try {\n      const params = new URLSearchParams();\n      params.set(\"accountId\", message.accountId);\n      if (message.conversationId) params.set(\"conversationId\", message.conversationId);\n      if (message.conversationUrl) params.set(\"conversationUrl\", message.conversationUrl);\n      if (!message.conversationId && !message.conversationUrl) {\n        if (message.sender) params.set(\"participant\", message.sender);\n        if (message.adTitle) params.set(\"adTitle\", message.adTitle);\n      }\n      const data = await apiFetchJson(`/api/messages/thread?${params.toString()}`);\n      if (data.success) {\n        const updated = {\n          ...message,\n          adTitle: data.adTitle || message.adTitle,\n          adImage: data.adImage || message.adImage,\n          sender: message.sender || data.participant || \"\",\n          messages: data.messages || [],\n          conversationId: data.conversationId || message.conversationId,\n          conversationUrl: data.conversationUrl || message.conversationUrl\n        };\n        setSelectedMessage(updated);\n      }\n    } catch (err) {\n      console.error(\"Ошибка загрузки диалога:\", err);\n    } finally {\n      setLoadingThread(false);\n    }\n  };\n\n  const handleKeyDown = (e) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      sendReply();\n    }\n  };\n\n  const unreadCount = messages.filter(m => m.unread).length;\n  const showConversationList = !isMobileView || !selectedMessage;\n  const showChatPanel = !isMobileView || Boolean(selectedMessage);\n\n  // Spinner SVG for loading states\n  const Spinner = ({ size = 20, color = \"#7dd3fc\" }) => (\n    <svg width={size} height={size} viewBox=\"0 0 24 24\" style={{ animation: \"spin 1s linear infinite\" }}>\n      <circle cx=\"12\" cy=\"12\" r=\"10\" stroke={color} strokeWidth=\"3\" fill=\"none\" strokeDasharray=\"31.4\" strokeDashoffset=\"10\" strokeLinecap=\"round\" />\n    </svg>\n  );\n\n  return (\n    <>\n      <style>{`\n        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }\n        @keyframes pulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.8; } }\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }\n        .msg-conv-item:hover { background: rgba(59,130,246,0.12) !important; }\n        .msg-send-btn:hover:not(:disabled) { background: #16a34a !important; }\n        .msg-refresh-btn:hover:not(:disabled) { background: #0284c7 !important; transform: scale(1.02); }\n        .msg-refresh-btn:active:not(:disabled) { transform: scale(0.98); }\n      `}</style>\n\n      <div className=\"messages-layout\" style={{ display: \"flex\", gap: \"20px\", height: \"calc(100vh - 220px)\", minHeight: \"500px\" }}>\n        {/* Conversation List */}\n        {showConversationList && <div className=\"messages-list\" style={{\n          width: \"400px\",\n          minWidth: \"340px\",\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          color: \"#e2e8f0\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          backdropFilter: \"blur(10px)\"\n        }}>\n          {/* Header */}\n          <div style={{\n            padding: \"16px 20px\",\n            borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n            background: \"rgba(15,23,42,0.5)\"\n          }}>\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"12px\" }}>\n              <h3 style={{ margin: 0, fontSize: \"18px\", fontWeight: 700 }}>Сообщения</h3>\n              {unreadCount > 0 && (\n                <span style={{\n                  padding: \"5px 14px\",\n                  background: \"linear-gradient(135deg, #10b981, #059669)\",\n                  color: \"white\",\n                  borderRadius: \"9999px\",\n                  fontSize: \"12px\",\n                  fontWeight: 600,\n                  boxShadow: \"0 0 12px rgba(16, 185, 129, 0.4)\",\n                  border: \"1px solid rgba(16, 185, 129, 0.3)\"\n                }}>\n                  {unreadCount} {unreadCount === 1 ? \"новое\" : \"новых\"}\n                </span>\n              )}\n            </div>\n            <button\n              className=\"msg-refresh-btn\"\n              onClick={loadMessages}\n              disabled={loading}\n              style={{\n                width: \"100%\",\n                padding: \"10px 16px\",\n                background: loading ? \"rgba(14,165,233,0.3)\" : \"linear-gradient(135deg, #0ea5e9, #0284c7)\",\n                color: \"white\",\n                border: \"none\",\n                borderRadius: \"10px\",\n                fontSize: \"13px\",\n                fontWeight: 600,\n                cursor: loading ? \"not-allowed\" : \"pointer\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                gap: \"8px\",\n                transition: \"all 0.15s ease\"\n              }}\n            >\n              {loading ? (\n                <>\n                  <Spinner size={16} color=\"#fff\" />\n                  Загрузка сообщений...\n                </>\n              ) : (\n                <>\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                    <polyline points=\"23 4 23 10 17 10\" />\n                    <path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\" />\n                  </svg>\n                  Обновить сообщения\n                </>\n              )}\n            </button>\n          </div>\n\n          {/* Error state */}\n          {error && (\n            <div style={{\n              margin: \"12px\",\n              padding: \"12px 16px\",\n              background: \"rgba(239,68,68,0.15)\",\n              border: \"1px solid rgba(239,68,68,0.3)\",\n              borderRadius: \"10px\",\n              fontSize: \"13px\",\n              color: \"#fca5a5\"\n            }}>\n              <div style={{ fontWeight: 600, marginBottom: \"4px\" }}>Ошибка загрузки</div>\n              <div>{error}</div>\n              <button\n                onClick={loadMessages}\n                style={{\n                  marginTop: \"8px\",\n                  padding: \"4px 12px\",\n                  background: \"rgba(239,68,68,0.3)\",\n                  color: \"#fca5a5\",\n                  border: \"1px solid rgba(239,68,68,0.4)\",\n                  borderRadius: \"6px\",\n                  fontSize: \"12px\",\n                  cursor: \"pointer\"\n                }}\n              >\n                Попробовать снова\n              </button>\n            </div>\n          )}\n\n          {/* Conversation list */}\n          <div style={{ flex: 1, overflow: \"auto\" }}>\n            {loading && messages.length === 0 ? (\n              // Loading skeleton\n              <div style={{ padding: \"8px 0\" }}>\n                {[1, 2, 3, 4, 5].map(i => (\n                  <div key={i} style={{\n                    padding: \"14px 20px\",\n                    display: \"flex\",\n                    gap: \"12px\",\n                    alignItems: \"center\",\n                    borderBottom: \"1px solid rgba(148,163,184,0.08)\"\n                  }}>\n                    <div style={{\n                      width: \"52px\",\n                      height: \"52px\",\n                      borderRadius: \"12px\",\n                      background: \"rgba(148,163,184,0.1)\",\n                      flexShrink: 0,\n                      animation: \"pulse 1.5s ease-in-out infinite\"\n                    }} />\n                    <div style={{ flex: 1 }}>\n                      <div style={{\n                        height: \"14px\",\n                        width: \"60%\",\n                        background: \"rgba(148,163,184,0.1)\",\n                        borderRadius: \"4px\",\n                        marginBottom: \"8px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\"\n                      }} />\n                      <div style={{\n                        height: \"12px\",\n                        width: \"80%\",\n                        background: \"rgba(148,163,184,0.08)\",\n                        borderRadius: \"4px\",\n                        marginBottom: \"6px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\",\n                        animationDelay: \"0.1s\"\n                      }} />\n                      <div style={{\n                        height: \"10px\",\n                        width: \"40%\",\n                        background: \"rgba(148,163,184,0.06)\",\n                        borderRadius: \"4px\",\n                        animation: \"pulse 1.5s ease-in-out infinite\",\n                        animationDelay: \"0.2s\"\n                      }} />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : messages.length === 0 && !loading ? (\n              <div style={{\n                padding: \"60px 20px\",\n                textAlign: \"center\",\n                color: \"#64748b\"\n              }}>\n                <div style={{ fontSize: \"40px\", marginBottom: \"12px\", opacity: 0.5 }}>\n                  <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" style={{ margin: \"0 auto\", display: \"block\", color: \"#475569\" }}>\n                    <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n                  </svg>\n                </div>\n                <div style={{ fontSize: \"15px\", fontWeight: 600, marginBottom: \"4px\" }}>Нет сообщений</div>\n                <div style={{ fontSize: \"13px\" }}>Нажмите \"Обновить\" для загрузки</div>\n              </div>\n            ) : (\n              messages.map(message => (\n                <div\n                  key={message.id}\n                  className=\"msg-conv-item\"\n                  onClick={() => {\n                    setSelectedMessage(message);\n                    fetchThread(message);\n                    if (message.unread) markAsRead(message.id);\n                  }}\n                  style={{\n                    padding: \"14px 20px\",\n                    borderBottom: \"1px solid rgba(148,163,184,0.08)\",\n                    cursor: \"pointer\",\n                    background: selectedMessage?.id === message.id\n                      ? \"rgba(59,130,246,0.15)\"\n                      : message.unread\n                        ? \"rgba(34,197,94,0.08)\"\n                        : \"transparent\",\n                    borderLeft: selectedMessage?.id === message.id\n                      ? \"3px solid #3b82f6\"\n                      : message.unread\n                        ? \"3px solid #22c55e\"\n                        : \"3px solid transparent\",\n                    display: \"flex\",\n                    alignItems: \"flex-start\",\n                    gap: \"12px\",\n                    transition: \"background 0.15s ease\",\n                    animation: \"fadeIn 0.2s ease\"\n                  }}\n                >\n                  {/* Product image / avatar */}\n                  <div style={{\n                    width: \"52px\",\n                    height: \"52px\",\n                    borderRadius: \"12px\",\n                    overflow: \"hidden\",\n                    background: \"rgba(15,23,42,0.6)\",\n                    border: \"1px solid rgba(148,163,184,0.15)\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    flexShrink: 0\n                  }}>\n                    {message.adImage ? (\n                      <img\n                        src={message.adImage}\n                        alt=\"\"\n                        style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n                        onError={(e) => { e.target.style.display = \"none\"; }}\n                      />\n                    ) : (\n                      <div style={{\n                        width: \"100%\",\n                        height: \"100%\",\n                        background: message.unread\n                          ? \"linear-gradient(135deg, #22c55e, #16a34a)\"\n                          : \"linear-gradient(135deg, #3b82f6, #2563eb)\",\n                        color: \"white\",\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        justifyContent: \"center\",\n                        fontSize: \"20px\",\n                        fontWeight: 700\n                      }}>\n                        {(message.sender || \"?\").charAt(0).toUpperCase()}\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Content */}\n                  <div style={{ flex: 1, minWidth: 0 }}>\n                    {/* Top row: sender + time */}\n                    <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\", marginBottom: \"3px\" }}>\n                      <span style={{\n                        fontWeight: 700,\n                        fontSize: \"14px\",\n                        color: \"#f1f5f9\",\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\",\n                        maxWidth: \"65%\"\n                      }}>\n                        {message.sender || \"Неизвестный\"}\n                      </span>\n                      <span style={{\n                        fontSize: \"11px\",\n                        color: \"#64748b\",\n                        whiteSpace: \"nowrap\",\n                        flexShrink: 0\n                      }}>\n                        {getTimeAgo(message.date, message.time)}\n                      </span>\n                    </div>\n\n                    {/* Ad title */}\n                    <div style={{\n                      fontSize: \"13px\",\n                      color: \"#94a3b8\",\n                      fontWeight: 600,\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      marginBottom: \"3px\"\n                    }}>\n                      {message.adTitle || \"Без названия\"}\n                    </div>\n\n                    {/* Last message preview */}\n                    <div style={{\n                      fontSize: \"12px\",\n                      color: \"#64748b\",\n                      overflow: \"hidden\",\n                      textOverflow: \"ellipsis\",\n                      whiteSpace: \"nowrap\",\n                      marginBottom: \"4px\"\n                    }}>\n                      {message.message || \"\"}\n                    </div>\n\n                    {/* Account label + unread badge */}\n                    <div style={{\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      gap: \"6px\"\n                    }}>\n                      <span style={{\n                        fontSize: \"11px\",\n                        color: \"#475569\",\n                        background: \"rgba(148,163,184,0.1)\",\n                        padding: \"1px 6px\",\n                        borderRadius: \"4px\"\n                      }}>\n                        {message.accountName}\n                      </span>\n                      {message.unread && (\n                        <span style={{\n                          padding: \"3px 10px\",\n                          background: \"linear-gradient(135deg, #8b5cf6, #7c3aed)\",\n                          color: \"white\",\n                          borderRadius: \"9999px\",\n                          fontSize: \"10px\",\n                          fontWeight: 700,\n                          textTransform: \"uppercase\",\n                          letterSpacing: \"0.5px\",\n                          boxShadow: \"0 0 10px rgba(139, 92, 246, 0.4)\",\n                          border: \"1px solid rgba(139, 92, 246, 0.3)\"\n                        }}>\n                          new\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ))\n            )}\n          </div>\n\n          {/* Message count footer */}\n          {messages.length > 0 && (\n            <div style={{\n              padding: \"8px 20px\",\n              borderTop: \"1px solid rgba(148,163,184,0.1)\",\n              fontSize: \"11px\",\n              color: \"#475569\",\n              textAlign: \"center\",\n              background: \"rgba(15,23,42,0.3)\"\n            }}>\n              {messages.length} {messages.length === 1 ? \"диалог\" : messages.length < 5 ? \"диалога\" : \"диалогов\"}\n            </div>\n          )}\n        </div>}\n\n        {/* Chat Panel */}\n        {showChatPanel && <div className=\"messages-chat\" style={{\n          flex: 1,\n          background: \"linear-gradient(145deg, rgba(30, 41, 59, 0.6) 0%, rgba(15, 23, 42, 0.95) 100%)\",\n          borderRadius: \"20px\",\n          overflow: \"hidden\",\n          boxShadow: \"0 20px 50px rgba(0,0,0,0.4), 0 0 30px rgba(0,0,0,0.2)\",\n          border: \"1px solid rgba(148,163,184,0.12)\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          color: \"#e2e8f0\",\n          backdropFilter: \"blur(10px)\"\n        }}>\n          {selectedMessage ? (\n            <>\n              {/* Chat header */}\n              <div style={{\n                padding: \"14px 20px\",\n                borderBottom: \"1px solid rgba(148,163,184,0.15)\",\n                background: \"rgba(15,23,42,0.6)\"\n              }}>\n                <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n                  <div style={{ display: \"flex\", gap: \"14px\", alignItems: \"center\", flex: 1, minWidth: 0 }}>\n                    {/* Product image in header */}\n                    <div style={{\n                      width: \"50px\",\n                      height: \"50px\",\n                      borderRadius: \"10px\",\n                      overflow: \"hidden\",\n                      border: \"1px solid rgba(148,163,184,0.15)\",\n                      background: \"rgba(15,23,42,0.8)\",\n                      flexShrink: 0,\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\"\n                    }}>\n                      {selectedMessage.adImage ? (\n                        <img\n                          src={selectedMessage.adImage}\n                          alt=\"\"\n                          style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n                          onError={(e) => { e.target.style.display = \"none\"; }}\n                        />\n                      ) : (\n                        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#475569\" strokeWidth=\"1.5\">\n                          <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\" />\n                          <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\n                          <polyline points=\"21 15 16 10 5 21\" />\n                        </svg>\n                      )}\n                    </div>\n\n                    <div style={{ minWidth: 0 }}>\n                      <div style={{\n                        fontWeight: 700,\n                        fontSize: \"15px\",\n                        color: \"#f1f5f9\",\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\"\n                      }}>\n                        {selectedMessage.sender || \"Неизвестный\"}\n                      </div>\n                      <div style={{\n                        fontSize: \"13px\",\n                        color: \"#94a3b8\",\n                        fontWeight: 500,\n                        overflow: \"hidden\",\n                        textOverflow: \"ellipsis\",\n                        whiteSpace: \"nowrap\",\n                        marginTop: \"2px\"\n                      }}>\n                        {selectedMessage.adTitle || \"Без названия\"}\n                      </div>\n                      <div style={{\n                        fontSize: \"11px\",\n                        color: \"#475569\",\n                        marginTop: \"2px\"\n                      }}>\n                        {selectedMessage.accountName}\n                      </div>\n                    </div>\n                  </div>\n\n                  <button\n                    onClick={() => setSelectedMessage(null)}\n                    style={{\n                      background: \"rgba(148,163,184,0.1)\",\n                      border: \"none\",\n                      width: isMobileView ? \"auto\" : \"32px\",\n                      height: \"32px\",\n                      padding: isMobileView ? \"0 10px\" : 0,\n                      borderRadius: \"8px\",\n                      cursor: \"pointer\",\n                      color: \"#94a3b8\",\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      fontSize: \"16px\",\n                      fontWeight: 600,\n                      flexShrink: 0\n                    }}\n                  >\n                    {isMobileView ? (\n                      \"← Назад\"\n                    ) : (\n                      <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\">\n                        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n                      </svg>\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              {/* Messages area */}\n              <div ref={chatScrollRef} style={{\n                flex: 1,\n                padding: \"20px\",\n                overflow: \"auto\",\n                background: \"rgba(8,12,24,0.4)\"\n              }}>\n                {loadingThread ? (\n                  <div style={{\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    height: \"100%\",\n                    gap: \"12px\",\n                    color: \"#64748b\"\n                  }}>\n                    <Spinner size={32} color=\"#3b82f6\" />\n                    <span style={{ fontSize: \"14px\" }}>Загрузка диалога...</span>\n                  </div>\n                ) : threadMessages.length === 0 ? (\n                  <div style={{ color: \"#64748b\", textAlign: \"center\", paddingTop: \"40px\" }}>\n                    <div style={{ fontSize: \"14px\" }}>Нет сообщений в этом диалоге</div>\n                  </div>\n                ) : (\n                  <>\n                    {threadMessages.map((messageItem, idx) => {\n                      const isOutgoing = messageItem.direction === \"outgoing\";\n                      return (\n                        <div\n                          key={messageItem.id || idx}\n                          style={{\n                            marginBottom: \"12px\",\n                            display: \"flex\",\n                            justifyContent: isOutgoing ? \"flex-end\" : \"flex-start\",\n                            animation: \"fadeIn 0.2s ease\"\n                          }}\n                        >\n                          <div style={{\n                            maxWidth: \"70%\",\n                            minWidth: \"120px\"\n                          }}>\n                            {/* Sender name */}\n                            <div style={{\n                              fontSize: \"11px\",\n                              color: isOutgoing ? \"#86efac\" : \"#7dd3fc\",\n                              fontWeight: 600,\n                              marginBottom: \"4px\",\n                              paddingLeft: isOutgoing ? \"0\" : \"12px\",\n                              paddingRight: isOutgoing ? \"12px\" : \"0\",\n                              textAlign: isOutgoing ? \"right\" : \"left\"\n                            }}>\n                              {messageItem.sender || (isOutgoing ? \"Вы\" : selectedMessage.sender || \"\")}\n                            </div>\n\n                            {/* Message bubble */}\n                            <div style={{\n                              padding: \"10px 14px\",\n                              borderRadius: isOutgoing ? \"14px 14px 4px 14px\" : \"14px 14px 14px 4px\",\n                              background: isOutgoing\n                                ? \"linear-gradient(135deg, #1a4731, #14532d)\"\n                                : \"rgba(15,23,42,0.8)\",\n                              border: isOutgoing\n                                ? \"1px solid rgba(34,197,94,0.25)\"\n                                : \"1px solid rgba(148,163,184,0.15)\"\n                            }}>\n                              <div style={{\n                                fontSize: \"14px\",\n                                lineHeight: \"1.5\",\n                                whiteSpace: \"pre-wrap\",\n                                wordBreak: \"break-word\",\n                                color: \"#e2e8f0\"\n                              }}>\n                                {messageItem.text}\n                              </div>\n\n                              {/* Timestamp */}\n                              <div style={{\n                                fontSize: \"10px\",\n                                color: \"#64748b\",\n                                marginTop: \"6px\",\n                                textAlign: \"right\"\n                              }}>\n                                {formatMessageDate(\n                                  messageItem.date || selectedMessage.date,\n                                  messageItem.time || selectedMessage.time\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </>\n                )}\n              </div>\n\n              {/* Reply input */}\n              <div style={{\n                padding: \"14px 20px\",\n                borderTop: \"1px solid rgba(148,163,184,0.15)\",\n                background: \"rgba(15,23,42,0.6)\"\n              }}>\n                <div style={{ display: \"flex\", gap: \"10px\", alignItems: \"flex-end\" }}>\n                  <textarea\n                    value={replyText}\n                    onChange={(e) => setReplyText(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"Введите сообщение...\"\n                    rows={1}\n                    style={{\n                      flex: 1,\n                      padding: \"10px 14px\",\n                      border: \"1px solid rgba(148,163,184,0.2)\",\n                      borderRadius: \"12px\",\n                      resize: \"none\",\n                      minHeight: \"42px\",\n                      maxHeight: \"120px\",\n                      background: \"rgba(15,23,42,0.6)\",\n                      color: \"#e2e8f0\",\n                      fontSize: \"14px\",\n                      lineHeight: \"1.4\",\n                      outline: \"none\",\n                      fontFamily: \"inherit\"\n                    }}\n                    onInput={(e) => {\n                      e.target.style.height = \"42px\";\n                      e.target.style.height = Math.min(e.target.scrollHeight, 120) + \"px\";\n                    }}\n                  />\n                  <button\n                    className=\"msg-send-btn\"\n                    onClick={sendReply}\n                    disabled={sending || !replyText.trim()}\n                    style={{\n                      padding: \"10px 20px\",\n                      background: sending\n                        ? \"rgba(34,197,94,0.4)\"\n                        : !replyText.trim()\n                          ? \"rgba(148,163,184,0.15)\"\n                          : \"linear-gradient(135deg, #22c55e, #16a34a)\",\n                      color: !replyText.trim() ? \"#64748b\" : \"white\",\n                      border: \"none\",\n                      borderRadius: \"12px\",\n                      cursor: sending || !replyText.trim() ? \"not-allowed\" : \"pointer\",\n                      whiteSpace: \"nowrap\",\n                      fontSize: \"14px\",\n                      fontWeight: 600,\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      gap: \"6px\",\n                      height: \"42px\",\n                      transition: \"all 0.15s ease\"\n                    }}\n                  >\n                    {sending ? (\n                      <>\n                        <Spinner size={14} color=\"#fff\" />\n                        <span>Отправка</span>\n                      </>\n                    ) : (\n                      <>\n                        <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                          <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" />\n                          <polygon points=\"22 2 15 22 11 13 2 9 22 2\" />\n                        </svg>\n                        <span>Отправить</span>\n                      </>\n                    )}\n                  </button>\n                </div>\n                <div style={{ fontSize: \"11px\", color: \"#475569\", marginTop: \"6px\" }}>\n                  Enter для отправки, Shift+Enter для новой строки\n                </div>\n              </div>\n            </>\n          ) : (\n            // Empty state\n            <div style={{\n              flex: 1,\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              color: \"#475569\"\n            }}>\n              <div style={{ textAlign: \"center\", maxWidth: \"280px\" }}>\n                <svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1\" style={{ margin: \"0 auto 16px\", display: \"block\", color: \"#334155\" }}>\n                  <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n                </svg>\n                <h3 style={{ margin: \"0 0 8px\", fontSize: \"16px\", color: \"#64748b\" }}>\n                  Выберите диалог\n                </h3>\n                <p style={{ margin: 0, fontSize: \"13px\", lineHeight: \"1.5\" }}>\n                  Выберите диалог из списка слева для просмотра сообщений и ответа\n                </p>\n              </div>\n            </div>\n          )}\n        </div>}\n      </div>\n    </>\n  );\n};\n\nexport default MessagesTab;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}